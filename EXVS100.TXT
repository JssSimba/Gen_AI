000100 IDENTIFICATION DIVISION.                                         00000100
000200 PROGRAM-ID.     EXVS100.                                         00000200
000300 AUTHOR.         CYNTHIA FORSYTH.                                 00000300
000400 DATE-WRITTEN.   MAY 30, 1991.                                    00000400
000500 DATE-COMPILED.                                                   00000500
000600******************************************************************00000600
000700*                                                                *00000700
000800*  PROGRAM DESCRIPTION:   READ THE USOB FILE FROM COC AND UPDATE *00000800
000900*                         THE EVSMASTER FILE                     *00000900
001000*                                                                *00001000
001100*        PARMFILE IS PROVIDED TO ALLOW THE USER TO               *00001100
001200*        A. CHANGE THE FREQUENCY OF CHECKPOINTS (DEFAULT IS 1000)*00001200
001300*        B. CAUSE THE PROGRAM TO RUN IN TEST MODE (DEF IS PROD)  *00001300
001400*                                                                *00001400
001500*   MODIFIED:   04/28/93   S ORAM                                *00001500
001600*   REASON: ADDED CHECK FOR -811 IN EVALUATE SQLCODE IN PARA     *00001600
001700*           3100-READ-EVS-MSTR SINCE THERE MAY BE DUPLICATE      *00001700
001800*           MODEL YEAR, DEALER, BODY, ITEMS WITH DIFFERENT S2KEYS*00001800
001900*                                                                *00001900
002000*   MODIFIED 6/15/93    CYNTHIA FORSYTH                          *00002000
002100*            COPYLIB - PCPEXWMIP WAS CHANGED TO INCLUDE AUSTRALIA*00002100
002200*                                                                *00002200
002300*   MODIFIED 7/1/93    CYNTHIA FORSYTH                           *00002300
002400*   REASON: TO ADD EUROPEAN DEALER CODES TO COPYLIB - CPEXWMIP   *00002400
002500*                                                                *00002500
002600*   MODIFIED 4/21/95   M. CYROL                                  *00002600
002700*   REASON: TO ALLOW DUPLICATE S1 KEYS TO COME INTO THE SYSTEM.  *00002700
002800*           A DUPLICATE CAN BE ASSIGNED AFTER THE FIRST VEHICLE  *00002800
002900*           IS 30 DAYS PAST PLANT RELEASE DATE.                  *00002900
003000*                                                                *00003000
003100*   MODIFIED 5/15/95   M. CYROL                                  *00003100
003200*   REASON: ADD CHECK TO S1 KEY FOR 30 DAYS PAST PLANT RELEASE.  *00003200
003300*                                                                *00003300
003400*   MODIFIED 7/14/95   M. CYROL                                  *00003400
003500*   REASON: ACCEPT 999 TRANSACTION EVEN IF THE VEHICLE IS        *00003500
003600*           ALREADY SERIALIZED.                                  *00003600
003700*                                                                *00003700
003800*   MODIFIED 8/30/95   M. SHAKER                                 *00003800
003900*   REASON: STOP INPUT DATES OF '000000' FROM BEING TRANSLATED   *00003900
004000*           TO '1000000'.                                        *00004000
004100*                                                                *00004100
004200*   MODIFIED 12/14/95  USHA JAGANNATHAN                          *00004200
004300*   REASON: AVOID DUPLICATE S2 KEYS GETTING INSERTED INTO        *00004300
004400*           MASTER                                               *00004400
004500*                                                                *00004500
004600*   MODIFIED 01/04/96  MARK SHAKER                               *00004600
004700*   REASON: USE WMI FROM THE VO IMAGE RATHER THAN CALCING IT     *00004700
004800*                                                                *00004800
004900*   MODIFIED 11/13/96  BASKAR RANGARAJAN                         *00004900
005000*   REASON: MOVE 'F' TO FLT-RTK-IND IF V-23 = C,G,L,M,A,R,U ALSO *00005000
005100*           BESIDES F. CHECK PARAGRAPH 3200-BLD-EVS-VOIMAGE      *00005100
005200*                                                                *00005510
005300*   MODIFIED 12/30/1999 POLLY SIMMS                              *00005520
005400*   REASON: ORBIT NUMBER FOR EAO ORDERS IS BEING LOST WHEN AN    *00005530
005500*           ORDER IS CANCELLED AND RE-SUBMITTED BY USOB.  ADDED  *00005540
005600*           PARAGRAPH (3115-CANCEL-STATUS-CHK2) TO RE-ACTIVATE   *00005600
005700*           CANCELLED ORDER WHEN THERE IS A MATCH ON S1 KEY AND  *00005700
005800*           ORDER RECEIVED DATE, RATHER THAN CREATING A NEW ORDER*00005800
005900*           RECORD WITH A NEW CONTROL NUMBER.                    *00005900
006000*                                                                *00005910
006100*   MODIFIED 02/03/2000 POLLY SIMMS                              *00005920
006200*   REASON: DISPLAY S1 KEY AND ORDER RECEIVED DATE ON AUDIT FILE *00005930
006300*           WHEN CANCELLED ORDER IS RE-ACTIVATED.                *00005940
006400*                                                                *PEXSE122
006500* ETRACKER ISSUE: 522679                                         *
006600* REASON:  TO FIX THE DB2 VERSION 7 PROBLEM -  THIS VERSION      *
006700*          WILL NOT UPDATE THE HOST VARIABLES ON AN SQLCODE -811 *
006800*          THE CHANGE CAN BE FOUND BY                            *
006900*          SEARCHING THE STRING  "**** SHEU 12/10/03 ***"        *
007000*                                                                *PEXSE122
007100* ETRACKER ISSUE: 14253681                                       *
007200* PROGRAMMER:     DAWN MAHN                                      *
007300* REASON:  INCREASE CR-CONTROL-NUMBER AND WS-CONTROL-NUMBER FROM *
007400*          9(07) TO 9(09).                                       *
007500*                                                                *PEXCR
007600******************************************************************00006000
007700                                                                  00006100
007800 ENVIRONMENT DIVISION.                                            00006200
007900 INPUT-OUTPUT SECTION.                                            00006300
008000 FILE-CONTROL.                                                    00006400
008100                                                                  00006500
008200     SELECT XRST-FILE  ASSIGN TO XRSTFILE.                        00006600
008300                                                                  00006700
008400     SELECT PARMFILE   ASSIGN TO PARMFILE.                        00006800
008500                                                                  00006900
008600 DATA DIVISION.                                                   00007000
008700 FILE SECTION.                                                    00007100
008800                                                                  00007200
008900*********    CHECKPOINT / RESTART FILE                            00007300
009000*++INCLUDE PCPIMS001                                              00007400
009100 COPY CPIMS001.                                                         00
009200*********    END OF CHECKPOINT / RESTART FILE                     00007500
009300                                                                  00007600
009400 FD  PARMFILE                                                     00007700
009500         RECORD CONTAINS  80 CHARACTERS,                          00007800
009600         BLOCK CONTAINS 0 RECORDS.                                00007900
009700                                                                  00008000
009800 01  PARMREC.                                                     00008100
009900     05 CHECKPOINT-FREQUENCY          PIC 9(05).                  00008200
010000     05 FILLER                        PIC X.                      00008300
010100     05 RUN-MODE                      PIC X(4).                   00008400
010200     05 FILLER                        PIC X.                      00008500
010300     05 ABEND-LIT                     PIC X(10).                  00008600
010400     05 ABEND-LIM                     PIC 9(05).                  00008700
010500     05 FILLER                        PIC X(54).                  00008800
010600                                                                  00008900
010700                                                                  00009000
010800 WORKING-STORAGE SECTION.                                         00009100
010900 77  PAN-VALET PICTURE X(24) VALUE '197PEXVS100  02/13/98'.       00009200
011000***********   BEGINNING OF SAVE AREA 2 ******************         00009300
011100 01 WS-SAVE-AREA-2.                                               00009400
011200    05  DUPLICATE-CNT                 PIC 9(06)  VALUE ZEROS.     00009500
011300    05  USOB-REC-IN-CNT               PIC 9(06)  VALUE ZEROS.     00009600
011400    05  USOB-ERROR-CNT                PIC 9(06)  VALUE ZEROES.    00009700
011500    05  EUROPEAN-IND-CNT              PIC 9(06)  VALUE ZEROES.    00009800
011600    05  REPORT-SWITCH                 PIC X(03)  VALUE 'NO '.     00009900
011700    05  USOB-EOF                      PIC X(03)  VALUE 'NO '.     00010000
011800    05  EVS-REC-CREATED               PIC 9(06)  VALUE ZEROS.     00010100
011900    05  EVS-REC-UPDATED               PIC 9(06)  VALUE ZEROS.     00010200
012000    05  WS-CONTROL-NUMBER             PIC 9(09)  VALUE ZEROS.     00010300
012100    05  NAV-UPDATE-CNT                PIC 9(06)  VALUE ZEROS.     00010400
012200    05  CANCEL-REC-NO-WRITE           PIC 9(06)  VALUE ZEROS.     00010500
012300    05  CANCEL-REC-REACTIVE-CNT       PIC 9(06)  VALUE ZEROS.     00010510
012400    05  LINE-CNT                      PIC 9(02)  VALUE 61.        00010600
012500    05  PAGE-CNT                      PIC 9(04)  VALUE ZEROS.     00010700
012600    05  WS-WORK-DATE-CYYMMDD          PIC X(07)  VALUE SPACES.    00010800
012700    05  WS-30-DAYS-PRIOR-WORK         PIC X(10)  VALUE SPACES.    00010900
012800    05  WS-30-DAYS-PRIOR.                                         00011000
012900        10  WS-30-DAYS-PRIOR-CC       PIC X(02)  VALUE SPACES.    00011100
013000        10  WS-30-DAYS-PRIOR-YY       PIC X(02)  VALUE SPACES.    00011200
013100        10  FILLER                    PIC X(01)  VALUE SPACES.    00011300
013200        10  WS-30-DAYS-PRIOR-MM       PIC X(02)  VALUE SPACES.    00011400
013300        10  FILLER                    PIC X(01)  VALUE SPACES.    00011500
013400        10  WS-30-DAYS-PRIOR-DD       PIC X(02)  VALUE SPACES.    00011600
013500                                                                  00011700
013600    05  WS-WORK-DATE.                                             00011800
013700        10  WS-WORK-C                 PIC X(01)  VALUE SPACES.    00011900
013800        10  WS-WORK-YY                PIC X(02)  VALUE SPACES.    00012000
013900        10  WS-WORK-MM                PIC X(02)  VALUE SPACES.    00012100
014000        10  WS-WORK-DD                PIC X(02)  VALUE SPACES.    00012200
014100                                                                  00012300
014200    05  WS-ORD-RCPT-DATE-CYYMMDD      PIC X(07)  VALUE SPACES.    00012310
014300    05  WS-ORD-RCPT-DT    REDEFINES WS-ORD-RCPT-DATE-CYYMMDD.     00012400
014400        10  WS-ORD-RCPT-DT-C          PIC X(01).                  00012500
014500        10  WS-ORD-RCPT-DT-YYMMDD.                                00012600
014600            15  WS-ORD-RCPT-DT-YY     PIC X(02).                  00012700
014700            15  WS-ORD-RCPT-DT-MM     PIC X(02).                  00012800
014800            15  WS-ORD-RCPT-DT-DD     PIC X(02).                  00012900
014900                                                                  00013000
015000    05  WS-CDDB-S-DLR.                                            00013100
015100        10  WS-CDDB-S-DLR1            PIC X(01)  VALUE SPACES.    00013200
015200        10  WS-CDDB-S-DLR2            PIC X(01)  VALUE SPACES.    00013300
015300        10  WS-CDDB-S-DLR3            PIC X(01)  VALUE SPACES.    00013400
015400                                                                  00013500
015500    05  WS-HOLD-CDDB-KEY.                                         00013600
015600        10  WS-HOLD-DIV               PIC X(01)  VALUE SPACES.    00013700
015700        10  WS-HOLD-DIST              PIC X(02)  VALUE SPACES.    00013800
015800        10  WS-HOLD-DLR               PIC X(03)  VALUE SPACES.    00013900
015900                                                                  00014000
016000    05  PRODUCTION-DATE.                                          00014100
016100        10  PROD-C                    PIC 9(01)  VALUE ZEROS.     00014200
016200        10  PROD-YEAR                 PIC 9(02)  VALUE ZEROS.     00014300
016300        10  PROD-MONTH                PIC 9(02)  VALUE ZEROS.     00014400
016400                                                                  00014500
016500    05  TODAYS-DATE.                                              00014600
016600        10  TD-YY                     PIC X(02)  VALUE SPACES.    00014700
016700        10  TD-MM                     PIC X(02)  VALUE SPACES.    00014800
016800        10  TD-DD                     PIC X(02)  VALUE SPACES.    00014900
016900                                                                  00015000
017000    05  CALC-MONTH-YEAR.                                          00015100
017100        10  CALC-MM                   PIC X(02)  VALUE SPACES.    00015200
017200        10  CALC-MM-N REDEFINES CALC-MM PIC 9(02).                00015300
017300        10  CALC-YY                   PIC X(02)  VALUE SPACES.    00015400
017400        10  CALC-YY-N REDEFINES CALC-YY PIC 9(02).                00015500
017500                                                                  00015600
017600    05  HOLD-MONTH.                                               00015700
017700        10  HOLD-MM                   PIC X(02)  VALUE SPACES.    00015800
017800        10  HOLD-MM-N REDEFINES HOLD-MM PIC 9(02).                00015900
017900                                                                  00016000
018000    05  TODAYS-DATE-PRINT.                                        00016100
018100        10  TD-PRINT-MM               PIC X(02)  VALUE SPACES.    00016200
018200        10  FILLER                    PIC X(01)  VALUE '/'.       00016300
018300        10  TD-PRINT-DD               PIC X(02)  VALUE SPACES.    00016400
018400        10  FILLER                    PIC X(01)  VALUE '/'.       00016500
018500        10  TD-PRINT-YY               PIC X(02)  VALUE SPACES.    00016600
018600                                                                  00016700
018700    05  TODAYS-TIME.                                              00016800
018800        10  TT-HH                     PIC X(02)  VALUE SPACES.    00016900
018900        10  TT-MM                     PIC X(02)  VALUE SPACES.    00017000
019000        10  TT-SS                     PIC X(02)  VALUE SPACES.    00017100
019100        10  TT-HS                     PIC X(02)  VALUE SPACES.    00017200
019200                                                                  00017300
019300    05  TODAYS-TIME-PRINT.                                        00017400
019400        10  TT-PRINT-HH               PIC X(02)  VALUE SPACES.    00017500
019500        10  FILLER                    PIC X(01)  VALUE ':'.       00017600
019600        10  TT-PRINT-MM               PIC X(02)  VALUE SPACES.    00017700
019700        10  FILLER                    PIC X(01)  VALUE ':'.       00017800
019800        10  TT-PRINT-SS               PIC X(02)  VALUE SPACES.    00017900
019900                                                                  00018000
020000    05  AUDIT-HEADER.                                             00018100
020100        10  FILLER                    PIC X(05)  VALUE SPACES.    00018200
020200        10  AUDIT-HEADING             PIC X(128) VALUE SPACES.    00018300
020300                                                                  00018400
020400    05  AUDIT-DETAIL.                                             00018500
020500        10  FILLER                    PIC X(05)  VALUE SPACES.    00018600
020600        10  AUDIT-MESSAGE             PIC X(26)  VALUE SPACES.    00018700
020700        10  AUDIT-SEP                 PIC X(03)  VALUE SPACES.    00018800
020800        10  AUDIT-COUNT.                                          00018900
020900            15  AUDIT-COUNT1.                                     00019000
021000                20  AUDIT-MDL-YR      PIC X(01)  VALUE SPACES.    00019100
021100                20  AUDIT-WMI         PIC X(03)  VALUE SPACES.    00019200
021200                20  AUDIT-PLT         PIC X(01)  VALUE SPACES.    00019300
021300                20  AUDIT-SER         PIC X(06)  VALUE SPACES.    00019400
021400                20  FILLER            PIC X(09)  VALUE SPACES.    00019500
021500            15  AUDIT-COUNT2          PIC X(20)  VALUE SPACES.    00019600
021600            15  AUDIT-COUNT3          PIC X(20)  VALUE SPACES.    00019700
021700            15  AUDIT-COUNT4          PIC X(20)  VALUE SPACES.    00019800
021800            15  AUDIT-COUNT5          PIC X(19)  VALUE SPACES.    00019900
021900                                                                  00020000
022000    05  CONTROL-RECORD.                                           00020100
022100        10  CR-CONTROL-NUMBER         PIC 9(09).                  00020200
022200        10  CR-PROGRAM-NAME           PIC X(08).                  00020300
022300        10  CR-DATE-UPDATED           PIC X(06).                  00020400
022400        10  CR-TIME-UPDATED           PIC X(08).                  00020500
022500        10  CR-FILLER                 PIC X(11).                  00020600
022600                                                                  00020700
022700    05  S2-KEY-FOUND-FLAG             PIC X(01) VALUE 'N'.        00020800
022800        88 S2-KEY-FOUND               VALUE 'Y'.                  00020900
022900        88 S2-KEY-NOT-FOUND           VALUE 'N'.                  00021000
023000                                                                  00021100
023100    05  S2KEY-MISMATCH-CAN-FLAG       PIC X(01) VALUE 'N'.        00021200
023200        88 S2KEY-MISMATCH-CAN         VALUE 'Y'.                  00021300
023300                                                                  00021400
023400    05  WS-STATUS-CODE                PIC X(03) VALUE SPACES.     00021500
023500    05  WS-DUPLICATE-S1-FLAG          PIC X(01) VALUE 'N'.        00021600
023600        88 WS-DUPLICATE-S1                      VALUE 'Y'.        00021700
023700        88 WS-NO-DUPLICATE-S1                   VALUE 'N'.        00021800
023800                                                                  00021900
023900***************   END OF SAVE WORK-SAVE-AREA-2 ************       00022000
024000*                                                                 00022100
024100 01  WS-VO-22                         PIC X(01) VALUE SPACES.     00022200
024200     88 RETAIL-UNIT                             VALUE '1'.        00022300
024300     88 VO-22-IS-9                              VALUE '9'.        00022400
024400 01  WS-VO-23                         PIC X(01) VALUE SPACES.     00022500
024500     88 STOCK-UNIT                              VALUE 'S'.        00022600
024600     88 FLEET-UNIT                              VALUE             00022700
024700                          'F' 'C' 'G' 'L' 'M' 'A' 'R' 'U'.        00022800
024800 01  WS-RECORD-COUNT.                                             00022900
024900     05  WS-RECORD-CNT                PIC S9(05) COMP.            00023000
025000 01  EVS-MSTR-KEYS.                                               00023100
025100     05  EVS-S-1-KEY.                                             00023200
025200         10  EVS-S-1-MODEL-YR         PIC X(01).                  00023300
025300         10  EVS-S-1-DIST             PIC X(02).                  00023400
025400         10  EVS-S-1-DLR.                                         00023500
025500             15  EVS-S-1-DLR-1        PIC X(01).                  00023600
025600             15  EVS-S-1-DLR-2-3      PIC X(02).                  00023700
025700         10  EVS-S-1-BODY             PIC X(03).                  00023800
025800         10  EVS-S-1-ITEM             PIC X(04).                  00023900
025900                                                                  00024000
026000  01  EVS-S-2KEY.                                                 00024100
026100      05  EVS-S-2-MODEL-YR            PIC X(01).                  00024200
026200      05  EVS-S-2-WMI.                                            00024300
026300          10  EVS-S-2-WMI-1-2.                                    00024400
026400              15  EVS-S-2-WMI-1       PIC X(01).                  00024500
026500              15  EVS-S-2-WMI-2       PIC X(01).                  00024600
026600          10  EVS-S-2-WMI-3           PIC X(01).                  00024700
026700      05  EVS-S-2-PLANT               PIC X(01).                  00024800
026800      05  EVS-S-2-BASE                PIC X(06).                  00024900
026900                                                                  00025000
027000 01  USOB-RECORD.                                                 00025100
027100     05  USOB-DATA                    PIC X(393).                 00025200
027200                                                                  00025300
027300 01  AUDIT-DATA.                                                  00025400
027400     05  AUDIT-CC                     PIC X(01).                  00025500
027500     05  AUDIT-RECORD                 PIC X(132).                 00025600
027600                                                                  00025700
027700 01  REPORT-DATA.                                                 00025800
027800     05  REPORT-CC                    PIC X(01).                  00025900
027900     05  REPORT-RECORD                PIC X(132).                 00026000
028000                                                                  00026100
028100 01  REPORT-HEADING1.                                             00026200
028200     05  FILLER                       PIC X(02)  VALUE SPACES.    00026300
028300     05  FILLER                       PIC X(07)  VALUE 'EXVS100'. 00026400
028400     05  FILLER                       PIC X(41)  VALUE SPACES.    00026500
028500     05  FILLER                       PIC X(21)                   00026600
028600         VALUE 'EXPORT VEHICLE SYSTEM'.                           00026700
028700     05  FILLER                       PIC X(46)  VALUE SPACES.    00026800
028800     05  FILLER                       PIC X(07)  VALUE 'PAGE:'.   00026900
028900     05  FILLER                       PIC X(04)  VALUE SPACES.    00027000
029000     05  PAGE-NUMBER                  PIC Z(03)9 VALUE ZEROS.     00027100
029100     05  FILLER                       PIC X(01)  VALUE SPACES.    00027200
029200                                                                  00027300
029300 01  REPORT-HEADING2.                                             00027400
029400     05  FILLER                       PIC X(02)  VALUE SPACES.    00027500
029500     05  FILLER                       PIC X(16)                   00027600
029600         VALUE 'REPORT NO. FDBJ '.                                00027700
029700     05  FILLER                       PIC X(25)  VALUE SPACES.    00027800
029800     05  FILLER                       PIC X(35)                   00027900
029900         VALUE 'UNSCHEDULED ORDER BANK ERROR REPORT'.             00028000
030000     05  FILLER                       PIC X(39)  VALUE SPACES.    00028100
030100     05  FILLER                       PIC X(07)  VALUE 'DATE:'.   00028200
030200     05  REPORT-DATE                  PIC X(08)  VALUE SPACES.    00028300
030300     05  FILLER                       PIC X(01)  VALUE SPACES.    00028400
030400                                                                  00028500
030500 01  REPORT-HEADING2-5.                                           00028600
030600     05  FILLER                       PIC X(02)  VALUE SPACES.    00028700
030700     05  PGM-HEADING                  PIC X(50)  VALUE SPACES.    00028800
030800     05  FILLER                       PIC X(65)  VALUE SPACES.    00028900
030900     05  FILLER                       PIC X(07)  VALUE 'TIME:'.   00029000
031000     05  REPORT-TIME                  PIC X(08)  VALUE SPACES.    00029100
031100     05  FILLER                       PIC X(01)  VALUE SPACES.    00029200
031200                                                                  00029300
031300 01  REPORT-HEADING3.                                             00029400
031400     05  FILLER                       PIC X(02)  VALUE SPACES.    00029500
031500     05  FILLER                       PIC X(35)                   00029600
031600         VALUE 'MY DLR BODY ORD   WMI MY PLT SER   '.             00029700
031700     05  FILLER                       PIC X(32)                   00029800
031800         VALUE ' ERROR                  MESSAGE'.                 00029900
031900     05  FILLER                       PIC X(64)  VALUE SPACES.    00030000
032000                                                                  00030100
032100 01  REPORT-HEADING4.                                             00030200
032200     05  FILLER                       PIC X(02)  VALUE SPACES.    00030300
032300     05  FILLER                       PIC X(35)                   00030400
032400         VALUE '---------------   --------------   '.             00030500
032500     05  FILLER                       PIC X(32)                   00030600
032600         VALUE ' -----                  -------'.                 00030700
032700     05  FILLER                       PIC X(64)  VALUE SPACES.    00030800
032800                                                                  00030900
032900 01  REPORT-DETAIL.                                               00031000
033000     05  FILLER                       PIC X(03)  VALUE SPACES.    00031100
033100     05  RPT-MY-DLR-BDY-ORD.                                      00031200
033200         10  RPT-MY                   PIC X(01)  VALUE SPACES.    00031300
033300         10  RPT-DLR-BDY-ORD          PIC X(12)  VALUE SPACES.    00031400
033400     05  FILLER                       PIC X(07)  VALUE SPACES.    00031500
033500     05  RPT-WMI-MY-PLT-SER.                                      00031600
033600         10  RPT-WMI.                                             00031700
033700             15  RPT-WMI-1-2          PIC X(02)  VALUE SPACES.    00031800
033800         10  RPT-MY2                  PIC X(01)  VALUE SPACES.    00031900
033900         10  RPT-PLT                  PIC X(01)  VALUE SPACES.    00032000
034000         10  RPT-SER                  PIC X(06)  VALUE SPACES.    00032100
034100     05  FILLER                       PIC X(05)  VALUE SPACES.    00032200
034200     05  RPT-ERROR-CONDITION          PIC X(20)  VALUE SPACES.    00032300
034300     05  FILLER                       PIC X(03)  VALUE SPACES.    00032400
034400     05  RPT-MESSAGE                  PIC X(70)  VALUE SPACES.    00032500
034500     05  FILLER                       PIC X(02)  VALUE SPACES.    00032600
034600                                                                  00032700
034700 01  USOB-WORK.                                                   00032800
034800     05  UW-1.                                                    00032900
034900         10  UW-CONTROL.                                          00033000
035000             15  UW-MODEL-YR          PIC X(02)  VALUE SPACES.    00033100
035100             15  UW-DIVISION          PIC X(01)  VALUE SPACES.    00033200
035200             15  UW-DIST              PIC X(02)  VALUE SPACES.    00033300
035300             15  UW-DLR               PIC X(03)  VALUE SPACES.    00033400
035400             15  UW-ITEM-1-6.                                     00033500
035500                 20  UW-ITEM          PIC X(04)  VALUE SPACES.    00033600
035600                 20  UW-ITEM-4-6      PIC X(02)  VALUE SPACES.    00033700
035700         10  OTHER-INFO               PIC X(45)  VALUE SPACES.    00033800
035800         10  UW-VO-1-49.                                          00033900
035900             15  UW-VO-1-26.                                      00034000
036000                 20  UW-VO-1-5.                                   00034100
036100                     22  UW-VO-1-4.                               00034200
036200                         25  UW-VO-1-3 PIC X(03)  VALUE SPACES.   00034300
036300                         25  UW-VO-4   PIC X(01)  VALUE SPACES.   00034400
036400                     22  UW-VO-5       PIC X(01)  VALUE SPACES.   00034500
036500                 20  UW-VO-6-26.                                  00034600
036600                     25 UW-VO-6-21.                               00034700
036700                        30 UW-VO-6-11   PIC X(06) VALUE SPACES.   00034800
036800                        30  UW-VO-12-21 PIC X(10) VALUE SPACES.   00034900
036900                     25 UW-VO-22        PIC X(01) VALUE SPACES.   00035000
037000                     25 UW-VO-23-26.                              00035100
037100                        30 UW-VO-23     PIC X(01) VALUE SPACES.   00035200
037200                        30 UW-VO-24-26  PIC X(03) VALUE SPACES.   00035300
037300             15  UW-VO-27-30            PIC X(04) VALUE SPACES.   00035400
037400             15  UW-VO-31-49.                                     00035500
037500                 20  UW-VO-31-43      PIC X(13)  VALUE SPACES.    00035600
037600                 20  UW-VO-44         PIC X(01)  VALUE SPACES.    00035700
037700                 20  UW-VO-45-47      PIC X(03)  VALUE SPACES.    00035800
037800                 20  UW-VO-48-49      PIC X(02)  VALUE SPACES.    00035900
037900                                                                  00036000
038000     05  UW-2.                                                    00036100
038100         10  UW-VO-50.                                            00036200
038200             15  UW-VO-50-56          PIC X(07)  VALUE SPACES.    00036300
038300             15  UW-VO-57-69          PIC X(13)  VALUE SPACES.    00036400
038400         10  UW-VO-70-75              PIC X(06)  VALUE SPACES.    00036500
038500         10  UW-VO-76-160.                                        00036600
038600           12  UW-VO-76-98            PIC X(23)  VALUE SPACES.    00036700
038700           12  UW-VO-99-160.                                      00036800
038800             15  UW-VO-ENG            PIC X(01)  VALUE SPACES.    00036900
038900             15  UW-VO-100-160.                                   00037000
039000                 20  UW-VO-100-142.                               00037100
039100                    25 UW-VO-100-130  PIC X(31)  VALUE SPACES.    00037200
039200                    25 UW-VO-131      PIC X(01)  VALUE SPACES.    00037300
039300                    25 UW-VO-132-142  PIC X(11)  VALUE SPACES.    00037400
039400                 20  UW-VO-143-160    PIC X(18)  VALUE SPACES.    00037500
039500                                                                  00037600
039600     05  UW-3.                                                    00037700
039700         10  UW-161-200               PIC X(40)  VALUE SPACES.    00037800
039800         10  UW-OB-FIELDS.                                        00037900
039900             15  UW-DLR-ZONE          PIC X(01)  VALUE SPACES.    00038000
040000             15  UW-9270-CL           PIC X(01)  VALUE SPACES.    00038100
040100             15  UW-DIST-CL           PIC X(01)  VALUE SPACES.    00038200
040200             15  UW-DORA-CL           PIC X(01)  VALUE SPACES.    00038300
040300             15  UW-STATUS            PIC X(03)  VALUE SPACES.    00038400
040400             15  UW-DEALER-STATE      PIC X(02)  VALUE SPACES.    00038500
040500             15  UW-SOURCE-DIV        PIC X(01)  VALUE SPACES.    00038600
040600             15  UW-SOURCE-DIST       PIC X(02)  VALUE SPACES.    00038700
040700             15  UW-BATCH-NUM         PIC X(03)  VALUE SPACES.    00038800
040800             15  UW-PROCESS-DATE      PIC X(06)  VALUE SPACES.    00038900
040900             15  UW-RECEIPT-DATE      PIC X(06)  VALUE SPACES.    00039000
041000             15  UW-SCHEDULE-DATE     PIC X(06)  VALUE SPACES.    00039100
041100             15  UW-SPEC-CHANGE-DATE  PIC X(06)  VALUE SPACES.    00039200
041200             15  UW-DSO-PLT-SUB-DATE  PIC X(06)  VALUE SPACES.    00039300
041300             15  UW-STATUS-DATE       PIC X(06)  VALUE SPACES.    00039400
041400             15  UW-PLT-SUB-DATE      PIC X(06)  VALUE SPACES.    00039500
041500         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00039600
041600         10  UW-OB-TRLR-FF            PIC 9(01)  VALUE ZEROS.     00039700
041700         10  UW-OB-TRLR-ERROR         PIC 9(01)  VALUE ZEROS.     00039800
041800         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00039900
041900         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00040000
042000         10  UW-OB-TRLR-SHDL          PIC 9(01)  VALUE ZEROS.     00040100
042100         10  UW-OB-TRLR-SHPT          PIC 9(01)  VALUE ZEROS.     00040200
042200         10  UW-OB-TRLR-SHTH          PIC 9(01)  VALUE ZEROS.     00040300
042300         10  UW-OB-TRLR-COMP          PIC 9(01)  VALUE ZEROS.     00040400
042400         10  UW-OB-TRLR-PRCN          PIC 9(01)  VALUE ZEROS.     00040500
042500         10  UW-OB-TRLR-CUST          PIC 9(01)  VALUE ZEROS.     00040600
042600         10  UW-OB-TRLR-RMKS          PIC 9(01)  VALUE ZEROS.     00040700
042700         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00040800
042800         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00040900
042900         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00041000
043000         10  UW-OB-TRLR-NOTE          PIC 9(01)  VALUE ZEROS.     00041100
043100         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00041200
043200         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00041300
043300         10  UW-OB-TRLR-DSO1          PIC 9(01)  VALUE ZEROS.     00041400
043400         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00041500
043500         10  FILLER                   PIC 9(01)  VALUE ZEROS.     00041600
043600         10  UW-OB-TRLR-DSO2          PIC 9(01)  VALUE ZEROS.     00041700
043700         10  UW-OB-TRLR-DSO3          PIC 9(01)  VALUE ZEROS.     00041800
043800                                                                  00041900
043900     05  UW-4.                                                    00042000
044000         10  UW-OB-INDICATORS.                                    00042100
044100             15  UW-CONV-ERR          PIC X(01)  VALUE SPACES.    00042200
044200             15  UW-DSO-PTO           PIC X(01)  VALUE SPACES.    00042300
044300             15  UW-DIST-PREP-CTR     PIC X(01)  VALUE SPACES.    00042400
044400             15  UW-ASSOC-DLR-CTR     PIC X(01)  VALUE SPACES.    00042500
044500             15  UW-FRCS              PIC X(01)  VALUE SPACES.    00042600
044600             15  UW-SUN-ROOF          PIC X(01)  VALUE SPACES.    00042700
044700             15  UW-PERM-LI           PIC X(01)  VALUE SPACES.    00042800
044800             15  UW-PERM-LII          PIC X(01)  VALUE SPACES.    00042900
044900             15  UW-SPEC-CHG          PIC X(01)  VALUE SPACES.    00043000
045000             15  UW-ERROR-LVL         PIC X(01)  VALUE SPACES.    00043100
045100             15  UW-PROD-HOLD         PIC X(01)  VALUE SPACES.    00043200
045200         10  UW-OB-FIELDS-2.                                      00043300
045300             15  UW-PREP-CENTER-2     PIC X(01)  VALUE SPACES.    00043400
045400             15  UW-GAS-ALLOW         PIC X(01)  VALUE SPACES.    00043500
045500             15  UW-WAIVE-ADV         PIC X(01)  VALUE SPACES.    00043600
045600             15  UW-DOE-IND           PIC X(01)  VALUE SPACES.    00043700
045700             15  UW-DIST-ASGN-PLT     PIC X(01)  VALUE SPACES.    00043800
045800             15  UW-OVER-BASIC        PIC X(01)  VALUE SPACES.    00043900
045900             15  UW-PLT-SUB-IND       PIC X(01)  VALUE SPACES.    00044000
046000             15  UW-COUNTY-CODE       PIC X(03)  VALUE SPACES.    00044100
046100             15  UW-CITY-CODE         PIC X(02)  VALUE SPACES.    00044200
046200             15  UW-IMP-ASGN-TO-US-NUM    PIC X(04)  VALUE SPACES.00044300
046300             15  UW-DIESEL-FRAN       PIC X(01)  VALUE SPACES.    00044400
046400             15  UW-MNF-MLF           PIC X(01)  VALUE SPACES.    00044500
046500             15  UW-REV-DORA-GEN      PIC X(01)  VALUE SPACES.    00044600
046600             15  UW-DORA-GEN          PIC X(01)  VALUE SPACES.    00044700
046700             15  UW-IMPORT-TRANS-PROC PIC X(01)  VALUE SPACES.    00044800
046800             15  UW-CAN-VEH-CODE      PIC X(03)  VALUE SPACES.    00044900
046900             15  UW-ORD-SUB-STATUS    PIC X(02)  VALUE SPACES.    00045000
047000             15  UW-FLEET-BID         PIC X(06)  VALUE SPACES.    00045100
047100             15  UW-VOC               PIC X(11)  VALUE SPACES.    00045200
047200             15  FILLER               PIC X(66)  VALUE SPACES.    00045300
047300                                                                  00045400
047400 01  TEMP-KEY-FOR-AUDIT-RPT.                                      00045500
047500     05  TKA-MODEL-YR                 PIC X(01)  VALUE SPACES.    00045600
047600     05  TKA-DIST                     PIC X(02)  VALUE SPACES.    00045700
047700     05  TKA-DLR                      PIC X(03)  VALUE SPACES.    00045800
047800     05  TKA-BODY                     PIC X(03)  VALUE SPACES.    00045900
047900     05  TKA-ORDER                    PIC X(04)  VALUE SPACES.    00046000
048000                                                                  00046100
048100 01  MONTH-NUMERIC-DESC.                                          00046200
048200     05  FILLER                       PIC X(03)  VALUE 'A01'.     00046300
048300     05  FILLER                       PIC X(03)  VALUE 'B02'.     00046400
048400     05  FILLER                       PIC X(03)  VALUE 'C03'.     00046500
048500     05  FILLER                       PIC X(03)  VALUE 'D04'.     00046600
048600     05  FILLER                       PIC X(03)  VALUE 'E05'.     00046700
048700     05  FILLER                       PIC X(03)  VALUE 'F06'.     00046800
048800     05  FILLER                       PIC X(03)  VALUE 'G07'.     00046900
048900     05  FILLER                       PIC X(03)  VALUE 'H08'.     00047000
049000     05  FILLER                       PIC X(03)  VALUE 'J09'.     00047100
049100     05  FILLER                       PIC X(03)  VALUE 'K10'.     00047200
049200     05  FILLER                       PIC X(03)  VALUE 'L11'.     00047300
049300     05  FILLER                       PIC X(03)  VALUE 'M12'.     00047400
049400                                                                  00047500
049500 01  MONTH-SEARCH REDEFINES MONTH-NUMERIC-DESC.                   00047600
049600     05  MONTH-DATA OCCURS 12 TIMES INDEXED BY MONTH-INDEX.       00047700
049700         10  MONTH-ALPHA              PIC X(01).                  00047800
049800         10  MONTH-NUMERIC            PIC X(02).                  00047900
049900                                                                  00048000
050000 01  ERR-INFO.                                                    00048100
050100     05  ERR-ABEND-PARA               PIC X(30) VALUE SPACES.     00048200
050200     05  ERR-ABEND-CODE               PIC X(02) VALUE SPACES.     00048300
050300     05  ERR-FUNCTION-CALL            PIC X(08) VALUE SPACES.     00048400
050400     05  ERR-SEG-NAME                 PIC X(20) VALUE SPACES.     00048500
050500     05  ERR-PROG-NAME                PIC X(20) VALUE SPACES.     00048600
050600     05  ERR-SQLCODE                  PIC X(04) VALUE SPACES.     00048700
050700     05  ERR-TABLE-NAME               PIC X(20) VALUE SPACES.     00048800
050800     05  ERR-S-1-KEY.                                             00048900
050900         10  ERR-S-MODEL-YR           PIC X(01) VALUE SPACES.     00049000
051000         10  ERR-S-DIST               PIC X(02) VALUE SPACES.     00049100
051100         10  ERR-S-DLR                PIC X(03) VALUE SPACES.     00049200
051200         10  ERR-S-BODY               PIC X(03) VALUE SPACES.     00049300
051300         10  ERR-S-ITEM               PIC X(04) VALUE SPACES.     00049400
051400                                                                  00049500
051500 01  ADVANCE-TOP-OF-PAGE              PIC X(01) VALUE '1'.        00049600
051600 01  ADVANCE-LINE1                    PIC X(01) VALUE SPACES.     00049700
051700 01  ADVANCE-LINE2                    PIC X(01) VALUE '0'.        00049800
051800 01  ADVANCE-LINE3                    PIC X(01) VALUE '2'.        00049900
051900                                                                  00050000
052000*********    SAVE AREAS FOR RESTART                               00050100
052100 01  CNT-CHECKPOINT                   PIC S9(07) VALUE ZEROS.     00050200
052200 01  XRST-SAVE-AREAS.                                             00050300
052300     05  SAVE1-AREA.                                              00050400
052400         10 SAVE-CHKP-LIMIT           PIC S9(07) VALUE +100.      00050500
052500     05  SAVE2-AREA.                                              00050600
052600         10  FILLER                   PIC X(0700) VALUE SPACES.   00050700
052700     05  SAVE3-AREA.                                              00050800
052800         10  FILLER                   PIC X(01) VALUE SPACES.     00050900
052900     05  SAVE4-AREA.                                              00051000
053000         10  FILLER                   PIC X(01) VALUE SPACES.     00051100
053100     05  SAVE5-AREA.                                              00051200
053200         10  FILLER                   PIC X(01) VALUE SPACES.     00051300
053300     05  SAVE6-AREA.                                              00051400
053400         10  FILLER                   PIC X(01) VALUE SPACES.     00051500
053500     05  SAVE7-AREA.                                              00051600
053600         10  FILLER                   PIC X(01) VALUE SPACES.     00051700
053700 01  SAVE-AREA-LENGTHS.                                           00051800
053800     05  I-O-AREA-LENGTH              PIC S9(05) COMP VALUE +10.  00051900
053900     05  SAVE1-LENGTH                 PIC S9(05) COMP VALUE +7.   00052000
054000     05  SAVE2-LENGTH                 PIC S9(05) COMP VALUE +700. 00052100
054100     05  SAVE3-LENGTH                 PIC S9(05) COMP VALUE +1.   00052200
054200     05  SAVE4-LENGTH                 PIC S9(05) COMP VALUE +1.   00052300
054300     05  SAVE5-LENGTH                 PIC S9(05) COMP VALUE +1.   00052400
054400     05  SAVE6-LENGTH                 PIC S9(05) COMP VALUE +1.   00052500
054500     05  SAVE7-LENGTH                 PIC S9(05) COMP VALUE +1.   00052600
054600                                                                  00052700
054700*********    END OF SAVE AREAS FOR RESTART                        00052800
054800/                                                                 00052900
054900 COPY CPEX201.                                                    00053000
055000/                                                                 00053100
055100 COPY CPEX001.                                                    00053200
055200/                                                                 00053300
055300 COPY CPEX002.                                                    00053400
055400/                                                                 00053500
055500 COPY CPEX003.                                                    00053600
055600/                                                                 00053700
055700 COPY CPEX012.                                                    00053800
055800/                                                                 00053900
055900 COPY CPEX016.                                                    00054000
056000/                                                                 00054100
056100 COPY CPEXSQL.                                                    00054200
056200/                                                                 00054300
056300 COPY CPEXMSTR.                                                   00054400
056400/                                                                 00054500
056500*++INCLUDE PCPTSIMS2                                              00054600
056600 COPY CPTSIMS2.                                                         00
056700/                                                                 00054700
056800***************************************************************** 00054800
056900*                                                               * 00054900
057000*           GSAM1             LOGICAL TERMINAL PCB              * 00055000
057100*   THIS IS THE PCB FOR USOB FILE (INPUT)                       * 00055100
057200***************************************************************** 00055200
057300 01  GSAM1-I-O-PCB.                                               00055300
057400     05  GSAM1-I-O-NAME               PIC X(8) VALUE 'MDEXG100'.  00055400
057500     05  FILLER                       PIC XX.                     00055500
057600     05  GSAM1-I-O-STATUS             PIC XX.                     00055600
057700***************************************************************** 00055700
057800*                                                               * 00055800
057900*           GSAM2             LOGICAL TERMINAL PCB              * 00055900
058000*   THIS IS THE PCB FOR AUDIT REPORT FILE (OUTPUT)              * 00056000
058100***************************************************************** 00056100
058200 01  GSAM2-I-O-PCB.                                               00056200
058300     05  GSAM2-I-O-NAME               PIC X(8) VALUE 'MDEXG101'.  00056300
058400     05  FILLER                       PIC XX.                     00056400
058500     05  GSAM2-I-O-STATUS             PIC XX.                     00056500
058600***************************************************************** 00056600
058700*                                                               * 00056700
058800*           GSAM3             LOGICAL TERMINAL PCB              * 00056800
058900*   THIS IS THE PCB FOR ERROR FILE (OUTPUT)                     * 00056900
059000***************************************************************** 00057000
059100 01  GSAM3-I-O-PCB.                                               00057100
059200     05  GSAM3-I-O-NAME               PIC X(8) VALUE 'MDEXG102'.  00057200
059300     05  FILLER                       PIC XX.                     00057300
059400     05  GSAM3-I-O-STATUS             PIC XX.                     00057400
059500***************************************************************** 00057500
059600/                                                                 00057600
059700 PROCEDURE DIVISION.                                              00057700
059800/                                                                 00057800
059900 0000-MAIN-PROCESSING.                                            00057900
060000******************************************************************00058000
060100*                                                                *00058100
060200*  DESCRIPTION:   MAIN PROCESSING                                *00058200
060300*                                                                *00058300
060400******************************************************************00058400
060500                                                                  00058500
060600      ENTRY 'DLITCBL'  USING    I-O-PCB,                          00058600
060700                                GSAM1-I-O-PCB,                    00058700
060800                                GSAM2-I-O-PCB,                    00058800
060900                                GSAM3-I-O-PCB.                    00058900
061000                                                                  00059000
061100      PERFORM XRST-LOGIC.                                         00059100
061200                                                                  00059200
061300      OPEN INPUT PARMFILE.                                        00059300
061400                                                                  00059400
061500      READ PARMFILE                                               00059500
061600         AT END                                                   00059600
061700            MOVE +1000                TO CHECKPOINT-FREQUENCY     00059700
061800            MOVE 'PROD'               TO RUN-MODE.                00059800
061900                                                                  00059900
062000      MOVE  CHECKPOINT-FREQUENCY      TO SAVE-CHKP-LIMIT.         00060000
062100                                                                  00060100
062200      IF XRST-ID = SPACES                                         00060200
062300         PERFORM 1000-HOUSEKEEPING                                00060300
062400         PERFORM 2000-READ-CNTL-FILE                              00060400
062500      ELSE                                                        00060500
062600         ACCEPT TODAYS-DATE  FROM DATE                            00060600
062700         ACCEPT TODAYS-TIME  FROM TIME                            00060700
062800         MOVE TD-YY                   TO TD-PRINT-YY              00060800
062900         MOVE TD-MM                   TO TD-PRINT-MM              00060900
063000         MOVE TD-DD                   TO TD-PRINT-DD              00061000
063100         MOVE TT-HH                   TO TT-PRINT-HH              00061100
063200         MOVE TT-MM                   TO TT-PRINT-MM              00061200
063300         MOVE TT-SS                   TO TT-PRINT-SS              00061300
063400         MOVE TODAYS-DATE-PRINT       TO REPORT-DATE              00061400
063500         MOVE TODAYS-TIME-PRINT       TO REPORT-TIME              00061500
063600         STRING 'EXVS100 BEING RESTARTED AT CHECKPOINT --- ',     00061600
063700         XRST-ID, ' ON ', TODAYS-DATE-PRINT,                      00061700
063800         ' AT ', TODAYS-TIME-PRINT                                00061800
063900         DELIMITED BY SIZE INTO AUDIT-RECORD                      00061900
064000         MOVE ADVANCE-LINE3           TO AUDIT-CC                 00062000
064100         PERFORM 8100-WRITE-AUDIT-RECORD                          00062100
064200      END-IF.                                                     00062200
064300                                                                  00062300
064400      PERFORM 3000-PROCESS                                        00062400
064500              UNTIL USOB-EOF = 'YES'.                             00062500
064600                                                                  00062600
064700      PERFORM 6000-WRITE-CNTL-FILE.                               00062700
064800                                                                  00062800
064900      PERFORM 8000-WRITE-AUDIT-REPORT.                            00062900
065000                                                                  00063000
065100      PERFORM 9900-EOJ.                                           00063100
065200                                                                  00063200
065300      PERFORM  NORMAL-PROGRAM-TERMINATION.                        00063300
065400/                                                                 00063400
065500 1000-HOUSEKEEPING.                                               00063500
065600                                                                  00063600
065700******************************************************************00063700
065800*                                                                *00063800
065900*  DESCRIPTION:  ACCEPTS DATE AND TIME, OPENS FILES, WRITES      *00063900
066000*                HEADER ON AUDIT REPORT                          *00064000
066100*                                                                *00064100
066200******************************************************************00064200
066300                                                                  00064300
066400      ACCEPT TODAYS-DATE  FROM DATE.                              00064400
066500      ACCEPT TODAYS-TIME  FROM TIME.                              00064500
066600                                                                  00064600
066700      MOVE TD-YY                      TO TD-PRINT-YY.             00064700
066800      MOVE TD-MM                      TO TD-PRINT-MM.             00064800
066900      MOVE TD-DD                      TO TD-PRINT-DD.             00064900
067000                                                                  00065000
067100      MOVE TT-HH                      TO TT-PRINT-HH.             00065100
067200      MOVE TT-MM                      TO TT-PRINT-MM.             00065200
067300      MOVE TT-SS                      TO TT-PRINT-SS.             00065300
067400                                                                  00065400
067500      STRING 'PGM VERSION - ', PAN-VALET DELIMITED                00065500
067600             BY SIZE INTO AUDIT-HEADING.                          00065600
067700      MOVE AUDIT-HEADER               TO AUDIT-RECORD.            00065700
067800      MOVE ADVANCE-TOP-OF-PAGE        TO AUDIT-CC.                00065800
067900      PERFORM 8100-WRITE-AUDIT-RECORD                             00065900
068000                                                                  00066000
068100      MOVE SPACES                     TO AUDIT-HEADER.            00066100
068200      MOVE 'EXVS100 AUDIT REPORT (RMDS # = FDBP)'                 00066200
068300                                      TO AUDIT-HEADING.           00066300
068400      MOVE AUDIT-HEADER               TO AUDIT-RECORD.            00066400
068500      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00066500
068600      PERFORM 8100-WRITE-AUDIT-RECORD                             00066600
068700                                                                  00066700
068800      MOVE 'PROGRAM RUN DATE'         TO AUDIT-MESSAGE.           00066800
068900      MOVE ' = '                      TO AUDIT-SEP.               00066900
069000      MOVE TODAYS-DATE-PRINT          TO AUDIT-COUNT.             00067000
069100      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00067100
069200      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00067200
069300      PERFORM 8100-WRITE-AUDIT-RECORD                             00067300
069400                                                                  00067400
069500      MOVE 'PROGRAM START TIME'       TO AUDIT-MESSAGE.           00067500
069600      MOVE ' = '                      TO AUDIT-SEP.               00067600
069700      MOVE TODAYS-TIME-PRINT          TO AUDIT-COUNT.             00067700
069800      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00067800
069900      MOVE ADVANCE-LINE1              TO AUDIT-CC.                00067900
070000      PERFORM 8100-WRITE-AUDIT-RECORD                             00068000
070100                                                                  00068100
070200      MOVE TODAYS-DATE-PRINT          TO REPORT-DATE.             00068200
070300      MOVE TODAYS-TIME-PRINT          TO REPORT-TIME.             00068300
070400      STRING 'PGM VERSION - ', PAN-VALET DELIMITED                00068400
070500             BY SIZE INTO PGM-HEADING.                            00068500
070600                                                                  00068600
070700      PERFORM 8300-WRITE-RPT-HEAD.                                00068700
070800      PERFORM 1500-GET-30-DAYS-PRIOR.                             00068800
070900/                                                                 00068900
071000 1500-GET-30-DAYS-PRIOR.                                          00069000
071100******************************************************************00069100
071200*                                                                *00069200
071300*  DESCRIPTION:  READS CURRENT DATE MINUS 30 DAYS FROM MEXA016.  *00069300
071400*                                                                *00069400
071500******************************************************************00069500
071600                                                                  00069600
071700     EXEC SQL                                                     00069700
071800          SELECT DISTINCT CURRENT DATE - 30 DAYS                  00069800
071900          INTO :WS-30-DAYS-PRIOR-WORK                             00069900
072000          FROM MEXA016JOBPRM                                      00070000
072100     END-EXEC.                                                    00070100
072200                                                                  00070200
072300     EVALUATE SQLCODE                                             00070300
072400       WHEN ZEROS                                                 00070400
072500            CONTINUE                                              00070500
072600       WHEN OTHER                                                 00070600
072700            MOVE SQLCODE             TO EDIT-SQLCODE              00070700
072800            MOVE '1500-GET-30-DAYS-PRIOR' TO ERR-ABEND-PARA       00070800
072900            MOVE SPACES              TO ERR-ABEND-CODE            00070900
073000            MOVE 'SELECT'            TO ERR-FUNCTION-CALL         00071000
073100            MOVE SPACES              TO ERR-SEG-NAME              00071100
073200            MOVE 'EXVS100'           TO ERR-PROG-NAME             00071200
073300            MOVE EDIT-SQLCODE-R      TO ERR-SQLCODE               00071300
073400            MOVE 'MEXA016JOBPRM'     TO ERR-TABLE-NAME            00071400
073500            PERFORM 9999-ABEND                                    00071500
073600      END-EVALUATE.                                               00071600
073700                                                                  00071700
073800      MOVE WS-30-DAYS-PRIOR-WORK     TO WS-30-DAYS-PRIOR.         00071800
073900      IF WS-30-DAYS-PRIOR-CC = '19'                               00071900
074000          MOVE '0'                   TO WS-WORK-C                 00072000
074100      ELSE                                                        00072100
074200          MOVE '1'                   TO WS-WORK-C                 00072200
074300      END-IF.                                                     00072300
074400                                                                  00072400
074500      MOVE WS-30-DAYS-PRIOR-YY       TO WS-WORK-YY.               00072500
074600      MOVE WS-30-DAYS-PRIOR-MM       TO WS-WORK-MM.               00072600
074700      MOVE WS-30-DAYS-PRIOR-DD       TO WS-WORK-DD.               00072700
074800      MOVE WS-WORK-DATE              TO WS-WORK-DATE-CYYMMDD.     00072800
074900/                                                                 00072900
075000 2000-READ-CNTL-FILE.                                             00073000
075100******************************************************************00073100
075200*                                                                *00073200
075300*  DESCRIPTION:  READ THE CONTROL FILE TO OBTAIN THE CURRENT     *00073300
075400*                CONTROL NUMBER FOR NEW RECORDS                  *00073400
075500*                                                                *00073500
075600******************************************************************00073600
075700                                                                  00073700
075800     EXEC SQL                                                     00073800
075900          SELECT MAX(EVS_P_CONTROL_NO)                            00073900
076000          INTO :MEXA001MSTR.EVS-P-CONTROL-NO                      00074000
076100          FROM MEXA001MSTR                                        00074100
076200     END-EXEC.                                                    00074200
076300                                                                  00074300
076400     EVALUATE SQLCODE                                             00074400
076500       WHEN ZEROS                                                 00074500
076600            CONTINUE                                              00074600
076700       WHEN +100                                                  00074700
076800            MOVE 'NO CONTROL RECORD'  TO AUDIT-MESSAGE            00074800
076900            MOVE SPACES               TO AUDIT-COUNT              00074900
077000            MOVE AUDIT-DETAIL         TO AUDIT-RECORD             00075000
077100            MOVE ADVANCE-LINE1        TO AUDIT-CC                 00075100
077200            PERFORM 8100-WRITE-AUDIT-RECORD                       00075200
077300            PERFORM 9920-ABORT-RUN                                00075300
077400       WHEN OTHER                                                 00075400
077500            MOVE SQLCODE             TO EDIT-SQLCODE              00075500
077600            MOVE '2000-READ-CNTL-FILE' TO ERR-ABEND-PARA          00075600
077700            MOVE SPACES              TO ERR-ABEND-CODE            00075700
077800            MOVE 'SELECT'            TO ERR-FUNCTION-CALL         00075800
077900            MOVE SPACES              TO ERR-SEG-NAME              00075900
078000            MOVE 'EXVS100'           TO ERR-PROG-NAME             00076000
078100            MOVE EDIT-SQLCODE-R      TO ERR-SQLCODE               00076100
078200            MOVE 'MEXA001MSTR'       TO ERR-TABLE-NAME            00076200
078300            PERFORM 9999-ABEND                                    00076300
078400      END-EVALUATE.                                               00076400
078500                                                                  00076500
078600      MOVE EVS-P-CONTROL-NO           TO CR-CONTROL-NUMBER.       00076600
078700      MOVE CR-CONTROL-NUMBER          TO WS-CONTROL-NUMBER.       00076700
078800      MOVE 'EXVS100'                  TO CR-PROGRAM-NAME          00076800
078900      MOVE TODAYS-DATE                TO CR-DATE-UPDATED.         00076900
079000      ACCEPT TODAYS-TIME FROM TIME.                               00077000
079100      MOVE TODAYS-TIME                TO CR-TIME-UPDATED.         00077100
079200                                                                  00077200
079300      MOVE 'CONTROL RECORD IN'        TO AUDIT-MESSAGE.           00077300
079400      MOVE ' = '                      TO AUDIT-SEP.               00077400
079500      MOVE CONTROL-RECORD             TO AUDIT-COUNT.             00077500
079600      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00077600
079700      MOVE ADVANCE-LINE2              TO AUDIT-CC                 00077700
079800      PERFORM 8100-WRITE-AUDIT-RECORD.                            00077800
079900/                                                                 00077900
080000 3000-PROCESS.                                                    00078000
080100******************************************************************00078100
080200*                                                                *00078200
080300*  DESCRIPTION:  PERFORMS READS FOR USOB FILE AND EVS MSTR FILE  *00078300
080400*                                                                *00078400
080500******************************************************************00078500
080600                                                                  00078600
080700      CALL 'CBLTDLI'   USING  GN                                  00078700
080800                              GSAM1-I-O-PCB                       00078800
080900                              USOB-RECORD.                        00078900
081000                                                                  00079000
081100      EVALUATE GSAM1-I-O-STATUS                                   00079100
081200       WHEN SPACES                                                00079200
081300            ADD 1                     TO USOB-REC-IN-CNT          00079300
081400            MOVE USOB-RECORD          TO USOB-WORK                00079400
081500            PERFORM 3100-READ-EVS-MSTR                            00079500
081600       WHEN 'GB'                                                  00079600
081700            MOVE 'YES'                TO USOB-EOF                 00079700
081800       WHEN 'GE'                                                  00079800
081900            MOVE 'YES'                TO USOB-EOF                 00079900
082000       WHEN OTHER                                                 00080000
082100            MOVE '3000-PROCESS     '  TO ERR-ABEND-PARA           00080100
082200            MOVE GSAM1-I-O-STATUS     TO ERR-ABEND-CODE           00080200
082300            MOVE GN                   TO ERR-FUNCTION-CALL        00080300
082400            MOVE 'I-O-PCB GSAM1'      TO ERR-SEG-NAME             00080400
082500            MOVE 'EXVS100'            TO ERR-PROG-NAME            00080500
082600            MOVE SPACES               TO ERR-SQLCODE              00080600
082700            MOVE SPACES               TO ERR-TABLE-NAME           00080700
082800            PERFORM 9999-ABEND                                    00080800
082900       END-EVALUATE.                                              00080900
083000                                                                  00081000
083100     IF CNT-CHECKPOINT > SAVE-CHKP-LIMIT                          00081100
083200         MOVE WS-SAVE-AREA-2          TO SAVE2-AREA               00081200
083300         PERFORM CHECK-POINT                                      00081300
083400         IF CHECK-POINT-TAKEN = 'Y'                               00081400
083500             MOVE ZEROES              TO CNT-CHECKPOINT           00081500
083600         END-IF                                                   00081600
083700     END-IF.                                                      00081700
083800/                                                                 00081800
083900 3100-READ-EVS-MSTR.                                              00081900
084000***************************************************************** 00082000
084100*                                                               * 00082100
084200*  DESCRIPTION: READ THE EVS MASTER FILE                        * 00082200
084300*                                                               * 00082300
084400***************************************************************** 00082400
084500                                                                  00082500
084600      INITIALIZE   MEXA001MSTR.                                   00082600
084700      MOVE UW-VO-4                    TO EVS-S-MODEL-YR           00082700
084800                                         EVS-S-1-MODEL-YR.        00082800
084900      MOVE UW-DIST                    TO EVS-S-DIST               00082900
085000                                         EVS-S-1-DIST.            00083000
085100      MOVE UW-DLR                     TO EVS-S-DLR                00083100
085200                                         EVS-S-1-DLR.             00083200
085300      MOVE UW-VO-1-3                  TO EVS-S-BODY               00083300
085400                                         EVS-S-1-BODY.            00083400
085500      MOVE UW-ITEM                    TO EVS-S-ITEM               00083500
085600                                         EVS-S-1-ITEM.            00083600
085700                                                                  00083700
085800     EXEC SQL                                                     00083800
085900          SELECT                                                  00083900
086000                 EVS_P_CONTROL_NO               ,                 00084000
086100                 EVS_S_WMI                      ,                 00084100
086200                 EVS_S_PLANT                    ,                 00084200
086300                 EVS_S_SERIAL                   ,                 00084300
086400                 EVS_S_STATUS_CODE              ,                 00084400
086500                 EVS_S_STATUS_DATE              ,                 00084500
086600                 EVS_U_DIV_CODE                 ,                 00084600
086700                 EVS_U_ORIG_ORD_DIS             ,                 00084700
086800                 EVS_U_ORIG_ORD_DLR             ,                 00084800
086900                 EVS_U_VO_IMAGE                 ,                 00084900
087000                 EVS_U_ORIG_ORD_TYP             ,                 00085000
087100                 EVS_U_BAO_VEH_LINE             ,                 00085100
087200                 EVS_U_MSA_PRC_DT               ,                 00085200
087300                 EVS_U_MSA_REC_DT               ,                 00085300
087400                 EVS_U_SCHED_DT                 ,                 00085400
087500                 EVS_U_SEG_DATE                 ,                 00085500
087600                 EVS_U_SPEC_CHG_DT              ,                 00085600
087700                 EVS_U_DSO_PLT_DT               ,                 00085700
087800                 EVS_U_COMB_ERR_IND             ,                 00085800
087900                 EVS_U_DSO_PTO_IND              ,                 00085900
088000                 EVS_U_ERR_LVL_IND              ,                 00086000
088100                 EVS_U_PROD_H_IND               ,                 00086100
088200                 EVS_U_PLT_SUB_IND              ,                 00086200
088300                 EVS_U_REV_DORA_IND             ,                 00086300
088400                 EVS_U_DORA_GEN_IND             ,                 00086400
088500                 EVS_U_COMP_ERR_IND             ,                 00086500
088600                 EVS_U_DSO_ORD_QTY              ,                 00086600
088700                 EVS_U_DORA_VALUE               ,                 00086700
088800                 EVS_F_REQ_PROD_YM              ,                 00086800
088900                 EVS_F_FLEET_IND                ,                 00086900
089000                 EVS_F_FLT_RTK_IND              ,                 00087000
089100                 EVS_F_DEALER_NAME              ,                 00087100
089200                 EVS_F_MVMA_CNTY_CD             ,                 00087200
089300                 EVS_F_FIES_PROD_PF             ,                 00087300
089400                 EVS_F_FIES_PROD_SF             ,                 00087400
089500                 EVS_F_EST_VALUE                ,                 00087500
089600                 EVS_F_CREATE_RC_DT             ,                 00087600
089700                 EVS_F_EUROPEAN_IND                               00087700
089800          INTO                                                    00087800
089900                :MEXA001MSTR.EVS-P-CONTROL-NO   ,                 00087900
090000                :MEXA001MSTR.EVS-S-WMI          ,                 00088000
090100                :MEXA001MSTR.EVS-S-PLANT        ,                 00088100
090200                :MEXA001MSTR.EVS-S-SERIAL       ,                 00088200
090300                :MEXA001MSTR.EVS-S-STATUS-CODE  ,                 00088300
090400                :MEXA001MSTR.EVS-S-STATUS-DATE  ,                 00088400
090500                :MEXA001MSTR.EVS-U-DIV-CODE     ,                 00088500
090600                :MEXA001MSTR.EVS-U-ORIG-ORD-DIS ,                 00088600
090700                :MEXA001MSTR.EVS-U-ORIG-ORD-DLR ,                 00088700
090800                :MEXA001MSTR.EVS-U-VO-IMAGE     ,                 00088800
090900                :MEXA001MSTR.EVS-U-ORIG-ORD-TYP ,                 00088900
091000                :MEXA001MSTR.EVS-U-BAO-VEH-LINE ,                 00089000
091100                :MEXA001MSTR.EVS-U-MSA-PRC-DT   ,                 00089100
091200                :MEXA001MSTR.EVS-U-MSA-REC-DT   ,                 00089200
091300                :MEXA001MSTR.EVS-U-SCHED-DT     ,                 00089300
091400                :MEXA001MSTR.EVS-U-SEG-DATE     ,                 00089400
091500                :MEXA001MSTR.EVS-U-SPEC-CHG-DT  ,                 00089500
091600                :MEXA001MSTR.EVS-U-DSO-PLT-DT   ,                 00089600
091700                :MEXA001MSTR.EVS-U-COMB-ERR-IND ,                 00089700
091800                :MEXA001MSTR.EVS-U-DSO-PTO-IND  ,                 00089800
091900                :MEXA001MSTR.EVS-U-ERR-LVL-IND  ,                 00089900
092000                :MEXA001MSTR.EVS-U-PROD-H-IND   ,                 00090000
092100                :MEXA001MSTR.EVS-U-PLT-SUB-IND  ,                 00090100
092200                :MEXA001MSTR.EVS-U-REV-DORA-IND ,                 00090200
092300                :MEXA001MSTR.EVS-U-DORA-GEN-IND ,                 00090300
092400                :MEXA001MSTR.EVS-U-COMP-ERR-IND ,                 00090400
092500                :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                 00090500
092600                :MEXA001MSTR.EVS-U-DORA-VALUE   ,                 00090600
092700                :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                 00090700
092800                :MEXA001MSTR.EVS-F-FLEET-IND    ,                 00090800
092900                :MEXA001MSTR.EVS-F-FLT-RTK-IND  ,                 00090900
093000                :MEXA001MSTR.EVS-F-DEALER-NAME  ,                 00091000
093100                :MEXA001MSTR.EVS-F-MVMA-CNTY-CD ,                 00091100
093200                :MEXA001MSTR.EVS-F-FIES-PROD-PF ,                 00091200
093300                :MEXA001MSTR.EVS-F-FIES-PROD-SF ,                 00091300
093400                :MEXA001MSTR.EVS-F-EST-VALUE    ,                 00091400
093500                :MEXA001MSTR.EVS-F-CREATE-RC-DT ,                 00091500
093600                :MEXA001MSTR.EVS-F-EUROPEAN-IND                   00091600
093700          FROM                                                    00091700
093800                       MEXA001MSTR                                00091800
093900          WHERE                                                   00091900
094000            EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR       00092000
094100       AND  EVS_S_DIST        = :MEXA001MSTR.EVS-S-DIST           00092100
094200       AND  EVS_S_DLR         = :MEXA001MSTR.EVS-S-DLR            00092200
094300       AND  EVS_S_BODY        = :MEXA001MSTR.EVS-S-BODY           00092300
094400       AND  EVS_S_ITEM        = :MEXA001MSTR.EVS-S-ITEM           00092400
094500       AND  EVS_S_STATUS_CODE NOT IN ('100', '990')               00092500
094600       AND (EVS_N_PLT_REL_DT > :WS-WORK-DATE-CYYMMDD OR           00092600
094700            EVS_N_PLT_REL_DT = '       ')                         00092700
094800     END-EXEC.                                                    00092800
094900***************************************************************** 00092900
095000     EVALUATE SQLCODE                                             00093000
095100        WHEN ZEROS                                                00093100
095200           INITIALIZE  EXV-FILE-WS                                00093200
095300           MOVE MEXA001MSTR             TO EXV-FILE-WS            00093300
095400           MOVE EXV-S-1-MODEL-YR        TO EVS-S-2-MODEL-YR       00093400
095500           MOVE EXV-S-2-WMI             TO EVS-S-2-WMI            00093500
095600           MOVE EXV-S-2-PLANT           TO EVS-S-2-PLANT          00093600
095700           MOVE EXV-S-2-BASE            TO EVS-S-2-BASE           00093700
095800           SET WS-NO-DUPLICATE-S1 TO TRUE                         00093800
095900           PERFORM 3120-CHECK-S2KEY                               00093900
096000        WHEN -811                                                 00094000
096100**** SHEU 12/10/03 ***
096200           PERFORM 3101-OPEN-CURSOR
096300           PERFORM 3102-FETCH-CURSOR
096400           PERFORM 3103-CLOSE-CURSOR
096500           INITIALIZE  EXV-FILE-WS                                00094100
096600           MOVE MEXA001MSTR             TO EXV-FILE-WS            00094200
096700           MOVE EXV-S-1-MODEL-YR        TO EVS-S-2-MODEL-YR       00094300
096800           MOVE EXV-S-2-WMI             TO EVS-S-2-WMI            00094400
096900           MOVE EXV-S-2-PLANT           TO EVS-S-2-PLANT          00094500
097000           MOVE EXV-S-2-BASE            TO EVS-S-2-BASE           00094600
097100           SET WS-DUPLICATE-S1 TO TRUE                            00094700
097200           PERFORM 3120-CHECK-S2KEY                               00094800
097300        WHEN +100                                                 00094900
097400           IF UW-STATUS = '999'                                   00095000
097500               PERFORM 3110-CANCEL-STATUS-CHK                     00095100
097600           ELSE                                                   00095200
097700               PERFORM 3115-CANCEL-STATUS-CHK2                    00095300
097800           END-IF                                                 00095400
097900        WHEN OTHER                                                00095500
098000           MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR         00095600
098100           MOVE EVS-S-DIST              TO ERR-S-DIST             00095700
098200           MOVE EVS-S-DLR               TO ERR-S-DLR              00095800
098300           MOVE EVS-S-BODY              TO ERR-S-BODY             00095900
098400           MOVE EVS-S-ITEM              TO ERR-S-ITEM             00096000
098500           MOVE SQLCODE                 TO EDIT-SQLCODE           00096100
098600           MOVE '3100-READ-EVS-MSTR'    TO ERR-ABEND-PARA         00096200
098700           MOVE SPACES                  TO ERR-ABEND-CODE         00096300
098800           MOVE 'SELECT'                TO ERR-FUNCTION-CALL      00096400
098900           MOVE SPACES                  TO ERR-SEG-NAME           00096500
099000           MOVE 'EXVS100'               TO ERR-PROG-NAME          00096600
099100           MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE            00096700
099200           MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME         00096800
099300           PERFORM 9999-ABEND                                     00096900
099400      END-EVALUATE.                                               00097000
099500                                                                  PEXCR207
099600/*****************************************************************
099700* OPEN CURSOR FOR MEXA001MSTR                                    *
099800******************************************************************
099900 3101-OPEN-CURSOR.
100000
100100     EXEC SQL
100200         DECLARE  MEXA001MSTR_CSR CURSOR FOR
100300          SELECT                                                  00083900
100400                 EVS_P_CONTROL_NO               ,                 00084000
100500                 EVS_S_WMI                      ,                 00084100
100600                 EVS_S_PLANT                    ,                 00084200
100700                 EVS_S_SERIAL                   ,                 00084300
100800                 EVS_S_STATUS_CODE              ,                 00084400
100900                 EVS_S_STATUS_DATE              ,                 00084500
101000                 EVS_U_DIV_CODE                 ,                 00084600
101100                 EVS_U_ORIG_ORD_DIS             ,                 00084700
101200                 EVS_U_ORIG_ORD_DLR             ,                 00084800
101300                 EVS_U_VO_IMAGE                 ,                 00084900
101400                 EVS_U_ORIG_ORD_TYP             ,                 00085000
101500                 EVS_U_BAO_VEH_LINE             ,                 00085100
101600                 EVS_U_MSA_PRC_DT               ,                 00085200
101700                 EVS_U_MSA_REC_DT               ,                 00085300
101800                 EVS_U_SCHED_DT                 ,                 00085400
101900                 EVS_U_SEG_DATE                 ,                 00085500
102000                 EVS_U_SPEC_CHG_DT              ,                 00085600
102100                 EVS_U_DSO_PLT_DT               ,                 00085700
102200                 EVS_U_COMB_ERR_IND             ,                 00085800
102300                 EVS_U_DSO_PTO_IND              ,                 00085900
102400                 EVS_U_ERR_LVL_IND              ,                 00086000
102500                 EVS_U_PROD_H_IND               ,                 00086100
102600                 EVS_U_PLT_SUB_IND              ,                 00086200
102700                 EVS_U_REV_DORA_IND             ,                 00086300
102800                 EVS_U_DORA_GEN_IND             ,                 00086400
102900                 EVS_U_COMP_ERR_IND             ,                 00086500
103000                 EVS_U_DSO_ORD_QTY              ,                 00086600
103100                 EVS_U_DORA_VALUE               ,                 00086700
103200                 EVS_F_REQ_PROD_YM              ,                 00086800
103300                 EVS_F_FLEET_IND                ,                 00086900
103400                 EVS_F_FLT_RTK_IND              ,                 00087000
103500                 EVS_F_DEALER_NAME              ,                 00087100
103600                 EVS_F_MVMA_CNTY_CD             ,                 00087200
103700                 EVS_F_FIES_PROD_PF             ,                 00087300
103800                 EVS_F_FIES_PROD_SF             ,                 00087400
103900                 EVS_F_EST_VALUE                ,                 00087500
104000                 EVS_F_CREATE_RC_DT             ,                 00087600
104100                 EVS_F_EUROPEAN_IND                               00087700
104200          FROM                                                    00091700
104300                       MEXA001MSTR                                00091800
104400          WHERE                                                   00091900
104500            EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR       00092000
104600       AND  EVS_S_DIST        = :MEXA001MSTR.EVS-S-DIST           00092100
104700       AND  EVS_S_DLR         = :MEXA001MSTR.EVS-S-DLR            00092200
104800       AND  EVS_S_BODY        = :MEXA001MSTR.EVS-S-BODY           00092300
104900       AND  EVS_S_ITEM        = :MEXA001MSTR.EVS-S-ITEM           00092400
105000       AND  EVS_S_STATUS_CODE NOT IN ('100', '990')               00092500
105100       AND (EVS_N_PLT_REL_DT > :WS-WORK-DATE-CYYMMDD OR           00092600
105200            EVS_N_PLT_REL_DT = '       ')                         00092700
105300     END-EXEC
105400
105500     EXEC SQL
105600         OPEN MEXA001MSTR_CSR
105700     END-EXEC
105800
105900     IF  SQLCODE NOT = ZERO
106000         MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR                 00
106100         MOVE EVS-S-DIST              TO ERR-S-DIST                     00
106200         MOVE EVS-S-DLR               TO ERR-S-DLR                      00
106300         MOVE EVS-S-BODY              TO ERR-S-BODY                     00
106400         MOVE EVS-S-ITEM              TO ERR-S-ITEM                     00
106500         MOVE SQLCODE                 TO EDIT-SQLCODE                   00
106600         MOVE '3101-OPEN-CURSOR'      TO ERR-ABEND-PARA                 00
106700         MOVE SPACES                  TO ERR-ABEND-CODE                 00
106800         MOVE 'OPEN'                  TO ERR-FUNCTION-CALL              00
106900         MOVE SPACES                  TO ERR-SEG-NAME                   00
107000         MOVE 'EXVS100'               TO ERR-PROG-NAME                  00
107100         MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE                    00
107200         MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME                 00
107300         PERFORM 9999-ABEND                                             00
107400     END-IF
107500     .
107600
107700/*****************************************************************
107800* FETCH CURSOR FOR MEXA001MSTR                                   *
107900******************************************************************
108000 3102-FETCH-CURSOR.
108100
108200     EXEC SQL
108300         FETCH MEXA001MSTR_CSR
108400          INTO                                                    00087800
108500                :MEXA001MSTR.EVS-P-CONTROL-NO   ,                 00087900
108600                :MEXA001MSTR.EVS-S-WMI          ,                 00088000
108700                :MEXA001MSTR.EVS-S-PLANT        ,                 00088100
108800                :MEXA001MSTR.EVS-S-SERIAL       ,                 00088200
108900                :MEXA001MSTR.EVS-S-STATUS-CODE  ,                 00088300
109000                :MEXA001MSTR.EVS-S-STATUS-DATE  ,                 00088400
109100                :MEXA001MSTR.EVS-U-DIV-CODE     ,                 00088500
109200                :MEXA001MSTR.EVS-U-ORIG-ORD-DIS ,                 00088600
109300                :MEXA001MSTR.EVS-U-ORIG-ORD-DLR ,                 00088700
109400                :MEXA001MSTR.EVS-U-VO-IMAGE     ,                 00088800
109500                :MEXA001MSTR.EVS-U-ORIG-ORD-TYP ,                 00088900
109600                :MEXA001MSTR.EVS-U-BAO-VEH-LINE ,                 00089000
109700                :MEXA001MSTR.EVS-U-MSA-PRC-DT   ,                 00089100
109800                :MEXA001MSTR.EVS-U-MSA-REC-DT   ,                 00089200
109900                :MEXA001MSTR.EVS-U-SCHED-DT     ,                 00089300
110000                :MEXA001MSTR.EVS-U-SEG-DATE     ,                 00089400
110100                :MEXA001MSTR.EVS-U-SPEC-CHG-DT  ,                 00089500
110200                :MEXA001MSTR.EVS-U-DSO-PLT-DT   ,                 00089600
110300                :MEXA001MSTR.EVS-U-COMB-ERR-IND ,                 00089700
110400                :MEXA001MSTR.EVS-U-DSO-PTO-IND  ,                 00089800
110500                :MEXA001MSTR.EVS-U-ERR-LVL-IND  ,                 00089900
110600                :MEXA001MSTR.EVS-U-PROD-H-IND   ,                 00090000
110700                :MEXA001MSTR.EVS-U-PLT-SUB-IND  ,                 00090100
110800                :MEXA001MSTR.EVS-U-REV-DORA-IND ,                 00090200
110900                :MEXA001MSTR.EVS-U-DORA-GEN-IND ,                 00090300
111000                :MEXA001MSTR.EVS-U-COMP-ERR-IND ,                 00090400
111100                :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                 00090500
111200                :MEXA001MSTR.EVS-U-DORA-VALUE   ,                 00090600
111300                :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                 00090700
111400                :MEXA001MSTR.EVS-F-FLEET-IND    ,                 00090800
111500                :MEXA001MSTR.EVS-F-FLT-RTK-IND  ,                 00090900
111600                :MEXA001MSTR.EVS-F-DEALER-NAME  ,                 00091000
111700                :MEXA001MSTR.EVS-F-MVMA-CNTY-CD ,                 00091100
111800                :MEXA001MSTR.EVS-F-FIES-PROD-PF ,                 00091200
111900                :MEXA001MSTR.EVS-F-FIES-PROD-SF ,                 00091300
112000                :MEXA001MSTR.EVS-F-EST-VALUE    ,                 00091400
112100                :MEXA001MSTR.EVS-F-CREATE-RC-DT ,                 00091500
112200                :MEXA001MSTR.EVS-F-EUROPEAN-IND                   00091600
112300     END-EXEC
112400
112500     EVALUATE SQLCODE                                             00093000
112600        WHEN ZEROS                                                00093100
112700             CONTINUE                                                   07
112800
112900         WHEN OTHER
113000              MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR            00
113100              MOVE EVS-S-DIST              TO ERR-S-DIST                00
113200              MOVE EVS-S-DLR               TO ERR-S-DLR                 00
113300              MOVE EVS-S-BODY              TO ERR-S-BODY                00
113400              MOVE EVS-S-ITEM              TO ERR-S-ITEM                00
113500              MOVE SQLCODE                 TO EDIT-SQLCODE              00
113600              MOVE '3102-FETCH-CURSOR'     TO ERR-ABEND-PARA            00
113700              MOVE SPACES                  TO ERR-ABEND-CODE            00
113800              MOVE 'FETCH'                 TO ERR-FUNCTION-CALL         00
113900              MOVE SPACES                  TO ERR-SEG-NAME              00
114000              MOVE 'EXVS100'               TO ERR-PROG-NAME             00
114100              MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE               00
114200              MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME            00
114300              PERFORM 9999-ABEND                                        00
114400     END-EVALUATE
114500     .
114600
114700/*****************************************************************
114800* CLOSE CURSOR FOR MEXA001MSTR                                   *
114900******************************************************************
115000 3103-CLOSE-CURSOR.
115100
115200     EXEC SQL
115300         CLOSE MEXA001MSTR_CSR
115400     END-EXEC
115500
115600     IF  SQLCODE NOT = ZERO
115700         MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR                 00
115800         MOVE EVS-S-DIST              TO ERR-S-DIST                     00
115900         MOVE EVS-S-DLR               TO ERR-S-DLR                      00
116000         MOVE EVS-S-BODY              TO ERR-S-BODY                     00
116100         MOVE EVS-S-ITEM              TO ERR-S-ITEM                     00
116200         MOVE SQLCODE                 TO EDIT-SQLCODE                   00
116300         MOVE '3103-CLOSE-CURSOR'     TO ERR-ABEND-PARA                 00
116400         MOVE SPACES                  TO ERR-ABEND-CODE                 00
116500         MOVE 'CLOSE'                 TO ERR-FUNCTION-CALL              00
116600         MOVE SPACES                  TO ERR-SEG-NAME                   00
116700         MOVE 'EXVS100'               TO ERR-PROG-NAME                  00
116800         MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE                    00
116900         MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME                 00
117000         PERFORM 9999-ABEND                                             00
117100     END-IF
117200     .
117300                                                                  PEXCR198
117400/                                                                 00097100
117500 3110-CANCEL-STATUS-CHK.                                          00097200
117600***************************************************************** 00097300
117700*                                                               * 00097400
117800*  DESCRIPTION:  SPECIAL PROCESSING FOR CANCELLED RECORDS.      * 00097500
117900*                PERFORM SELECT MEXA001MSTR WITH STATUS CODE    * 00097600
118000*                EQUAL TO 100.  IF FOUND, BYPASS UPDATING OF    * 00097700
118100*                MEXA001MSTR WITH STATUS = 100.                 * 00097800
118200*                (ADD 1 TO CANCEL-REC-NO-WRITE COUNTER)         * 00097900
118300*                IF NOTFOUND, INSERT CANCELLED RECORD INTO      * 00098000
118400*                MEXA001MSTR.                                   * 00098100
118500***************************************************************** 00098200
118600                                                                  00098300
118700      INITIALIZE   MEXA001MSTR.                                   00098400
118800      MOVE UW-VO-4                    TO EVS-S-MODEL-YR           00098500
118900                                         EVS-S-1-MODEL-YR.        00098600
119000      MOVE UW-DIST                    TO EVS-S-DIST               00098700
119100                                         EVS-S-1-DIST.            00098800
119200      MOVE UW-DLR                     TO EVS-S-DLR                00098900
119300                                         EVS-S-1-DLR.             00099000
119400      MOVE UW-VO-1-3                  TO EVS-S-BODY               00099100
119500                                         EVS-S-1-BODY.            00099200
119600      MOVE UW-ITEM                    TO EVS-S-ITEM               00099300
119700                                         EVS-S-1-ITEM.            00099400
119800                                                                  00099500
119900     EXEC SQL                                                     00099600
120000          SELECT                                                  00099700
120100                 EVS_P_CONTROL_NO               ,                 00099800
120200                 EVS_S_WMI                      ,                 00099900
120300                 EVS_S_PLANT                    ,                 00100000
120400                 EVS_S_SERIAL                   ,                 00100100
120500                 EVS_S_STATUS_CODE              ,                 00100200
120600                 EVS_S_STATUS_DATE              ,                 00100300
120700                 EVS_U_DIV_CODE                 ,                 00100400
120800                 EVS_U_ORIG_ORD_DIS             ,                 00100500
120900                 EVS_U_ORIG_ORD_DLR             ,                 00100600
121000                 EVS_U_VO_IMAGE                 ,                 00100700
121100                 EVS_U_ORIG_ORD_TYP             ,                 00100800
121200                 EVS_U_BAO_VEH_LINE             ,                 00100900
121300                 EVS_U_MSA_PRC_DT               ,                 00101000
121400                 EVS_U_MSA_REC_DT               ,                 00101100
121500                 EVS_U_SCHED_DT                 ,                 00101200
121600                 EVS_U_SEG_DATE                 ,                 00101300
121700                 EVS_U_SPEC_CHG_DT              ,                 00101400
121800                 EVS_U_DSO_PLT_DT               ,                 00101500
121900                 EVS_U_COMB_ERR_IND             ,                 00101600
122000                 EVS_U_DSO_PTO_IND              ,                 00101700
122100                 EVS_U_ERR_LVL_IND              ,                 00101800
122200                 EVS_U_PROD_H_IND               ,                 00101900
122300                 EVS_U_PLT_SUB_IND              ,                 00102000
122400                 EVS_U_REV_DORA_IND             ,                 00102100
122500                 EVS_U_DORA_GEN_IND             ,                 00102200
122600                 EVS_U_COMP_ERR_IND             ,                 00102300
122700                 EVS_U_DSO_ORD_QTY              ,                 00102400
122800                 EVS_U_DORA_VALUE               ,                 00102500
122900                 EVS_F_REQ_PROD_YM              ,                 00102600
123000                 EVS_F_FLEET_IND                ,                 00102700
123100                 EVS_F_FLT_RTK_IND              ,                 00102800
123200                 EVS_F_DEALER_NAME              ,                 00102900
123300                 EVS_F_MVMA_CNTY_CD             ,                 00103000
123400                 EVS_F_FIES_PROD_PF             ,                 00103100
123500                 EVS_F_FIES_PROD_SF             ,                 00103200
123600                 EVS_F_EST_VALUE                ,                 00103300
123700                 EVS_F_CREATE_RC_DT             ,                 00103400
123800                 EVS_F_EUROPEAN_IND                               00103500
123900          INTO                                                    00103600
124000                :MEXA001MSTR.EVS-P-CONTROL-NO   ,                 00103700
124100                :MEXA001MSTR.EVS-S-WMI          ,                 00103800
124200                :MEXA001MSTR.EVS-S-PLANT        ,                 00103900
124300                :MEXA001MSTR.EVS-S-SERIAL       ,                 00104000
124400                :MEXA001MSTR.EVS-S-STATUS-CODE  ,                 00104100
124500                :MEXA001MSTR.EVS-S-STATUS-DATE  ,                 00104200
124600                :MEXA001MSTR.EVS-U-DIV-CODE     ,                 00104300
124700                :MEXA001MSTR.EVS-U-ORIG-ORD-DIS ,                 00104400
124800                :MEXA001MSTR.EVS-U-ORIG-ORD-DLR ,                 00104500
124900                :MEXA001MSTR.EVS-U-VO-IMAGE     ,                 00104600
125000                :MEXA001MSTR.EVS-U-ORIG-ORD-TYP ,                 00104700
125100                :MEXA001MSTR.EVS-U-BAO-VEH-LINE ,                 00104800
125200                :MEXA001MSTR.EVS-U-MSA-PRC-DT   ,                 00104900
125300                :MEXA001MSTR.EVS-U-MSA-REC-DT   ,                 00105000
125400                :MEXA001MSTR.EVS-U-SCHED-DT     ,                 00105100
125500                :MEXA001MSTR.EVS-U-SEG-DATE     ,                 00105200
125600                :MEXA001MSTR.EVS-U-SPEC-CHG-DT  ,                 00105300
125700                :MEXA001MSTR.EVS-U-DSO-PLT-DT   ,                 00105400
125800                :MEXA001MSTR.EVS-U-COMB-ERR-IND ,                 00105500
125900                :MEXA001MSTR.EVS-U-DSO-PTO-IND  ,                 00105600
126000                :MEXA001MSTR.EVS-U-ERR-LVL-IND  ,                 00105700
126100                :MEXA001MSTR.EVS-U-PROD-H-IND   ,                 00105800
126200                :MEXA001MSTR.EVS-U-PLT-SUB-IND  ,                 00105900
126300                :MEXA001MSTR.EVS-U-REV-DORA-IND ,                 00106000
126400                :MEXA001MSTR.EVS-U-DORA-GEN-IND ,                 00106100
126500                :MEXA001MSTR.EVS-U-COMP-ERR-IND ,                 00106200
126600                :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                 00106300
126700                :MEXA001MSTR.EVS-U-DORA-VALUE   ,                 00106400
126800                :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                 00106500
126900                :MEXA001MSTR.EVS-F-FLEET-IND    ,                 00106600
127000                :MEXA001MSTR.EVS-F-FLT-RTK-IND  ,                 00106700
127100                :MEXA001MSTR.EVS-F-DEALER-NAME  ,                 00106800
127200                :MEXA001MSTR.EVS-F-MVMA-CNTY-CD ,                 00106900
127300                :MEXA001MSTR.EVS-F-FIES-PROD-PF ,                 00107000
127400                :MEXA001MSTR.EVS-F-FIES-PROD-SF ,                 00107100
127500                :MEXA001MSTR.EVS-F-EST-VALUE    ,                 00107200
127600                :MEXA001MSTR.EVS-F-CREATE-RC-DT ,                 00107300
127700                :MEXA001MSTR.EVS-F-EUROPEAN-IND                   00107400
127800          FROM                                                    00107500
127900                       MEXA001MSTR                                00107600
128000          WHERE                                                   00107700
128100            EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR       00107800
128200       AND  EVS_S_DIST        = :MEXA001MSTR.EVS-S-DIST           00107900
128300       AND  EVS_S_DLR         = :MEXA001MSTR.EVS-S-DLR            00108000
128400       AND  EVS_S_BODY        = :MEXA001MSTR.EVS-S-BODY           00108100
128500       AND  EVS_S_ITEM        = :MEXA001MSTR.EVS-S-ITEM           00108200
128600       AND  EVS_S_STATUS_CODE = '100'                             00108300
128700     END-EXEC.                                                    00108400
128800***************************************************************** 00108500
128900     EVALUATE SQLCODE                                             00108600
129000        WHEN ZEROS                                                00108700
129100           ADD 1                        TO CANCEL-REC-NO-WRITE    00108800
129200        WHEN -811                                                 00108900
129300**** SHEU 12/10/03 ***
129400           PERFORM 3111-OPEN-CURSOR
129500           PERFORM 3112-FETCH-CURSOR
129600           PERFORM 3113-CLOSE-CURSOR
129700           ADD 1                        TO CANCEL-REC-NO-WRITE    00109000
129800        WHEN +100                                                 00109100
129900           PERFORM 3150-PROCESS-FOR-WRITE                         00109200
130000        WHEN OTHER                                                00109300
130100           MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR         00109400
130200           MOVE EVS-S-DIST              TO ERR-S-DIST             00109500
130300           MOVE EVS-S-DLR               TO ERR-S-DLR              00109600
130400           MOVE EVS-S-BODY              TO ERR-S-BODY             00109700
130500           MOVE EVS-S-ITEM              TO ERR-S-ITEM             00109800
130600           MOVE SQLCODE                 TO EDIT-SQLCODE           00109900
130700           MOVE '3110-CANCEL-STATUS-CHK' TO ERR-ABEND-PARA        00110000
130800           MOVE SPACES                  TO ERR-ABEND-CODE         00110100
130900           MOVE 'SELECT'                TO ERR-FUNCTION-CALL      00110200
131000           MOVE SPACES                  TO ERR-SEG-NAME           00110300
131100           MOVE 'EXVS100'               TO ERR-PROG-NAME          00110400
131200           MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME         00110500
131300           MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE            00110600
131400           PERFORM 9999-ABEND                                     00110700
131500      END-EVALUATE.                                               00110800
131600                                                                  PEXCR207
131700/*****************************************************************
131800* OPEN CURSOR FOR MEXA001MSTR                                    *
131900******************************************************************
132000 3111-OPEN-CURSOR.
132100
132200     EXEC SQL
132300         DECLARE  MEXA001MSTR_1_CSR CURSOR FOR
132400          SELECT                                                  00099700
132500                 EVS_P_CONTROL_NO               ,                 00099800
132600                 EVS_S_WMI                      ,                 00099900
132700                 EVS_S_PLANT                    ,                 00100000
132800                 EVS_S_SERIAL                   ,                 00100100
132900                 EVS_S_STATUS_CODE              ,                 00100200
133000                 EVS_S_STATUS_DATE              ,                 00100300
133100                 EVS_U_DIV_CODE                 ,                 00100400
133200                 EVS_U_ORIG_ORD_DIS             ,                 00100500
133300                 EVS_U_ORIG_ORD_DLR             ,                 00100600
133400                 EVS_U_VO_IMAGE                 ,                 00100700
133500                 EVS_U_ORIG_ORD_TYP             ,                 00100800
133600                 EVS_U_BAO_VEH_LINE             ,                 00100900
133700                 EVS_U_MSA_PRC_DT               ,                 00101000
133800                 EVS_U_MSA_REC_DT               ,                 00101100
133900                 EVS_U_SCHED_DT                 ,                 00101200
134000                 EVS_U_SEG_DATE                 ,                 00101300
134100                 EVS_U_SPEC_CHG_DT              ,                 00101400
134200                 EVS_U_DSO_PLT_DT               ,                 00101500
134300                 EVS_U_COMB_ERR_IND             ,                 00101600
134400                 EVS_U_DSO_PTO_IND              ,                 00101700
134500                 EVS_U_ERR_LVL_IND              ,                 00101800
134600                 EVS_U_PROD_H_IND               ,                 00101900
134700                 EVS_U_PLT_SUB_IND              ,                 00102000
134800                 EVS_U_REV_DORA_IND             ,                 00102100
134900                 EVS_U_DORA_GEN_IND             ,                 00102200
135000                 EVS_U_COMP_ERR_IND             ,                 00102300
135100                 EVS_U_DSO_ORD_QTY              ,                 00102400
135200                 EVS_U_DORA_VALUE               ,                 00102500
135300                 EVS_F_REQ_PROD_YM              ,                 00102600
135400                 EVS_F_FLEET_IND                ,                 00102700
135500                 EVS_F_FLT_RTK_IND              ,                 00102800
135600                 EVS_F_DEALER_NAME              ,                 00102900
135700                 EVS_F_MVMA_CNTY_CD             ,                 00103000
135800                 EVS_F_FIES_PROD_PF             ,                 00103100
135900                 EVS_F_FIES_PROD_SF             ,                 00103200
136000                 EVS_F_EST_VALUE                ,                 00103300
136100                 EVS_F_CREATE_RC_DT             ,                 00103400
136200                 EVS_F_EUROPEAN_IND                               00103500
136300          FROM                                                    00107500
136400                       MEXA001MSTR                                00107600
136500          WHERE                                                   00107700
136600            EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR       00107800
136700       AND  EVS_S_DIST        = :MEXA001MSTR.EVS-S-DIST           00107900
136800       AND  EVS_S_DLR         = :MEXA001MSTR.EVS-S-DLR            00108000
136900       AND  EVS_S_BODY        = :MEXA001MSTR.EVS-S-BODY           00108100
137000       AND  EVS_S_ITEM        = :MEXA001MSTR.EVS-S-ITEM           00108200
137100       AND  EVS_S_STATUS_CODE = '100'                             00108300
137200     END-EXEC
137300
137400     EXEC SQL
137500         OPEN MEXA001MSTR_1_CSR
137600     END-EXEC
137700
137800     IF  SQLCODE NOT = ZERO
137900         MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR                 00
138000         MOVE EVS-S-DIST              TO ERR-S-DIST                     00
138100         MOVE EVS-S-DLR               TO ERR-S-DLR                      00
138200         MOVE EVS-S-BODY              TO ERR-S-BODY                     00
138300         MOVE EVS-S-ITEM              TO ERR-S-ITEM                     00
138400         MOVE SQLCODE                 TO EDIT-SQLCODE                   00
138500         MOVE '3111-OPEN-CURSOR'      TO ERR-ABEND-PARA                 00
138600         MOVE SPACES                  TO ERR-ABEND-CODE                 00
138700         MOVE 'OPEN'                  TO ERR-FUNCTION-CALL              00
138800         MOVE SPACES                  TO ERR-SEG-NAME                   00
138900         MOVE 'EXVS100'               TO ERR-PROG-NAME                  00
139000         MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE                    00
139100         MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME                 00
139200         PERFORM 9999-ABEND                                             00
139300     END-IF
139400     .
139500
139600/*****************************************************************
139700* FETCH CURSOR FOR MEXA001MSTR                                   *
139800******************************************************************
139900 3112-FETCH-CURSOR.
140000
140100     EXEC SQL
140200         FETCH MEXA001MSTR_1_CSR
140300          INTO                                                    00103600
140400                :MEXA001MSTR.EVS-P-CONTROL-NO   ,                 00103700
140500                :MEXA001MSTR.EVS-S-WMI          ,                 00103800
140600                :MEXA001MSTR.EVS-S-PLANT        ,                 00103900
140700                :MEXA001MSTR.EVS-S-SERIAL       ,                 00104000
140800                :MEXA001MSTR.EVS-S-STATUS-CODE  ,                 00104100
140900                :MEXA001MSTR.EVS-S-STATUS-DATE  ,                 00104200
141000                :MEXA001MSTR.EVS-U-DIV-CODE     ,                 00104300
141100                :MEXA001MSTR.EVS-U-ORIG-ORD-DIS ,                 00104400
141200                :MEXA001MSTR.EVS-U-ORIG-ORD-DLR ,                 00104500
141300                :MEXA001MSTR.EVS-U-VO-IMAGE     ,                 00104600
141400                :MEXA001MSTR.EVS-U-ORIG-ORD-TYP ,                 00104700
141500                :MEXA001MSTR.EVS-U-BAO-VEH-LINE ,                 00104800
141600                :MEXA001MSTR.EVS-U-MSA-PRC-DT   ,                 00104900
141700                :MEXA001MSTR.EVS-U-MSA-REC-DT   ,                 00105000
141800                :MEXA001MSTR.EVS-U-SCHED-DT     ,                 00105100
141900                :MEXA001MSTR.EVS-U-SEG-DATE     ,                 00105200
142000                :MEXA001MSTR.EVS-U-SPEC-CHG-DT  ,                 00105300
142100                :MEXA001MSTR.EVS-U-DSO-PLT-DT   ,                 00105400
142200                :MEXA001MSTR.EVS-U-COMB-ERR-IND ,                 00105500
142300                :MEXA001MSTR.EVS-U-DSO-PTO-IND  ,                 00105600
142400                :MEXA001MSTR.EVS-U-ERR-LVL-IND  ,                 00105700
142500                :MEXA001MSTR.EVS-U-PROD-H-IND   ,                 00105800
142600                :MEXA001MSTR.EVS-U-PLT-SUB-IND  ,                 00105900
142700                :MEXA001MSTR.EVS-U-REV-DORA-IND ,                 00106000
142800                :MEXA001MSTR.EVS-U-DORA-GEN-IND ,                 00106100
142900                :MEXA001MSTR.EVS-U-COMP-ERR-IND ,                 00106200
143000                :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                 00106300
143100                :MEXA001MSTR.EVS-U-DORA-VALUE   ,                 00106400
143200                :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                 00106500
143300                :MEXA001MSTR.EVS-F-FLEET-IND    ,                 00106600
143400                :MEXA001MSTR.EVS-F-FLT-RTK-IND  ,                 00106700
143500                :MEXA001MSTR.EVS-F-DEALER-NAME  ,                 00106800
143600                :MEXA001MSTR.EVS-F-MVMA-CNTY-CD ,                 00106900
143700                :MEXA001MSTR.EVS-F-FIES-PROD-PF ,                 00107000
143800                :MEXA001MSTR.EVS-F-FIES-PROD-SF ,                 00107100
143900                :MEXA001MSTR.EVS-F-EST-VALUE    ,                 00107200
144000                :MEXA001MSTR.EVS-F-CREATE-RC-DT ,                 00107300
144100                :MEXA001MSTR.EVS-F-EUROPEAN-IND                   00107400
144200     END-EXEC
144300
144400     EVALUATE SQLCODE                                             00093000
144500        WHEN ZEROS                                                00093100
144600             CONTINUE                                                   07
144700
144800         WHEN OTHER
144900              MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR            00
145000              MOVE EVS-S-DIST              TO ERR-S-DIST                00
145100              MOVE EVS-S-DLR               TO ERR-S-DLR                 00
145200              MOVE EVS-S-BODY              TO ERR-S-BODY                00
145300              MOVE EVS-S-ITEM              TO ERR-S-ITEM                00
145400              MOVE SQLCODE                 TO EDIT-SQLCODE              00
145500              MOVE '3112-FETCH-CURSOR'     TO ERR-ABEND-PARA            00
145600              MOVE SPACES                  TO ERR-ABEND-CODE            00
145700              MOVE 'FETCH'                 TO ERR-FUNCTION-CALL         00
145800              MOVE SPACES                  TO ERR-SEG-NAME              00
145900              MOVE 'EXVS100'               TO ERR-PROG-NAME             00
146000              MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE               00
146100              MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME            00
146200              PERFORM 9999-ABEND                                        00
146300     END-EVALUATE
146400     .
146500
146600/*****************************************************************
146700* CLOSE CURSOR FOR MEXA001MSTR                                   *
146800******************************************************************
146900 3113-CLOSE-CURSOR.
147000
147100     EXEC SQL
147200         CLOSE MEXA001MSTR_1_CSR
147300     END-EXEC
147400
147500     IF  SQLCODE NOT = ZERO
147600         MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR                 00
147700         MOVE EVS-S-DIST              TO ERR-S-DIST                     00
147800         MOVE EVS-S-DLR               TO ERR-S-DLR                      00
147900         MOVE EVS-S-BODY              TO ERR-S-BODY                     00
148000         MOVE EVS-S-ITEM              TO ERR-S-ITEM                     00
148100         MOVE SQLCODE                 TO EDIT-SQLCODE                   00
148200         MOVE '3113-CLOSE-CURSOR'     TO ERR-ABEND-PARA                 00
148300         MOVE SPACES                  TO ERR-ABEND-CODE                 00
148400         MOVE 'CLOSE'                 TO ERR-FUNCTION-CALL              00
148500         MOVE SPACES                  TO ERR-SEG-NAME                   00
148600         MOVE 'EXVS100'               TO ERR-PROG-NAME                  00
148700         MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE                    00
148800         MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME                 00
148900         PERFORM 9999-ABEND                                             00
149000     END-IF
149100     .
149200                                                                  PEXCR198
149300/                                                                 00110900
149400 3115-CANCEL-STATUS-CHK2.                                         00111000
149500***************************************************************** 00111100
149600*                                                               * 00111200
149700*  DESCRIPTION:  SPECIAL PROCESSING FOR CANCELLED RECORDS.      * 00111300
149800*                PERFORM SELECT MEXA001MSTR WITH S1 KEY AND     * 00111400
149900*                ORDER RECEIVED DATE FOR STATUS EQUAL 100.      * 00111500
150000*                IF FOUND, UPDATE EXISTING EVS ORDER RECORD.    * 00111600
150100*                IF NOT FOUND, ADD NEW EVS ORDER RECORD.        * 00111700
150200***************************************************************** 00111800
150300                                                                  00111900
150400      INITIALIZE   MEXA001MSTR.                                   00112000
150500      MOVE UW-VO-4                    TO EVS-S-MODEL-YR           00112100
150600                                         EVS-S-1-MODEL-YR.        00112200
150700      MOVE UW-DIST                    TO EVS-S-DIST               00112300
150800                                         EVS-S-1-DIST.            00112400
150900      MOVE UW-DLR                     TO EVS-S-DLR                00112500
151000                                         EVS-S-1-DLR.             00112600
151100      MOVE UW-VO-1-3                  TO EVS-S-BODY               00112700
151200                                         EVS-S-1-BODY.            00112800
151300      MOVE UW-ITEM                    TO EVS-S-ITEM               00112900
151400                                         EVS-S-1-ITEM.            00113000
151500                                                                  00113100
151600     IF UW-RECEIPT-DATE = SPACES OR                               00113200
151700        UW-RECEIPT-DATE = ZEROS                                   00113300
151800         MOVE SPACES                  TO WS-ORD-RCPT-DATE-CYYMMDD 00113400
151900     ELSE                                                         00113500
152000         IF UW-RECEIPT-DATE(1:2) > '70'                           00113600
152100             MOVE ZERO                TO WS-ORD-RCPT-DT-C         00113700
152200         ELSE                                                     00113800
152300             MOVE '1'                 TO WS-ORD-RCPT-DT-C         00113900
152400         END-IF                                                   00114000
152500         MOVE UW-RECEIPT-DATE         TO WS-ORD-RCPT-DT-YYMMDD    00114100
152600     END-IF.                                                      00114200
152700                                                                  00114300
152800     EXEC SQL                                                     00114400
152900          SELECT                                                  00114500
153000                 EVS_P_CONTROL_NO               ,                 00114600
153100                 EVS_S_WMI                      ,                 00114700
153200                 EVS_S_PLANT                    ,                 00114800
153300                 EVS_S_SERIAL                   ,                 00114900
153400                 EVS_S_STATUS_CODE              ,                 00115000
153500                 EVS_S_STATUS_DATE              ,                 00115100
153600                 EVS_U_DIV_CODE                 ,                 00115200
153700                 EVS_U_ORIG_ORD_DIS             ,                 00115300
153800                 EVS_U_ORIG_ORD_DLR             ,                 00115400
153900                 EVS_U_VO_IMAGE                 ,                 00115500
154000                 EVS_U_ORIG_ORD_TYP             ,                 00115600
154100                 EVS_U_BAO_VEH_LINE             ,                 00115700
154200                 EVS_U_MSA_PRC_DT               ,                 00115800
154300                 EVS_U_MSA_REC_DT               ,                 00115900
154400                 EVS_U_SCHED_DT                 ,                 00116000
154500                 EVS_U_SEG_DATE                 ,                 00116100
154600                 EVS_U_SPEC_CHG_DT              ,                 00116200
154700                 EVS_U_DSO_PLT_DT               ,                 00116300
154800                 EVS_U_COMB_ERR_IND             ,                 00116400
154900                 EVS_U_DSO_PTO_IND              ,                 00116500
155000                 EVS_U_ERR_LVL_IND              ,                 00116600
155100                 EVS_U_PROD_H_IND               ,                 00116700
155200                 EVS_U_PLT_SUB_IND              ,                 00116800
155300                 EVS_U_REV_DORA_IND             ,                 00116900
155400                 EVS_U_DORA_GEN_IND             ,                 00117000
155500                 EVS_U_COMP_ERR_IND             ,                 00117100
155600                 EVS_U_DSO_ORD_QTY              ,                 00117200
155700                 EVS_U_DORA_VALUE               ,                 00117300
155800                 EVS_F_REQ_PROD_YM              ,                 00117400
155900                 EVS_F_FLEET_IND                ,                 00117500
156000                 EVS_F_FLT_RTK_IND              ,                 00117600
156100                 EVS_F_DEALER_NAME              ,                 00117700
156200                 EVS_F_MVMA_CNTY_CD             ,                 00117800
156300                 EVS_F_FIES_PROD_PF             ,                 00117900
156400                 EVS_F_FIES_PROD_SF             ,                 00118000
156500                 EVS_F_EST_VALUE                ,                 00118100
156600                 EVS_F_CREATE_RC_DT             ,                 00118200
156700                 EVS_F_EUROPEAN_IND                               00118300
156800          INTO                                                    00118400
156900                :MEXA001MSTR.EVS-P-CONTROL-NO   ,                 00118500
157000                :MEXA001MSTR.EVS-S-WMI          ,                 00118600
157100                :MEXA001MSTR.EVS-S-PLANT        ,                 00118700
157200                :MEXA001MSTR.EVS-S-SERIAL       ,                 00118800
157300                :MEXA001MSTR.EVS-S-STATUS-CODE  ,                 00118900
157400                :MEXA001MSTR.EVS-S-STATUS-DATE  ,                 00119000
157500                :MEXA001MSTR.EVS-U-DIV-CODE     ,                 00119100
157600                :MEXA001MSTR.EVS-U-ORIG-ORD-DIS ,                 00119200
157700                :MEXA001MSTR.EVS-U-ORIG-ORD-DLR ,                 00119300
157800                :MEXA001MSTR.EVS-U-VO-IMAGE     ,                 00119400
157900                :MEXA001MSTR.EVS-U-ORIG-ORD-TYP ,                 00119500
158000                :MEXA001MSTR.EVS-U-BAO-VEH-LINE ,                 00119600
158100                :MEXA001MSTR.EVS-U-MSA-PRC-DT   ,                 00119700
158200                :MEXA001MSTR.EVS-U-MSA-REC-DT   ,                 00119800
158300                :MEXA001MSTR.EVS-U-SCHED-DT     ,                 00119900
158400                :MEXA001MSTR.EVS-U-SEG-DATE     ,                 00120000
158500                :MEXA001MSTR.EVS-U-SPEC-CHG-DT  ,                 00120100
158600                :MEXA001MSTR.EVS-U-DSO-PLT-DT   ,                 00120200
158700                :MEXA001MSTR.EVS-U-COMB-ERR-IND ,                 00120300
158800                :MEXA001MSTR.EVS-U-DSO-PTO-IND  ,                 00120400
158900                :MEXA001MSTR.EVS-U-ERR-LVL-IND  ,                 00120500
159000                :MEXA001MSTR.EVS-U-PROD-H-IND   ,                 00120600
159100                :MEXA001MSTR.EVS-U-PLT-SUB-IND  ,                 00120700
159200                :MEXA001MSTR.EVS-U-REV-DORA-IND ,                 00120800
159300                :MEXA001MSTR.EVS-U-DORA-GEN-IND ,                 00120900
159400                :MEXA001MSTR.EVS-U-COMP-ERR-IND ,                 00121000
159500                :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                 00121100
159600                :MEXA001MSTR.EVS-U-DORA-VALUE   ,                 00121200
159700                :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                 00121300
159800                :MEXA001MSTR.EVS-F-FLEET-IND    ,                 00121400
159900                :MEXA001MSTR.EVS-F-FLT-RTK-IND  ,                 00121500
160000                :MEXA001MSTR.EVS-F-DEALER-NAME  ,                 00121600
160100                :MEXA001MSTR.EVS-F-MVMA-CNTY-CD ,                 00121700
160200                :MEXA001MSTR.EVS-F-FIES-PROD-PF ,                 00121800
160300                :MEXA001MSTR.EVS-F-FIES-PROD-SF ,                 00121900
160400                :MEXA001MSTR.EVS-F-EST-VALUE    ,                 00122000
160500                :MEXA001MSTR.EVS-F-CREATE-RC-DT ,                 00122100
160600                :MEXA001MSTR.EVS-F-EUROPEAN-IND                   00122200
160700          FROM                                                    00122300
160800                       MEXA001MSTR                                00122400
160900          WHERE                                                   00122500
161000            EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR       00122600
161100       AND  EVS_S_DIST        = :MEXA001MSTR.EVS-S-DIST           00122700
161200       AND  EVS_S_DLR         = :MEXA001MSTR.EVS-S-DLR            00122800
161300       AND  EVS_S_BODY        = :MEXA001MSTR.EVS-S-BODY           00122900
161400       AND  EVS_S_ITEM        = :MEXA001MSTR.EVS-S-ITEM           00123000
161500       AND  EVS_U_MSA_REC_DT  = :WS-ORD-RCPT-DATE-CYYMMDD         00123100
161600       AND  EVS_S_STATUS_CODE = '100'                             00123200
161700     END-EXEC.                                                    00123300
161800***************************************************************** 00123400
161900     EVALUATE SQLCODE                                             00123500
162000        WHEN ZEROS                                                00123600
162100           INITIALIZE  EXV-FILE-WS                                00123700
162200           MOVE MEXA001MSTR             TO EXV-FILE-WS            00123710
162300           MOVE EXV-S-1-MODEL-YR        TO EVS-S-2-MODEL-YR       00123720
162400           MOVE EXV-S-2-WMI             TO EVS-S-2-WMI            00123730
162500           MOVE EXV-S-2-PLANT           TO EVS-S-2-PLANT          00123740
162600           MOVE EXV-S-2-BASE            TO EVS-S-2-BASE           00123750
162700           SET WS-NO-DUPLICATE-S1       TO TRUE                   00123760
162800           PERFORM 3120-CHECK-S2KEY                               00123770
162900           ADD 1                        TO CANCEL-REC-REACTIVE-CNT00123780
163000           MOVE SPACES                  TO AUDIT-DETAIL           00123790
163100           MOVE 'CANCELLED ORD REACTIVATED'  TO AUDIT-MESSAGE     00123793
163200           MOVE ' = '                   TO AUDIT-SEP              00123795
163300           MOVE SPACES                  TO AUDIT-COUNT            00123796
163400           STRING EXV-S-1-MODEL-YR,                               00123797
163500                  EXV-S-1-KEY,                                    00123798
163600                  WS-ORD-RCPT-DATE-CYYMMDD                        00123799
163700               DELIMITED BY SIZE INTO AUDIT-COUNT1                00123800
163800           MOVE ADVANCE-LINE1           TO AUDIT-CC               00123804
163900           MOVE AUDIT-DETAIL            TO AUDIT-RECORD           00123805
164000           PERFORM 8100-WRITE-AUDIT-RECORD                        00123806
164100        WHEN -811                                                 00123807
164200**** SHEU 12/10/03 ***
164300           PERFORM 3116-OPEN-CURSOR
164400           PERFORM 3117-FETCH-CURSOR
164500           PERFORM 3118-CLOSE-CURSOR
164600           PERFORM 3150-PROCESS-FOR-WRITE                         00123810
164700        WHEN +100                                                 00124000
164800           PERFORM 3150-PROCESS-FOR-WRITE                         00124100
164900        WHEN OTHER                                                00124200
165000           MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR         00124300
165100           MOVE EVS-S-DIST              TO ERR-S-DIST             00124400
165200           MOVE EVS-S-DLR               TO ERR-S-DLR              00124500
165300           MOVE EVS-S-BODY              TO ERR-S-BODY             00124600
165400           MOVE EVS-S-ITEM              TO ERR-S-ITEM             00124700
165500           MOVE SQLCODE                 TO EDIT-SQLCODE           00124800
165600           MOVE '3115-CANCEL-STATUS-CHK2' TO ERR-ABEND-PARA       00124900
165700           MOVE SPACES                  TO ERR-ABEND-CODE         00125000
165800           MOVE 'SELECT'                TO ERR-FUNCTION-CALL      00125100
165900           MOVE SPACES                  TO ERR-SEG-NAME           00125200
166000           MOVE 'EXVS100'               TO ERR-PROG-NAME          00125300
166100           MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME         00125400
166200           MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE            00125500
166300           PERFORM 9999-ABEND                                     00125600
166400      END-EVALUATE.                                               00125700
166500                                                                  PEXCR207
166600/*****************************************************************
166700* OPEN CURSOR FOR MEXA001MSTR                                    *
166800******************************************************************
166900 3116-OPEN-CURSOR.
167000
167100     EXEC SQL
167200         DECLARE  MEXA001MSTR_2_CSR CURSOR FOR
167300          SELECT                                                  00114500
167400                 EVS_P_CONTROL_NO               ,                 00114600
167500                 EVS_S_WMI                      ,                 00114700
167600                 EVS_S_PLANT                    ,                 00114800
167700                 EVS_S_SERIAL                   ,                 00114900
167800                 EVS_S_STATUS_CODE              ,                 00115000
167900                 EVS_S_STATUS_DATE              ,                 00115100
168000                 EVS_U_DIV_CODE                 ,                 00115200
168100                 EVS_U_ORIG_ORD_DIS             ,                 00115300
168200                 EVS_U_ORIG_ORD_DLR             ,                 00115400
168300                 EVS_U_VO_IMAGE                 ,                 00115500
168400                 EVS_U_ORIG_ORD_TYP             ,                 00115600
168500                 EVS_U_BAO_VEH_LINE             ,                 00115700
168600                 EVS_U_MSA_PRC_DT               ,                 00115800
168700                 EVS_U_MSA_REC_DT               ,                 00115900
168800                 EVS_U_SCHED_DT                 ,                 00116000
168900                 EVS_U_SEG_DATE                 ,                 00116100
169000                 EVS_U_SPEC_CHG_DT              ,                 00116200
169100                 EVS_U_DSO_PLT_DT               ,                 00116300
169200                 EVS_U_COMB_ERR_IND             ,                 00116400
169300                 EVS_U_DSO_PTO_IND              ,                 00116500
169400                 EVS_U_ERR_LVL_IND              ,                 00116600
169500                 EVS_U_PROD_H_IND               ,                 00116700
169600                 EVS_U_PLT_SUB_IND              ,                 00116800
169700                 EVS_U_REV_DORA_IND             ,                 00116900
169800                 EVS_U_DORA_GEN_IND             ,                 00117000
169900                 EVS_U_COMP_ERR_IND             ,                 00117100
170000                 EVS_U_DSO_ORD_QTY              ,                 00117200
170100                 EVS_U_DORA_VALUE               ,                 00117300
170200                 EVS_F_REQ_PROD_YM              ,                 00117400
170300                 EVS_F_FLEET_IND                ,                 00117500
170400                 EVS_F_FLT_RTK_IND              ,                 00117600
170500                 EVS_F_DEALER_NAME              ,                 00117700
170600                 EVS_F_MVMA_CNTY_CD             ,                 00117800
170700                 EVS_F_FIES_PROD_PF             ,                 00117900
170800                 EVS_F_FIES_PROD_SF             ,                 00118000
170900                 EVS_F_EST_VALUE                ,                 00118100
171000                 EVS_F_CREATE_RC_DT             ,                 00118200
171100                 EVS_F_EUROPEAN_IND                               00118300
171200          FROM                                                    00122300
171300                       MEXA001MSTR                                00122400
171400          WHERE                                                   00122500
171500            EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR       00122600
171600       AND  EVS_S_DIST        = :MEXA001MSTR.EVS-S-DIST           00122700
171700       AND  EVS_S_DLR         = :MEXA001MSTR.EVS-S-DLR            00122800
171800       AND  EVS_S_BODY        = :MEXA001MSTR.EVS-S-BODY           00122900
171900       AND  EVS_S_ITEM        = :MEXA001MSTR.EVS-S-ITEM           00123000
172000       AND  EVS_U_MSA_REC_DT  = :WS-ORD-RCPT-DATE-CYYMMDD         00123100
172100       AND  EVS_S_STATUS_CODE = '100'                             00123200
172200     END-EXEC
172300
172400     EXEC SQL
172500         OPEN MEXA001MSTR_2_CSR
172600     END-EXEC
172700
172800     IF  SQLCODE NOT = ZERO
172900         MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR                 00
173000         MOVE EVS-S-DIST              TO ERR-S-DIST                     00
173100         MOVE EVS-S-DLR               TO ERR-S-DLR                      00
173200         MOVE EVS-S-BODY              TO ERR-S-BODY                     00
173300         MOVE EVS-S-ITEM              TO ERR-S-ITEM                     00
173400         MOVE SQLCODE                 TO EDIT-SQLCODE                   00
173500         MOVE '3116-OPEN-CURSOR'      TO ERR-ABEND-PARA                 00
173600         MOVE SPACES                  TO ERR-ABEND-CODE                 00
173700         MOVE 'OPEN'                  TO ERR-FUNCTION-CALL              00
173800         MOVE SPACES                  TO ERR-SEG-NAME                   00
173900         MOVE 'EXVS100'               TO ERR-PROG-NAME                  00
174000         MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE                    00
174100         MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME                 00
174200         PERFORM 9999-ABEND                                             00
174300     END-IF
174400     .
174500
174600/*****************************************************************
174700* FETCH CURSOR FOR MEXA001MSTR                                   *
174800******************************************************************
174900 3117-FETCH-CURSOR.
175000
175100     EXEC SQL
175200         FETCH MEXA001MSTR_2_CSR
175300          INTO                                                    00118400
175400                :MEXA001MSTR.EVS-P-CONTROL-NO   ,                 00118500
175500                :MEXA001MSTR.EVS-S-WMI          ,                 00118600
175600                :MEXA001MSTR.EVS-S-PLANT        ,                 00118700
175700                :MEXA001MSTR.EVS-S-SERIAL       ,                 00118800
175800                :MEXA001MSTR.EVS-S-STATUS-CODE  ,                 00118900
175900                :MEXA001MSTR.EVS-S-STATUS-DATE  ,                 00119000
176000                :MEXA001MSTR.EVS-U-DIV-CODE     ,                 00119100
176100                :MEXA001MSTR.EVS-U-ORIG-ORD-DIS ,                 00119200
176200                :MEXA001MSTR.EVS-U-ORIG-ORD-DLR ,                 00119300
176300                :MEXA001MSTR.EVS-U-VO-IMAGE     ,                 00119400
176400                :MEXA001MSTR.EVS-U-ORIG-ORD-TYP ,                 00119500
176500                :MEXA001MSTR.EVS-U-BAO-VEH-LINE ,                 00119600
176600                :MEXA001MSTR.EVS-U-MSA-PRC-DT   ,                 00119700
176700                :MEXA001MSTR.EVS-U-MSA-REC-DT   ,                 00119800
176800                :MEXA001MSTR.EVS-U-SCHED-DT     ,                 00119900
176900                :MEXA001MSTR.EVS-U-SEG-DATE     ,                 00120000
177000                :MEXA001MSTR.EVS-U-SPEC-CHG-DT  ,                 00120100
177100                :MEXA001MSTR.EVS-U-DSO-PLT-DT   ,                 00120200
177200                :MEXA001MSTR.EVS-U-COMB-ERR-IND ,                 00120300
177300                :MEXA001MSTR.EVS-U-DSO-PTO-IND  ,                 00120400
177400                :MEXA001MSTR.EVS-U-ERR-LVL-IND  ,                 00120500
177500                :MEXA001MSTR.EVS-U-PROD-H-IND   ,                 00120600
177600                :MEXA001MSTR.EVS-U-PLT-SUB-IND  ,                 00120700
177700                :MEXA001MSTR.EVS-U-REV-DORA-IND ,                 00120800
177800                :MEXA001MSTR.EVS-U-DORA-GEN-IND ,                 00120900
177900                :MEXA001MSTR.EVS-U-COMP-ERR-IND ,                 00121000
178000                :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                 00121100
178100                :MEXA001MSTR.EVS-U-DORA-VALUE   ,                 00121200
178200                :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                 00121300
178300                :MEXA001MSTR.EVS-F-FLEET-IND    ,                 00121400
178400                :MEXA001MSTR.EVS-F-FLT-RTK-IND  ,                 00121500
178500                :MEXA001MSTR.EVS-F-DEALER-NAME  ,                 00121600
178600                :MEXA001MSTR.EVS-F-MVMA-CNTY-CD ,                 00121700
178700                :MEXA001MSTR.EVS-F-FIES-PROD-PF ,                 00121800
178800                :MEXA001MSTR.EVS-F-FIES-PROD-SF ,                 00121900
178900                :MEXA001MSTR.EVS-F-EST-VALUE    ,                 00122000
179000                :MEXA001MSTR.EVS-F-CREATE-RC-DT ,                 00122100
179100                :MEXA001MSTR.EVS-F-EUROPEAN-IND                   00122200
179200     END-EXEC
179300
179400     EVALUATE SQLCODE                                             00093000
179500        WHEN ZEROS                                                00093100
179600             CONTINUE                                                   07
179700
179800         WHEN OTHER
179900              MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR            00
180000              MOVE EVS-S-DIST              TO ERR-S-DIST                00
180100              MOVE EVS-S-DLR               TO ERR-S-DLR                 00
180200              MOVE EVS-S-BODY              TO ERR-S-BODY                00
180300              MOVE EVS-S-ITEM              TO ERR-S-ITEM                00
180400              MOVE SQLCODE                 TO EDIT-SQLCODE              00
180500              MOVE '3117-FETCH-CURSOR'     TO ERR-ABEND-PARA            00
180600              MOVE SPACES                  TO ERR-ABEND-CODE            00
180700              MOVE 'FETCH'                 TO ERR-FUNCTION-CALL         00
180800              MOVE SPACES                  TO ERR-SEG-NAME              00
180900              MOVE 'EXVS100'               TO ERR-PROG-NAME             00
181000              MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE               00
181100              MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME            00
181200              PERFORM 9999-ABEND                                        00
181300     END-EVALUATE
181400     .
181500
181600/*****************************************************************
181700* CLOSE CURSOR FOR MEXA001MSTR                                   *
181800******************************************************************
181900 3118-CLOSE-CURSOR.
182000
182100     EXEC SQL
182200         CLOSE MEXA001MSTR_2_CSR
182300     END-EXEC
182400
182500     IF  SQLCODE NOT = ZERO
182600         MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR                 00
182700         MOVE EVS-S-DIST              TO ERR-S-DIST                     00
182800         MOVE EVS-S-DLR               TO ERR-S-DLR                      00
182900         MOVE EVS-S-BODY              TO ERR-S-BODY                     00
183000         MOVE EVS-S-ITEM              TO ERR-S-ITEM                     00
183100         MOVE SQLCODE                 TO EDIT-SQLCODE                   00
183200         MOVE '3118-CLOSE-CURSOR'     TO ERR-ABEND-PARA                 00
183300         MOVE SPACES                  TO ERR-ABEND-CODE                 00
183400         MOVE 'CLOSE'                 TO ERR-FUNCTION-CALL              00
183500         MOVE SPACES                  TO ERR-SEG-NAME                   00
183600         MOVE 'EXVS100'               TO ERR-PROG-NAME                  00
183700         MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE                    00
183800         MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME                 00
183900         PERFORM 9999-ABEND                                             00
184000     END-IF
184100     .
184200                                                                  PEXCR198
184300/                                                                 00125800
184400 3120-CHECK-S2KEY.                                                00125900
184500***************************************************************** 00126000
184600*                                                               * 00126100
184700*  DESCRIPTION: UPDATE RECORD                                   * 00126200
184800*                                                               * 00126300
184900***************************************************************** 00126400
185000                                                                  00126500
185100* THE FOLLOWING MAKES SURE AN UPDATED RECORD FROM NAVIS IS NOT    00126600
185200* OVER WRITTEN BY A USOB RECORD.                                  00126700
185300                                                                  00126800
185400      MOVE EVS-S-MODEL-YR             TO EVS-S-2-MODEL-YR         00126900
185500      MOVE EVS-S-WMI                  TO EVS-S-2-WMI              00127000
185600      MOVE EVS-S-PLANT                TO EVS-S-2-PLANT            00127100
185700      MOVE EVS-S-SERIAL               TO EVS-S-2-BASE             00127200
185800                                                                  00127300
185900* MODEL YEAR CAN NOT BE ADDED TO THIS CHECK FOR S2KEY BECAUSE     00127400
186000* ON THE WANG THERE IS A SEPARATE MODEL YEAR FOR S1KEY AND S2KEY  00127500
186100* AND ON THE IBM THERE IS ONLY ONE MODEL YEAR FOR BOTH S1KEY AND  00127600
186200* S2KEY                      6/12/92                              00127700
186300                                                                  00127800
186400      IF (EVS-S-WMI  = SPACES AND                                 00127900
186500          EVS-S-PLANT = SPACES AND                                00128000
186600          EVS-S-SERIAL = SPACES) OR                               00128100
186700          UW-STATUS = '999'                                       00128200
186800          IF WS-NO-DUPLICATE-S1                                   00128300
186900             PERFORM 3130-PROCESS-FOR-UPDATE                      00128400
187000          END-IF                                                  00128500
187100      ELSE                                                        00128600
187200       IF UW-VO-6-11 = SPACES                                     00128700
187300          MOVE '**VEHICLE ON NAVIS**' TO AUDIT-MESSAGE            00128800
187400          MOVE SPACES                 TO AUDIT-COUNT              00128900
187500          MOVE UW-VO-4                TO TKA-MODEL-YR             00129000
187600          MOVE UW-DIST                TO TKA-DIST                 00129100
187700          MOVE UW-DLR                 TO TKA-DLR                  00129200
187800          MOVE UW-VO-1-3              TO TKA-BODY                 00129300
187900          MOVE UW-ITEM                TO TKA-ORDER                00129400
188000          MOVE TEMP-KEY-FOR-AUDIT-RPT TO AUDIT-COUNT1             00129500
188100          MOVE EVS-S-2KEY             TO AUDIT-COUNT2             00129600
188200          MOVE AUDIT-DETAIL           TO AUDIT-RECORD             00129700
188300          MOVE ADVANCE-LINE2          TO AUDIT-CC                 00129800
188400          PERFORM 8100-WRITE-AUDIT-RECORD                         00129900
188500          PERFORM 8200-CHECK-LINE-CNT                             00130000
188600          MOVE TEMP-KEY-FOR-AUDIT-RPT TO RPT-MY-DLR-BDY-ORD       00130100
188700          MOVE EVS-S-2-MODEL-YR       TO RPT-MY2                  00130200
188800          MOVE EVS-S-2-WMI-1-2        TO RPT-WMI                  00130300
188900          MOVE EVS-S-2-PLANT          TO RPT-PLT                  00130400
189000          MOVE EVS-S-2-BASE           TO RPT-SER                  00130500
189100          MOVE SPACES                 TO RPT-ERROR-CONDITION      00130600
189200          MOVE 'POSSIBLE DUPLICATE ORDER NUMBER(VEHICLE ON NAVIS)'00130700
189300                                      TO RPT-MESSAGE              00130800
189400          MOVE REPORT-DETAIL          TO REPORT-RECORD            00130900
189500          MOVE ADVANCE-LINE1          TO REPORT-CC                00131000
189600          PERFORM 8400-WRITE-REPORT-RECORD                        00131100
189700          ADD +1                      TO LINE-CNT                 00131200
189800          MOVE 'Y'                    TO REPORT-SWITCH            00131300
189900          ADD +1                      TO NAV-UPDATE-CNT           00131400
190000       ELSE                                                       00131500
190100          ADD +1                      TO NAV-UPDATE-CNT.          00131600
190200/                                                                 00131700
190300 3130-PROCESS-FOR-UPDATE.                                         00131800
190400**************************************************************    00131900
190500*                                                            *    00132000
190600*  DESCRIPTION: UPDATE THE EVS MASTER WITH NEW DATA          *    00132100
190700*                                                            *    00132200
190800**************************************************************    00132300
190900                                                                  00132400
191000     PERFORM 3200-BLD-EVS-VOIMAGE                                 00132500
191100     IF TD-YY > '70'                                              00132600
191200        MOVE '0'                     TO EXV-TIMESTAMP-DATE-C      00132700
191300     ELSE                                                         00132800
191400        MOVE '1'                     TO EXV-TIMESTAMP-DATE-C      00132900
191500     END-IF                                                       00133000
191600     MOVE TODAYS-DATE                 TO EXV-TIMESTAMP-DATE-YMD   00133100
191700     ACCEPT TODAYS-TIME FROM TIME                                 00133200
191800     MOVE TODAYS-TIME                 TO EXV-TIMESTAMP-TIME       00133300
191900                                                                  00133400
192000**** CODE MODIFIED NOT TO UPDATE FOR CANCEL STATUS IF S2-KEYS ****00133500
192100**** FROM USOB AND MASTER DO NOT MATCH                        ****00133600
192200                                                                  00133700
192300     MOVE 'N'   TO S2KEY-MISMATCH-CAN-FLAG                        00133800
192400     IF (EXV-S-2-WMI       NOT = EVS-S-WMI      OR                00133900
192500         EXV-S-2-PLANT     NOT = EVS-S-PLANT    OR                00134000
192600         EXV-S-2-BASE      NOT = EVS-S-SERIAL ) AND               00134100
192700        (UW-STATUS  =  '999')                                     00134200
192800        MOVE 'Y' TO S2KEY-MISMATCH-CAN-FLAG                       00134300
192900        MOVE SPACES TO RPT-ERROR-CONDITION                        00134400
193000        STRING EXV-S-2-WMI, EXV-S-2-PLANT, EXV-S-2-BASE, ','      00134500
193100               EVS-S-WMI, EVS-S-PLANT, EVS-S-SERIAL               00134600
193200               DELIMITED BY SIZE INTO RPT-ERROR-CONDITION         00134700
193300       MOVE                                                       00134800
193400      'USOBS2KEY,MSTRS2KEY MISMATCH FOR CANCEL STATUS,CANNOT UPDT'00134900
193500           TO RPT-MESSAGE                                         00135000
193600           MOVE REPORT-DETAIL        TO REPORT-RECORD             00135100
193700           MOVE ADVANCE-LINE1        TO REPORT-CC                 00135200
193800           PERFORM 8400-WRITE-REPORT-RECORD                       00135300
193900           ADD +1                    TO LINE-CNT                  00135400
194000           MOVE 'Y'                  TO REPORT-SWITCH             00135500
194100     END-IF                                                       00135600
194200     IF NOT S2KEY-MISMATCH-CAN                                    00135700
194300        MOVE EXV-FILE-WS                 TO MEXA001MSTR           00135800
194400                                                                  00135900
194500**   ADDED CODE TO AVOID DUPLICATE S2-KEYS GETTING UPDATED     ** 00136000
194600**   IN MASTER                                                 ** 00136100
194700**                                                             ** 00136200
194800        MOVE 'N'                      TO S2-KEY-FOUND-FLAG        00136300
194900        IF (EVS-S-MODEL-YR  NOT = SPACES    AND                   00136400
195000            EVS-S-WMI       NOT = SPACES    AND                   00136500
195100            EVS-S-PLANT     NOT = SPACES    AND                   00136600
195200            EVS-S-SERIAL    NOT = SPACES  ) AND                   00136700
195300            UW-STATUS  NOT = '999'                                00136800
195400            PERFORM 3160-SELECT-EVSMSTR-S2-KEY                    00136900
195500            IF S2-KEY-FOUND                                       00137000
195600               ADD 1                     TO DUPLICATE-CNT         00137100
195700               MOVE SPACES               TO REPORT-DETAIL         00137200
195800               STRING 'DUPLICATE S2 KEY WITH STATUS '             00137300
195900                    WS-STATUS-CODE  ' WHILE UPDATE'               00137400
196000                DELIMITED BY SIZE INTO RPT-MESSAGE                00137500
196100                MOVE EVS-S-WMI            TO RPT-WMI              00137600
196200                MOVE EVS-S-MODEL-YR       TO RPT-MY2              00137700
196300                MOVE EVS-S-PLANT          TO RPT-PLT              00137800
196400                MOVE EVS-S-SERIAL         TO RPT-SER              00137900
196500                STRING EVS-S-MODEL-YR, EVS-S-DLR, EVS-S-BODY,     00138000
196600                       EVS-S-ITEM  DELIMITED BY SIZE INTO         00138100
196700                       RPT-MY-DLR-BDY-ORD                         00138200
196800                MOVE REPORT-DETAIL        TO REPORT-RECORD        00138300
196900                MOVE ADVANCE-LINE1        TO REPORT-CC            00138400
197000                PERFORM 8400-WRITE-REPORT-RECORD                  00138500
197100                ADD +1                    TO LINE-CNT             00138600
197200                MOVE 'Y'                  TO REPORT-SWITCH        00138700
197300            END-IF                                                00138800
197400         END-IF                                                   00138900
197500     END-IF                                                       00139000
197600     IF S2-KEY-NOT-FOUND   AND NOT S2KEY-MISMATCH-CAN             00139100
197700         PERFORM 7300-UPDATE-EVSMSTR                              00139200
197800     END-IF   .                                                   00139300
197900                                                                  00139400
198000*    PERFORM 7300-UPDATE-EVSMSTR                                  00139500
198100/                                                                 00139600
198200 3150-PROCESS-FOR-WRITE.                                          00139700
198300**************************************************************    00139800
198400*                                                            *    00139900
198500*  DESCRIPTION: WRITE NEW EVS MASTER RECORDS                 *    00140000
198600*                                                            *    00140100
198700**************************************************************    00140200
198800                                                                  00140300
198900     INITIALIZE  EXV-FILE-WS.                                     00140400
199000                                                                  00140500
199100     PERFORM 3175-BLD-EVS-PROCESS-BODY.                           00140600
199200                                                                  00140700
199300     PERFORM 3200-BLD-EVS-VOIMAGE.                                00140800
199400                                                                  00140900
199500     IF TD-YY > '70'                                              00141000
199600         MOVE '0'                     TO EXV-F-CREATE-REC-C       00141100
199700         MOVE '0'                     TO EXV-TIMESTAMP-DATE-C     00141200
199800     ELSE                                                         00141300
199900         MOVE '1'                     TO EXV-F-CREATE-REC-C       00141400
200000         MOVE '1'                     TO EXV-TIMESTAMP-DATE-C     00141500
200100     END-IF.                                                      00141600
200200                                                                  00141700
200300     MOVE TODAYS-DATE                 TO EXV-F-CREATE-REC-YMD.    00141800
200400     MOVE TODAYS-DATE                 TO EXV-TIMESTAMP-DATE-YMD.  00141900
200500                                                                  00142000
200600     ACCEPT TODAYS-TIME FROM TIME.                                00142100
200700     MOVE TODAYS-TIME                 TO EXV-TIMESTAMP-TIME.      00142200
200800                                                                  00142300
200900     MOVE EXV-FILE-WS                 TO MEXA001MSTR.             00142400
201000                                                                  00142500
201100     MOVE 'N'                         TO S2-KEY-FOUND-FLAG.       00142600
201200                                                                  00142700
201300**   ADDED CODE TO AVOID DUPLICATE S2-KEYS GETTING INSERTED    ** 00142800
201400**   INTO MASTER                                               ** 00142900
201500**                                                             ** 00143000
201600     IF (EVS-S-MODEL-YR  NOT = SPACES   AND                       00143100
201700         EVS-S-WMI       NOT = SPACES   AND                       00143200
201800         EVS-S-PLANT     NOT = SPACES   AND                       00143300
201900         EVS-S-SERIAL    NOT = SPACES  )                          00143400
202000         PERFORM 3160-SELECT-EVSMSTR-S2-KEY                       00143500
202100         IF S2-KEY-FOUND                                          00143600
202200            ADD 1                     TO DUPLICATE-CNT            00143700
202300            MOVE SPACES               TO REPORT-DETAIL            00143800
202400            STRING 'DUPLICATE S2 KEY WITH STATUS '                00143900
202500              WS-STATUS-CODE  ' WHILE INSERT'                     00144000
202600                             DELIMITED BY SIZE INTO RPT-MESSAGE   00144100
202700            MOVE EVS-S-WMI            TO RPT-WMI                  00144200
202800            MOVE EVS-S-MODEL-YR       TO RPT-MY2                  00144300
202900            MOVE EVS-S-PLANT          TO RPT-PLT                  00144400
203000            MOVE EVS-S-SERIAL         TO RPT-SER                  00144500
203100            STRING EVS-S-MODEL-YR, EVS-S-DLR, EVS-S-BODY,         00144600
203200                   EVS-S-ITEM  DELIMITED BY SIZE INTO             00144700
203300                   RPT-MY-DLR-BDY-ORD                             00144800
203400            MOVE REPORT-DETAIL        TO REPORT-RECORD            00144900
203500            MOVE ADVANCE-LINE1        TO REPORT-CC                00145000
203600            PERFORM 8400-WRITE-REPORT-RECORD                      00145100
203700            ADD +1                    TO LINE-CNT                 00145200
203800            MOVE 'Y'                  TO REPORT-SWITCH            00145300
203900         END-IF                                                   00145400
204000     END-IF.                                                      00145500
204100     IF S2-KEY-NOT-FOUND                                          00145600
204200        PERFORM 7200-INSERT-EVSMSTR                               00145700
204300     END-IF.                                                      00145800
204400                                                                  00145900
204500*    PERFORM 7200-INSERT-EVSMSTR.                                 00146000
204600/                                                                 00146100
204700 3160-SELECT-EVSMSTR-S2-KEY.                                      00146200
204800**************************************************************    00146300
204900*                                                            *    00146400
205000*  DESCRIPTION: SELECT RECORD FROM MASTER WITH S2-KEY        *    00146500
205100*                                                            *    00146600
205200**************************************************************    00146700
205300                                                                  00146800
205400     EXEC SQL                                                     00146900
205500          SELECT                                                  00147000
205600                EVS_S_STATUS_CODE                                 00147100
205700          INTO :WS-STATUS-CODE                                    00147200
205800          FROM MEXA001MSTR                                        00147300
205900          WHERE                                                   00147400
206000                EVS_S_MODEL_YR     = :EVS-S-MODEL-YR              00147500
206100          AND   EVS_S_WMI          = :EVS-S-WMI                   00147600
206200          AND   EVS_S_PLANT        = :EVS-S-PLANT                 00147700
206300          AND   EVS_S_SERIAL       = :EVS-S-SERIAL                00147800
206400          AND   EVS_S_STATUS_CODE NOT IN ('100', '990')           00147900
206500     END-EXEC.                                                    00148000
206600                                                                  00148100
206700     EVALUATE SQLCODE                                             00148200
206800        WHEN ZEROS                                                00148300
206900           MOVE 'Y'                     TO S2-KEY-FOUND-FLAG      00148400
207000        WHEN +100                                                 00148500
207100           CONTINUE                                               00148600
207200        WHEN OTHER                                                00148700
207300           MOVE EVS-S-MODEL-YR          TO ERR-S-MODEL-YR         00148800
207400           MOVE EVS-S-DIST              TO ERR-S-DIST             00148900
207500           MOVE EVS-S-DLR               TO ERR-S-DLR              00149000
207600           MOVE EVS-S-BODY              TO ERR-S-BODY             00149100
207700           MOVE EVS-S-ITEM              TO ERR-S-ITEM             00149200
207800           MOVE SQLCODE                 TO EDIT-SQLCODE           00149300
207900           MOVE '3160-SELECT-EVSMSTR-S2-KEY' TO ERR-ABEND-PARA    00149400
208000           MOVE SPACES                  TO ERR-ABEND-CODE         00149500
208100           MOVE 'SELECT'                TO ERR-FUNCTION-CALL      00149600
208200           MOVE SPACES                  TO ERR-SEG-NAME           00149700
208300           MOVE 'EXVS100'               TO ERR-PROG-NAME          00149800
208400           MOVE EDIT-SQLCODE-R          TO ERR-SQLCODE            00149900
208500           MOVE 'MEXA001MSTR'           TO ERR-TABLE-NAME         00150000
208600           PERFORM 9999-ABEND                                     00150100
208700      END-EVALUATE.                                               00150200
208800/                                                                 00150300
208900 3175-BLD-EVS-PROCESS-BODY.                                       00150400
209000**************************************************************    00150500
209100*                                                            *    00150600
209200*  DESCRIPTION: UPDATE THE NEW EVS MASTER FILE               *    00150700
209300*                                                            *    00150800
209400**************************************************************    00150900
209500                                                                  00151000
209600     ADD +1                           TO WS-CONTROL-NUMBER.       00151100
209700     MOVE WS-CONTROL-NUMBER           TO EXV-P-CONTROL-NO.        00151200
209800                                                                  00151300
209900     MOVE '5'                         TO EXV-U-DIV-CODE.          00151400
210000                                                                  00151500
210100     MOVE ZEROS                       TO EXV-U-DSO-PTO-ORD-QTY.   00151600
210200     MOVE ZEROS                       TO EXV-U-DORA-VALUE.        00151700
210300                                                                  00151800
210400     MOVE UW-DIST                     TO EXV-U-ORIG-ORD-DIST.     00151900
210500     MOVE UW-DLR                      TO EXV-U-ORIG-ORD-DLR.      00152000
210600     MOVE UW-VO-22                    TO EXV-U-ORIG-ORD-TYPE.     00152100
210700                                                                  00152200
210800     MOVE UW-VO-4                     TO EVS-BODY-MODEL-YR.       00152300
210900     MOVE UW-VO-1-3                   TO EVS-BODY-TYPE.           00152400
211000                                                                  00152500
211100     PERFORM 7500-READ-BODY-FILE.                                 00152600
211200/                                                                 00152700
211300 3200-BLD-EVS-VOIMAGE.                                            00152800
211400**************************************************************    00152900
211500*                                                            *    00153000
211600*  DESCRIPTION:  BUILD THE NEW EVS MASTER FILE               *    00153100
211700*                                                            *    00153200
211800**************************************************************    00153300
211900                                                                  00153400
212000      MOVE UW-VO-4                    TO EXV-S-1-MODEL-YR.        00153500
212100      MOVE UW-DIST                    TO EXV-S-1-DIST.            00153600
212200      MOVE UW-DLR                     TO EXV-S-1-DLR.             00153700
212300      MOVE UW-VO-1-3                  TO EXV-S-1-BODY.            00153800
212400      MOVE UW-ITEM                    TO EXV-S-1-ITEM.            00153900
212500      MOVE UW-VO-1-26                 TO EXV-U-VO-1-26.           00154000
212600      MOVE UW-VO-27-30                TO EXV-U-VO-27-30.          00154100
212700      MOVE UW-VO-31-43                TO EXV-U-VO-31-43.          00154200
212800      MOVE UW-VO-44                   TO EXV-U-VO-44.             00154300
212900      MOVE UW-VO-45-47                TO EXV-U-VO-45-47.          00154400
213000      MOVE UW-VO-48-49                TO EXV-U-VO-48-49.          00154500
213100      MOVE UW-VO-50-56                TO EXV-U-VO-50-56.          00154600
213200      MOVE UW-VO-57-69                TO EXV-U-VO-57-69.          00154700
213300                                                                  00154800
213400      IF EXV-U-VO-5     NOT = SPACES AND                          00154900
213500         EXV-U-VO-6-11  NOT = SPACES AND                          00155000
213600         EXV-S-2-KEY        = SPACES                              00155100
213700         MOVE UW-VO-100-160(1:2)         TO EXV-S-2-WMI-1-2       00155200
213800         MOVE SPACES                     TO EXV-S-2-WMI-3         00155300
213900         MOVE EXV-U-VO-5                 TO EXV-S-2-PLANT         00155400
214000         MOVE EXV-U-VO-6-11              TO EXV-S-2-BASE          00155500
214100      END-IF.                                                     00155600
214200                                                                  00155700
214300      IF EXV-U-VO-70-75 = SPACES                                  00155800
214400          PERFORM 3500-BLD-EVS-U-VO70-75                          00155900
214500      ELSE                                                        00156000
214600          MOVE UW-VO-70-75            TO EXV-U-VO-70-75.          00156100
214700                                                                  00156200
214800      MOVE UW-VO-76-98                TO EXV-U-VO-76-98.          00156300
214900      MOVE UW-VO-99-160               TO EXV-U-VO-99-160.         00156400
215000      MOVE UW-9270-CL                 TO EXV-U-BAO-VEH-LINE.      00156500
215100                                                                  00156600
215200      MOVE UW-VO-22                   TO WS-VO-22.                00156700
215300      MOVE UW-VO-23                   TO WS-VO-23.                00156800
215400      IF RETAIL-UNIT                                              00156900
215500         MOVE 'R'                     TO EXV-F-FLT-RET-STK-IND    00157000
215600      ELSE                                                        00157100
215700         IF VO-22-IS-9 AND STOCK-UNIT                             00157200
215800            MOVE 'S'                  TO EXV-F-FLT-RET-STK-IND    00157300
215900         ELSE                                                     00157400
216000            IF VO-22-IS-9 AND FLEET-UNIT                          00157500
216100               MOVE 'F'               TO EXV-F-FLT-RET-STK-IND.   00157600
216200                                                                  00157700
216300      PERFORM 3250-BLD-EVS-PMON-DATE-IND.                         00157800
216400                                                                  00157900
216500/                                                                 00158000
216600 3250-BLD-EVS-PMON-DATE-IND.                                      00158100
216700**************************************************************    00158200
216800*                                                            *    00158300
216900*  DESCRIPTION:  BUILD THE NEW EVS MASTER FILE               *    00158400
217000*                                                            *    00158500
217100**************************************************************    00158600
217200                                                                  00158700
217300*  THE FOLLOWING BYPASSES MILITARY UNITS WHICH ARE UPDATED        00158800
217400*  WITH PRODUCTION MONTH AND YEAR FROM THE USOB NOTES TRAILER.    00158900
217500*  ALL OTHER UNITS WILL HAVE PRODUCTION MONTH AND YEAR            00159000
217600*  CALCULATED.                                                    00159100
217700                                                                  00159200
217800      IF (EXV-U-VO-70-71 = '9E')                                  00159300
217900      AND (EXV-U-VO-73-75 = '900'                                 00159400
218000      OR  EXV-U-VO-73-75 = '905')                                 00159500
218100         CONTINUE                                                 00159600
218200      ELSE                                                        00159700
218300         PERFORM 3600-SEARCH-MONTH.                               00159800
218400                                                                  00159900
218500      PERFORM 3700-READ-DESC.                                     00160000
218600                                                                  00160100
218700*  THE FOLLOWING CHECKS THE STATUS CODE '999' (USOB CANCELLED     00160200
218800*  RECORD) AND CHANGES IT TO A NAVIS CANCELLED CODE OF '100'      00160300
218900                                                                  00160400
219000      IF UW-STATUS = '999'                                        00160500
219100         MOVE '100'                   TO EXV-STATUS-CODE          00160600
219200      ELSE                                                        00160700
219300         MOVE UW-STATUS               TO EXV-STATUS-CODE.         00160800
219400                                                                  00160900
219500      PERFORM 3275-CHECK-UW-DATES.                                00161000
219600                                                                  00161100
219700      MOVE UW-CONV-ERR                TO EXV-U-COMB-ERR-IND.      00161200
219800      MOVE UW-DSO-PTO                 TO EXV-U-DSO-PTO-IND.       00161300
219900      MOVE UW-ERROR-LVL               TO EXV-U-ERR-LVL-IND.       00161400
220000      MOVE UW-PROD-HOLD               TO EXV-U-PROD-HOLD-IND.     00161500
220100      MOVE UW-PLT-SUB-IND             TO EXV-U-PLT-SUB-IND.       00161600
220200      MOVE UW-REV-DORA-GEN            TO EXV-U-REV-DORA-GEN-IND.  00161700
220300      MOVE UW-DORA-GEN                TO EXV-U-DORA-GEN-IND.      00161800
220400                                                                  00161900
220500*  THE FOLLOWING FIELD IS NO LONGER AVAILABLE FROM THE            00162000
220600*  UNSCHEDULED ORDER BANK SYSTEM 7/26/90                          00162100
220700                                                                  00162200
220800      MOVE SPACES                     TO EXV-U-COMP-ERR-IND.      00162300
220900                                                                  00162400
221000      MOVE '5'                        TO CDDB-P-DIV.              00162500
221100      MOVE UW-DIST                    TO CDDB-P-DIST.             00162600
221200      MOVE UW-DLR                     TO CDDB-P-DLR.              00162700
221300                                                                  00162800
221400      PERFORM 3300-BLD-EVS-READ-CDDB.                             00162900
221500/                                                                 00163000
221600 3275-CHECK-UW-DATES.                                             00163100
221700**************************************************************    00163200
221800*                                                            *    00163300
221900*  DESCRIPTION:  CHECK UW DATES.                             *    00163400
222000*                                                            *    00163500
222100**************************************************************    00163600
222200                                                                  00163700
222300     IF UW-STATUS-DATE(1:2) > '70'                                00163800
222400         MOVE ZERO                   TO EXV-STATUS-C              00163900
222500     ELSE                                                         00164000
222600         MOVE '1'                    TO EXV-STATUS-C              00164100
222700     END-IF.                                                      00164200
222800     MOVE UW-STATUS-DATE             TO EXV-STATUS-YMD.           00164300
222900                                                                  00164400
223000     IF UW-PROCESS-DATE = SPACES OR                               00164500
223100        UW-PROCESS-DATE = ZEROS                                   00164600
223200         CONTINUE                                                 00164700
223300     ELSE                                                         00164800
223400         IF UW-PROCESS-DATE(1:2) > '70'                           00164900
223500             MOVE ZERO                TO EXV-U-MSA-ORD-PRC-C      00165000
223600         ELSE                                                     00165100
223700             MOVE '1'                 TO EXV-U-MSA-ORD-PRC-C      00165200
223800         END-IF                                                   00165300
223900         MOVE UW-PROCESS-DATE         TO EXV-U-MSA-ORD-PRC-YMD    00165400
224000     END-IF.                                                      00165500
224100                                                                  00165600
224200     IF UW-RECEIPT-DATE = SPACES OR                               00165700
224300        UW-RECEIPT-DATE = ZEROS                                   00165800
224400         CONTINUE                                                 00165900
224500     ELSE                                                         00166000
224600         IF UW-RECEIPT-DATE(1:2) > '70'                           00166100
224700             MOVE ZERO                TO EXV-U-MSA-ORD-REC-C      00166200
224800         ELSE                                                     00166300
224900             MOVE '1'                 TO EXV-U-MSA-ORD-REC-C      00166400
225000         END-IF                                                   00166500
225100         MOVE UW-RECEIPT-DATE         TO EXV-U-MSA-ORD-REC-YMD    00166600
225200     END-IF.                                                      00166700
225300                                                                  00166800
225400     IF UW-SCHEDULE-DATE = SPACES OR                              00166900
225500        UW-SCHEDULE-DATE = ZEROS                                  00167000
225600         CONTINUE                                                 00167100
225700     ELSE                                                         00167200
225800         IF UW-SCHEDULE-DATE(1:2) > '70'                          00167300
225900             MOVE ZERO                TO EXV-U-ORIG-SCHED-C       00167400
226000             MOVE ZERO                TO EXV-U-SEG-C              00167500
226100         ELSE                                                     00167600
226200             MOVE '1'                 TO EXV-U-ORIG-SCHED-C       00167700
226300             MOVE '1'                 TO EXV-U-SEG-C              00167800
226400         END-IF                                                   00167900
226500         MOVE UW-SCHEDULE-DATE        TO EXV-U-ORIG-SCHED-YMD     00168000
226600         MOVE UW-SCHEDULE-DATE        TO EXV-U-SEG-YMD            00168100
226700     END-IF.                                                      00168200
226800                                                                  00168300
226900     IF UW-SPEC-CHANGE-DATE = SPACES OR                           00168400
227000        UW-SPEC-CHANGE-DATE = ZEROS                               00168500
227100         CONTINUE                                                 00168600
227200     ELSE                                                         00168700
227300         IF UW-SPEC-CHANGE-DATE(1:2) > '70'                       00168800
227400             MOVE ZERO                TO EXV-U-SPEC-CHG-C         00168900
227500         ELSE                                                     00169000
227600             MOVE '1'                 TO EXV-U-SPEC-CHG-C         00169100
227700         END-IF                                                   00169200
227800         MOVE UW-SPEC-CHANGE-DATE     TO EXV-U-SPEC-CHG-YMD       00169300
227900     END-IF.                                                      00169400
228000                                                                  00169500
228100     IF UW-DSO-PLT-SUB-DATE = SPACES OR                           00169600
228200        UW-DSO-PLT-SUB-DATE = ZEROS                               00169700
228300         CONTINUE                                                 00169800
228400     ELSE                                                         00169900
228500         IF UW-DSO-PLT-SUB-DATE(1:2) > '70'                       00170000
228600             MOVE ZERO                TO EXV-U-DSO-PLT-STAT-C     00170100
228700         ELSE                                                     00170200
228800             MOVE '1'                 TO EXV-U-DSO-PLT-STAT-C     00170300
228900         END-IF                                                   00170400
229000         MOVE UW-DSO-PLT-SUB-DATE     TO EXV-U-DSO-PLT-STAT-YMD   00170500
229100     END-IF.                                                      00170600
229200/                                                                 00170700
229300 3300-BLD-EVS-READ-CDDB.                                          00170800
229400**************************************************************    00170900
229500*                                                            *    00171000
229600*  DESCRIPTION:  BUILD THE NEW EVS MASTER FILE               *    00171100
229700*                                                            *    00171200
229800**************************************************************    00171300
229900                                                                  00171400
230000     PERFORM 7600-READ-CDDB-FILE.                                 00171500
230100                                                                  00171600
230200     EVALUATE SQLCODE                                             00171700
230300        WHEN ZEROS                                                00171800
230400           PERFORM 3800-BLD-EVS-MVMA-IND                          00171900
230500        WHEN +100                                                 00172000
230600           MOVE 'INVALID CDDB RECORD' TO AUDIT-MESSAGE            00172100
230700           MOVE SPACES                TO AUDIT-COUNT              00172200
230800           MOVE CDDB-P-DIV            TO WS-HOLD-DIV              00172300
230900           MOVE CDDB-P-DIST           TO WS-HOLD-DIST             00172400
231000           MOVE CDDB-P-DLR            TO WS-HOLD-DLR              00172500
231100           MOVE WS-HOLD-CDDB-KEY      TO AUDIT-COUNT1             00172600
231200           MOVE 'VEHICLE ID'          TO AUDIT-COUNT2             00172700
231300           MOVE UW-VO-4               TO TKA-MODEL-YR             00172800
231400           MOVE UW-DIST               TO TKA-DIST                 00172900
231500           MOVE UW-DLR                TO TKA-DLR                  00173000
231600           MOVE UW-VO-1-3             TO TKA-BODY                 00173100
231700           MOVE UW-ITEM               TO TKA-ORDER                00173200
231800           MOVE TEMP-KEY-FOR-AUDIT-RPT TO AUDIT-COUNT3            00173300
231900           MOVE AUDIT-DETAIL          TO AUDIT-RECORD             00173400
232000           MOVE ADVANCE-LINE2         TO AUDIT-CC                 00173500
232100           PERFORM 8100-WRITE-AUDIT-RECORD                        00173600
232200           PERFORM 8200-CHECK-LINE-CNT                            00173700
232300           MOVE TEMP-KEY-FOR-AUDIT-RPT TO RPT-MY-DLR-BDY-ORD      00173800
232400           MOVE EXV-S-2-WMI-1-2       TO RPT-WMI-1-2              00173900
232500           MOVE EXV-S-1-MODEL-YR      TO RPT-MY2                  00174000
232600           MOVE EXV-S-2-PLANT         TO RPT-PLT                  00174100
232700           MOVE EXV-S-2-BASE          TO RPT-SER                  00174200
232800           MOVE WS-HOLD-CDDB-KEY      TO RPT-ERROR-CONDITION      00174300
232900           MOVE 'CDDB RECORD NOT FOUND IN CDDB FILE'              00174400
233000                                      TO RPT-MESSAGE              00174500
233100           MOVE REPORT-DETAIL         TO REPORT-RECORD            00174600
233200           MOVE ADVANCE-LINE2         TO AUDIT-CC                 00174700
233300           PERFORM 8100-WRITE-AUDIT-RECORD                        00174800
233400           ADD +1                     TO LINE-CNT                 00174900
233500           MOVE 'Y'                   TO REPORT-SWITCH            00175000
233600        WHEN OTHER                                                00175100
233700           MOVE  SQLCODE              TO EDIT-SQLCODE             00175200
233800           MOVE  '3300-BLD-EVS-READ-CDDB'                         00175300
233900                                      TO ERR-ABEND-PARA           00175400
234000           MOVE  SPACES               TO ERR-ABEND-CODE           00175500
234100           MOVE  'SELECT'             TO ERR-FUNCTION-CALL        00175600
234200           MOVE  SPACES               TO ERR-SEG-NAME             00175700
234300           MOVE  'EXVS100'            TO ERR-PROG-NAME            00175800
234400           MOVE 'MEXA012CDDB'         TO ERR-TABLE-NAME           00175900
234500           MOVE  EDIT-SQLCODE-R       TO ERR-SQLCODE              00176000
234600           PERFORM 9999-ABEND                                     00176100
234700      END-EVALUATE.                                               00176200
234800/                                                                 00176300
234900 3500-BLD-EVS-U-VO70-75.                                          00176400
235000**************************************************************    00176500
235100*                                                            *    00176600
235200*  DESCRIPTION:  IF EXV-U-VO-70-75 IS BLANK, UPDATE IT HERE  *    00176700
235300*                                                            *    00176800
235400**************************************************************    00176900
235500                                                                  00177000
235600      MOVE SPACES                     TO AUDIT-DETAIL.            00177100
235700                                                                  00177200
235800      IF UW-DIST = SPACES                                         00177300
235900          MOVE 'BLANK UW-DIST (S1,S2)    '                        00177400
236000                                      TO AUDIT-MESSAGE            00177500
236100          MOVE ' = '                  TO AUDIT-SEP                00177600
236200          MOVE SPACES                 TO AUDIT-COUNT              00177700
236300          STRING EXV-S-1-MODEL-YR, EXV-S-1-KEY DELIMITED          00177800
236400             BY SIZE INTO AUDIT-COUNT1                            00177900
236500          MOVE EXV-S-1-MODEL-YR       TO EVS-S-2-MODEL-YR         00178000
236600          MOVE EXV-S-2-WMI            TO EVS-S-2-WMI              00178100
236700          MOVE EXV-S-2-PLANT          TO EVS-S-2-PLANT            00178200
236800          MOVE EXV-S-2-BASE           TO EVS-S-2-BASE             00178300
236900          MOVE EVS-S-2KEY             TO AUDIT-COUNT2             00178400
237000          MOVE ADVANCE-LINE1          TO AUDIT-CC                 00178500
237100          PERFORM 8100-WRITE-AUDIT-RECORD                         00178600
237200          ADD +1                      TO USOB-ERROR-CNT           00178700
237300      ELSE                                                        00178800
237400          MOVE UW-DIST                TO EXV-U-VO-70-71.          00178900
237500                                                                  00179000
237600      IF UW-DLR-ZONE = SPACES                                     00179100
237700          MOVE 'BLANK UW-DLR-ZONE (S1,S2)'                        00179200
237800                                      TO AUDIT-MESSAGE            00179300
237900          MOVE ' = '                  TO AUDIT-SEP                00179400
238000          MOVE SPACES                 TO AUDIT-COUNT              00179500
238100          STRING EXV-S-1-MODEL-YR, EXV-S-1-KEY DELIMITED          00179600
238200             BY SIZE INTO AUDIT-COUNT1                            00179700
238300          MOVE EXV-S-1-MODEL-YR       TO EVS-S-2-MODEL-YR         00179800
238400          MOVE EXV-S-2-WMI            TO EVS-S-2-WMI              00179900
238500          MOVE EXV-S-2-PLANT          TO EVS-S-2-PLANT            00180000
238600          MOVE EXV-S-2-BASE           TO EVS-S-2-BASE             00180100
238700          MOVE EVS-S-2KEY             TO AUDIT-COUNT2             00180200
238800          MOVE ADVANCE-LINE1          TO AUDIT-CC                 00180300
238900          PERFORM 8100-WRITE-AUDIT-RECORD                         00180400
239000          ADD +1                      TO USOB-ERROR-CNT           00180500
239100      ELSE                                                        00180600
239200          MOVE UW-DLR-ZONE            TO EXV-U-VO-72.             00180700
239300                                                                  00180800
239400      IF UW-DLR = SPACES                                          00180900
239500          MOVE 'BLANK UW-DLR  (S1,S2)    '                        00181000
239600                                      TO AUDIT-MESSAGE            00181100
239700          MOVE ' = '                  TO AUDIT-SEP                00181200
239800          MOVE SPACES                 TO AUDIT-COUNT              00181300
239900          MOVE EVS-S-1-KEY            TO AUDIT-COUNT1             00181400
240000          MOVE EXV-S-1-MODEL-YR       TO EVS-S-2-MODEL-YR         00181500
240100          MOVE EXV-S-2-WMI            TO EVS-S-2-WMI              00181600
240200          MOVE EXV-S-2-PLANT          TO EVS-S-2-PLANT            00181700
240300          MOVE EXV-S-2-BASE           TO EVS-S-2-BASE             00181800
240400          MOVE EVS-S-2KEY             TO AUDIT-COUNT2             00181900
240500          MOVE ADVANCE-LINE1          TO AUDIT-CC                 00182000
240600          PERFORM 8100-WRITE-AUDIT-RECORD                         00182100
240700          ADD +1                      TO USOB-ERROR-CNT           00182200
240800      ELSE                                                        00182300
240900          MOVE UW-DLR                 TO EXV-U-VO-73-75.          00182400
241000/                                                                 00182500
241100 3600-SEARCH-MONTH.                                               00182600
241200**************************************************************    00182700
241300*                                                            *    00182800
241400*  DESCRIPTION: SEARCH FOR MONTH DESCRIPTION                 *    00182900
241500*                                                            *    00183000
241600**************************************************************    00183100
241700                                                                  00183200
241800      SET MONTH-INDEX                 TO 01.                      00183300
241900                                                                  00183400
242000      SEARCH MONTH-DATA                                           00183500
242100         AT END                                                   00183600
242200            PERFORM 3625-CHECK-PROD-MONTH                         00183700
242300         WHEN MONTH-ALPHA(MONTH-INDEX) = UW-VO-131                00183800
242400            PERFORM 3650-CHK-CNVT-PROD-MON.                       00183900
242500/                                                                 00184000
242600 3625-CHECK-PROD-MONTH.                                           00184100
242700***************************************************************   00184200
242800*                                                             *   00184300
242900*  DESCRIPTION:   CHECK FOR BLANK EVS-F-REQ-PROD-YY-MM BEFORE *   00184400
243000*                 PRINTING ERROR MESSAGE.                     *   00184500
243100*                                                             *   00184600
243200***************************************************************   00184700
243300                                                                  00184800
243400     IF EXV-F-REQ-PROD-YY-MM = SPACES                             00184900
243500         MOVE 'INVALID PROD MONTH'    TO AUDIT-MESSAGE            00185000
243600         MOVE SPACES                  TO AUDIT-COUNT              00185100
243700         MOVE UW-VO-131               TO AUDIT-COUNT1             00185200
243800         MOVE 'VEHICLE ID'            TO AUDIT-COUNT2             00185300
243900         STRING EXV-S-1-MODEL-YR, EXV-S-1-KEY DELIMITED           00185400
244000             BY SIZE INTO AUDIT-COUNT3                            00185500
244100         MOVE AUDIT-DETAIL            TO AUDIT-RECORD             00185600
244200         MOVE ADVANCE-LINE1           TO AUDIT-CC                 00185700
244300         PERFORM 8100-WRITE-AUDIT-RECORD                          00185800
244400         PERFORM 8200-CHECK-LINE-CNT                              00185900
244500         MOVE EXV-S-1-MODEL-YR        TO RPT-MY                   00186000
244600         MOVE EXV-S-1-KEY             TO RPT-DLR-BDY-ORD          00186100
244700         MOVE EXV-S-2-WMI-1-2         TO RPT-WMI-1-2              00186200
244800         MOVE EXV-S-1-MODEL-YR        TO RPT-MY2                  00186300
244900         MOVE EXV-S-2-PLANT           TO RPT-PLT                  00186400
245000         MOVE EXV-S-2-BASE            TO RPT-SER                  00186500
245100         MOVE UW-VO-131               TO RPT-ERROR-CONDITION      00186600
245200         MOVE 'REQUESTED PRODUCTION DATE NOT CORRECT'             00186700
245300                                      TO RPT-MESSAGE              00186800
245400         MOVE REPORT-DETAIL           TO REPORT-RECORD            00186900
245500         MOVE ADVANCE-LINE1           TO REPORT-CC                00187000
245600         PERFORM 8400-WRITE-REPORT-RECORD                         00187100
245700         ADD +1                       TO LINE-CNT                 00187200
245800         MOVE 'Y'                     TO REPORT-SWITCH.           00187300
245900/                                                                 00187400
246000 3650-CHK-CNVT-PROD-MON.                                          00187500
246100**************************************************************    00187600
246200*                                                            *    00187700
246300*  DESCRIPTION: SEARCH FOR MONTH DESCRIPTION                 *    00187800
246400*                                                            *    00187900
246500**************************************************************    00188000
246600                                                                  00188100
246700*  THE FOLLOWING ALLOWS THE PRODUCTION MONTH TO BE CALCULATED     00188200
246800*  FOR NEW OR CHANGED RECORDS ONLY.  9/7/90                       00188300
246900                                                                  00188400
247000      MOVE MONTH-NUMERIC(MONTH-INDEX) TO PROD-MONTH.              00188500
247100                                                                  00188600
247200      IF EXV-F-REQ-PROD-MM = PROD-MONTH                           00188700
247300         CONTINUE                                                 00188800
247400      ELSE                                                        00188900
247500         IF (PROD-MONTH = TD-MM) OR                               00189000
247600            (PROD-MONTH > TD-MM)                                  00189100
247700            MOVE TD-YY                TO PROD-YEAR                00189200
247800            IF TD-YY > '70'                                       00189300
247900                MOVE '0'              TO PROD-C                   00189400
248000            ELSE                                                  00189500
248100                MOVE '1'              TO PROD-C                   00189600
248200            END-IF                                                00189700
248300         ELSE                                                     00189800
248400            IF PROD-MONTH < TD-MM                                 00189900
248500               MOVE TD-MM             TO CALC-MM                  00190000
248600               SUBTRACT 1 FROM CALC-MM-N                          00190100
248700               IF PROD-MONTH = CALC-MM                            00190200
248800                  MOVE TD-YY          TO PROD-YEAR                00190300
248900                  IF TD-YY > '70'                                 00190400
249000                      MOVE '0'        TO PROD-C                   00190500
249100                  ELSE                                            00190600
249200                      MOVE '1'        TO PROD-C                   00190700
249300                  END-IF                                          00190800
249400                  MOVE PROD-MONTH     TO HOLD-MM                  00190900
249500                  ADD 1               TO HOLD-MM-N                00191000
249600                  MOVE HOLD-MM        TO PROD-MONTH               00191100
249700               ELSE                                               00191200
249800                  MOVE TD-YY          TO CALC-YY                  00191300
249900                  ADD 1               TO CALC-YY-N                00191400
250000                  MOVE CALC-YY        TO PROD-YEAR                00191500
250100                  IF CALC-YY > '70'                               00191600
250200                      MOVE '0'        TO PROD-C                   00191700
250300                  ELSE                                            00191800
250400                      MOVE '1'        TO PROD-C                   00191900
250500                  END-IF                                          00192000
250600               END-IF                                             00192100
250700            END-IF                                                00192200
250800         END-IF                                                   00192300
250900         MOVE PRODUCTION-DATE         TO EXV-F-REQ-PROD-YY-MM     00192400
251000      END-IF.                                                     00192500
251100/                                                                 00192600
251200 3700-READ-DESC.                                                  00192700
251300***************************************************************   00192800
251400*                                                             *   00192900
251500*  DESCRIPTION:   READ EVSDESC TO VERIFY USOB STATUS CODE     *   00193000
251600*                                                             *   00193100
251700***************************************************************   00193200
251800                                                                  00193300
251900*  THE FOLLOWING WILL PRINT AN ERROR MESSAGE IF THE STATUS CODE   00193400
252000*  IS NOT ON OUR EVS DESCRIPTION FILE                             00193500
252100                                                                  00193600
252200     MOVE 'ST'                        TO EVS-DESC-KEY-GRP.        00193700
252300     MOVE UW-STATUS                   TO EVS-DESC-KEY-CODE.       00193800
252400     MOVE ZEROES                      TO WS-RECORD-CNT.           00193900
252500                                                                  00194000
252600     PERFORM 7700-READ-DESC-FILE.                                 00194100
252700                                                                  00194200
252800     PERFORM 3750-CHECK-COUNT.                                    00194300
252900/                                                                 00194400
253000 3750-CHECK-COUNT.                                                00194500
253100***************************************************************   00194600
253200*                                                             *   00194700
253300*  DESCRIPTION:   CHECK WS-RECORD-CNT FOR VALUE OF 1.         *   00194800
253400*                                                             *   00194900
253500***************************************************************   00195000
253600      IF WS-RECORD-CNT = 1                                        00195100
253700          CONTINUE                                                00195200
253800      ELSE                                                        00195300
253900          MOVE 'INVALID STATUS CODE'  TO AUDIT-MESSAGE            00195400
254000          MOVE SPACES                 TO AUDIT-COUNT              00195500
254100          MOVE UW-STATUS              TO AUDIT-COUNT1             00195600
254200          MOVE 'RECORD KEY IS'        TO AUDIT-COUNT2             00195700
254300          STRING EXV-S-1-MODEL-YR, EXV-S-1-KEY DELIMITED          00195800
254400             BY SIZE INTO AUDIT-COUNT3                            00195900
254500          MOVE AUDIT-DETAIL           TO AUDIT-RECORD             00196000
254600          MOVE ADVANCE-LINE1          TO AUDIT-CC                 00196100
254700          PERFORM 8100-WRITE-AUDIT-RECORD                         00196200
254800          PERFORM 8200-CHECK-LINE-CNT                             00196300
254900          MOVE TEMP-KEY-FOR-AUDIT-RPT TO RPT-MY-DLR-BDY-ORD       00196400
255000          MOVE SPACES                 TO RPT-WMI-MY-PLT-SER       00196500
255100          MOVE UW-STATUS              TO RPT-ERROR-CONDITION      00196600
255200          MOVE 'INVALID STATUS CODE'  TO RPT-MESSAGE              00196700
255300          MOVE REPORT-DETAIL          TO REPORT-RECORD            00196800
255400          MOVE ADVANCE-LINE1          TO REPORT-CC                00196900
255500          PERFORM 8400-WRITE-REPORT-RECORD                        00197000
255600          ADD +1                      TO LINE-CNT                 00197100
255700          MOVE 'Y'                    TO REPORT-SWITCH.           00197200
255800/                                                                 00197300
255900 3800-BLD-EVS-MVMA-IND.                                           00197400
256000**************************************************************    00197500
256100*                                                            *    00197600
256200*  DESCRIPTION:  BUILD THE NEW EVS MASTER FILE               *    00197700
256300*                                                            *    00197800
256400**************************************************************    00197900
256500                                                                  00198000
256600      MOVE CDDB-S-COUNTRY             TO EXV-F-MVMA-COUNTRY-CODE. 00198100
256700      MOVE CDDB-P-DLR                 TO WS-CDDB-S-DLR.           00198200
256800                                                                  00198300
256900*  THE FOLLOWING IF STATEMENT IS USED FOR A RECORD THAT IS        00198400
257000*  BEING UPDATED.  IT VERIFIES THAT THE DEALER NAME MUST BE BLANK,00198500
257100*  SO THAT THE DEALER NAME WILL NOT BE OVER WRITTEN.              00198600
257200                                                                  00198700
257300      IF EXV-F-DEALER-NAME = SPACES                               00198800
257400         MOVE CDDB-DLR-NAME           TO EXV-F-DEALER-NAME.       00198900
257500                                                                  00199000
257600*  THE FOLLOWING CHECKS FOR FLEET VEHICLES AND PLACES A 'Y' IN    00199100
257700*  THE FLEET INDICATOR                                            00199200
257800                                                                  00199300
257900      IF CDDB-P-DIST = '9L'                                       00199400
258000         MOVE 'Y'                     TO EXV-F-FLEET-IND.         00199500
258100                                                                  00199600
258200*  THE FOLLOWING CHECKS FOR EUROPEAN VEHICLES AND PLACES A 'Y' IN 00199700
258300*  THE EXV-F-EUROPEAN-IND                                         00199800
258400                                                                  00199900
258500      IF (CDDB-P-DIST = '9G' OR '9J')                             00200000
258600      OR (EXV-U-VO-70-71 = '9G' OR '9J')                          00200100
258700      OR (EXV-U-VO-70-75 = '9EB125')                              00200200
258800         ADD 1                        TO EUROPEAN-IND-CNT         00200300
258900         MOVE 'Y'                     TO EXV-F-EUROPEAN-IND.      00200400
259000/                                                                 00200500
259100 6000-WRITE-CNTL-FILE.                                            00200600
259200****************************************************************  00200700
259300*                                                              *  00200800
259400*  DESCRIPTION:  WRITE CONTROL FILE                            *  00200900
259500*                                                              *  00201000
259600****************************************************************  00201100
259700                                                                  00201200
259800      ACCEPT TODAYS-DATE FROM DATE.                               00201300
259900      MOVE TODAYS-DATE                TO CR-DATE-UPDATED.         00201400
260000                                                                  00201500
260100      ACCEPT TODAYS-TIME FROM TIME.                               00201600
260200      MOVE TODAYS-TIME                TO CR-TIME-UPDATED.         00201700
260300                                                                  00201800
260400      MOVE WS-CONTROL-NUMBER          TO CR-CONTROL-NUMBER.       00201900
260500      MOVE 'EXVS100'                  TO CR-PROGRAM-NAME.         00202000
260600                                                                  00202100
260700      MOVE 'CONTROL RECORD OUT'       TO AUDIT-MESSAGE.           00202200
260800      MOVE ' = '                      TO AUDIT-SEP.               00202300
260900      MOVE CONTROL-RECORD             TO AUDIT-COUNT.             00202400
261000      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00202500
261100      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00202600
261200      PERFORM 8100-WRITE-AUDIT-RECORD.                            00202700
261300/                                                                 00202800
261400 7200-INSERT-EVSMSTR.                                             00202900
261500***************************************************************** 00203000
261600*                                                               * 00203100
261700*   DESCRIPTION:  INSERT ROW INTO MEXA001MSTR                   * 00203200
261800*                                                               * 00203300
261900***************************************************************** 00203400
262000                                                                  00203500
262100     EXEC SQL                                                     00203600
262200          INSERT INTO MEXA001MSTR                                 00203700
262300               (EVS_S_MODEL_YR                  ,                 00203800
262400                EVS_P_CONTROL_NO                ,                 00203900
262500                EVS_S_DIST                      ,                 00204000
262600                EVS_S_DLR                       ,                 00204100
262700                EVS_S_BODY                      ,                 00204200
262800                EVS_S_ITEM                      ,                 00204300
262900                EVS_S_WMI                       ,                 00204400
263000                EVS_S_PLANT                     ,                 00204500
263100                EVS_S_SERIAL                    ,                 00204600
263200                EVS_S_STATUS_CODE               ,                 00204700
263300                EVS_S_STATUS_DATE               ,                 00204800
263400                EVS_U_DIV_CODE                  ,                 00204900
263500                EVS_U_ORIG_ORD_DIS              ,                 00205000
263600                EVS_U_ORIG_ORD_DLR              ,                 00205100
263700                EVS_U_VO_IMAGE                  ,                 00205200
263800                EVS_U_ORIG_ORD_TYP              ,                 00205300
263900                EVS_U_BAO_VEH_LINE              ,                 00205400
264000                EVS_U_MSA_PRC_DT                ,                 00205500
264100                EVS_U_MSA_REC_DT                ,                 00205600
264200                EVS_U_SCHED_DT                  ,                 00205700
264300                EVS_U_SEG_DATE                  ,                 00205800
264400                EVS_U_SPEC_CHG_DT               ,                 00205900
264500                EVS_U_DSO_PLT_DT                ,                 00206000
264600                EVS_U_COMB_ERR_IND              ,                 00206100
264700                EVS_U_DSO_PTO_IND               ,                 00206200
264800                EVS_U_ERR_LVL_IND               ,                 00206300
264900                EVS_U_PROD_H_IND                ,                 00206400
265000                EVS_U_PLT_SUB_IND               ,                 00206500
265100                EVS_U_REV_DORA_IND              ,                 00206600
265200                EVS_U_DORA_GEN_IND              ,                 00206700
265300                EVS_U_COMP_ERR_IND              ,                 00206800
265400                EVS_U_DSO_ORD_QTY               ,                 00206900
265500                EVS_U_DORA_VALUE                ,                 00207000
265600                EVS_F_REQ_PROD_YM               ,                 00207100
265700                EVS_F_FLEET_IND                 ,                 00207200
265800                EVS_F_FLT_RTK_IND               ,                 00207300
265900                EVS_F_DEALER_NAME               ,                 00207400
266000                EVS_F_MVMA_CNTY_CD              ,                 00207500
266100                EVS_F_FIES_PROD_PF              ,                 00207600
266200                EVS_F_FIES_PROD_SF              ,                 00207700
266300                EVS_F_EST_VALUE                 ,                 00207800
266400                EVS_F_CREATE_RC_DT              ,                 00207900
266500                EVS_F_EUROPEAN_IND              ,                 00208000
266600                EVS_TIMESTAMP_DATE              ,                 00208100
266700                EVS_TIMESTAMP_TIME)                               00208200
266800          VALUES                                                  00208300
266900               (:MEXA001MSTR.EVS-S-MODEL-YR     ,                 00208400
267000                :MEXA001MSTR.EVS-P-CONTROL-NO   ,                 00208500
267100                :MEXA001MSTR.EVS-S-DIST         ,                 00208600
267200                :MEXA001MSTR.EVS-S-DLR          ,                 00208700
267300                :MEXA001MSTR.EVS-S-BODY         ,                 00208800
267400                :MEXA001MSTR.EVS-S-ITEM         ,                 00208900
267500                :MEXA001MSTR.EVS-S-WMI          ,                 00209000
267600                :MEXA001MSTR.EVS-S-PLANT        ,                 00209100
267700                :MEXA001MSTR.EVS-S-SERIAL       ,                 00209200
267800                :MEXA001MSTR.EVS-S-STATUS-CODE  ,                 00209300
267900                :MEXA001MSTR.EVS-S-STATUS-DATE  ,                 00209400
268000                :MEXA001MSTR.EVS-U-DIV-CODE     ,                 00209500
268100                :MEXA001MSTR.EVS-U-ORIG-ORD-DIS ,                 00209600
268200                :MEXA001MSTR.EVS-U-ORIG-ORD-DLR ,                 00209700
268300                :MEXA001MSTR.EVS-U-VO-IMAGE     ,                 00209800
268400                :MEXA001MSTR.EVS-U-ORIG-ORD-TYP ,                 00209900
268500                :MEXA001MSTR.EVS-U-BAO-VEH-LINE ,                 00210000
268600                :MEXA001MSTR.EVS-U-MSA-PRC-DT   ,                 00210100
268700                :MEXA001MSTR.EVS-U-MSA-REC-DT   ,                 00210200
268800                :MEXA001MSTR.EVS-U-SCHED-DT     ,                 00210300
268900                :MEXA001MSTR.EVS-U-SEG-DATE     ,                 00210400
269000                :MEXA001MSTR.EVS-U-SPEC-CHG-DT  ,                 00210500
269100                :MEXA001MSTR.EVS-U-DSO-PLT-DT   ,                 00210600
269200                :MEXA001MSTR.EVS-U-COMB-ERR-IND ,                 00210700
269300                :MEXA001MSTR.EVS-U-DSO-PTO-IND  ,                 00210800
269400                :MEXA001MSTR.EVS-U-ERR-LVL-IND  ,                 00210900
269500                :MEXA001MSTR.EVS-U-PROD-H-IND   ,                 00211000
269600                :MEXA001MSTR.EVS-U-PLT-SUB-IND  ,                 00211100
269700                :MEXA001MSTR.EVS-U-REV-DORA-IND ,                 00211200
269800                :MEXA001MSTR.EVS-U-DORA-GEN-IND ,                 00211300
269900                :MEXA001MSTR.EVS-U-COMP-ERR-IND ,                 00211400
270000                :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                 00211500
270100                :MEXA001MSTR.EVS-U-DORA-VALUE   ,                 00211600
270200                :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                 00211700
270300                :MEXA001MSTR.EVS-F-FLEET-IND    ,                 00211800
270400                :MEXA001MSTR.EVS-F-FLT-RTK-IND  ,                 00211900
270500                :MEXA001MSTR.EVS-F-DEALER-NAME  ,                 00212000
270600                :MEXA001MSTR.EVS-F-MVMA-CNTY-CD ,                 00212100
270700                :MEXA001MSTR.EVS-F-FIES-PROD-PF ,                 00212200
270800                :MEXA001MSTR.EVS-F-FIES-PROD-SF ,                 00212300
270900                :MEXA001MSTR.EVS-F-EST-VALUE    ,                 00212400
271000                :MEXA001MSTR.EVS-F-CREATE-RC-DT ,                 00212500
271100                :MEXA001MSTR.EVS-F-EUROPEAN-IND ,                 00212600
271200                :MEXA001MSTR.EVS-TIMESTAMP-DATE ,                 00212700
271300                :MEXA001MSTR.EVS-TIMESTAMP-TIME)                  00212800
271400     END-EXEC.                                                    00212900
271500                                                                  00213000
271600     EVALUATE SQLCODE                                             00213100
271700        WHEN ZEROS                                                00213200
271800           ADD +1                     TO EVS-REC-CREATED          00213300
271900           ADD +1                     TO CNT-CHECKPOINT           00213400
272000        WHEN -803                                                 00213500
272100****************************************************************  00213600
272200*  THE -803 IS CHECKED SO THAT IF A DUPLICATE KEY CONDITION       00213700
272300*  OCCURS WHEN INSERTING A ROW INTO MEXA001MSTR, THE KEYS WILL    00213800
272400*  BE DISPLAYED FOR EASE OF DEBUGGING.                            00213900
272500****************************************************************  00214000
272600           MOVE 'ERROR ADDING EXV RECORD' TO AUDIT-MESSAGE        00214100
272700           MOVE EXV-P-CONTROL-NO      TO AUDIT-COUNT              00214200
272800           MOVE UW-VO-4               TO TKA-MODEL-YR             00214300
272900           MOVE UW-DIST               TO TKA-DIST                 00214400
273000           MOVE UW-DLR                TO TKA-DLR                  00214500
273100           MOVE UW-VO-1-3             TO TKA-BODY                 00214600
273200           MOVE UW-ITEM               TO TKA-ORDER                00214700
273300           MOVE TEMP-KEY-FOR-AUDIT-RPT TO AUDIT-COUNT1            00214800
273400           MOVE SQLCODE               TO EDIT-SQLCODE             00214900
273500           MOVE EDIT-SQLCODE-R        TO AUDIT-COUNT2             00215000
273600           MOVE '7200-INSERT-EVSMSTR' TO AUDIT-COUNT3             00215100
273700           MOVE 'TE'                  TO AUDIT-COUNT4             00215200
273800           MOVE AUDIT-DETAIL          TO AUDIT-RECORD             00215300
273900           MOVE ADVANCE-LINE2         TO AUDIT-CC                 00215400
274000           PERFORM 8100-WRITE-AUDIT-RECORD                        00215500
274100       WHEN OTHER                                                 00215600
274200           MOVE EVS-S-MODEL-YR        TO ERR-S-MODEL-YR           00215700
274300           MOVE EVS-S-DIST            TO ERR-S-DIST               00215800
274400           MOVE EVS-S-DLR             TO ERR-S-DLR                00215900
274500           MOVE EVS-S-BODY            TO ERR-S-BODY               00216000
274600           MOVE EVS-S-ITEM            TO ERR-S-ITEM               00216100
274700           MOVE SQLCODE               TO EDIT-SQLCODE             00216200
274800           MOVE '7200-INSERT-EVSMSTR' TO ERR-ABEND-PARA           00216300
274900           MOVE SPACES                TO ERR-ABEND-CODE           00216400
275000           MOVE 'INSERT'              TO ERR-FUNCTION-CALL        00216500
275100           MOVE SPACES                TO ERR-SEG-NAME             00216600
275200           MOVE 'EXVS100'             TO ERR-PROG-NAME            00216700
275300           MOVE 'MEXA001MSTR'         TO ERR-TABLE-NAME           00216800
275400           MOVE EDIT-SQLCODE-R        TO ERR-SQLCODE              00216900
275500           PERFORM 9999-ABEND                                     00217000
275600      END-EVALUATE.                                               00217100
275700/                                                                 00217200
275800 7300-UPDATE-EVSMSTR.                                             00217300
275900***************************************************************** 00217400
276000*                                                               * 00217500
276100*  DESCRIPTION:  UPDATE ROW IN MEXA001MSTR                      * 00217600
276200*                                                               * 00217700
276300***************************************************************** 00217800
276400                                                                  00217900
276500     EXEC SQL                                                     00218000
276600          UPDATE  MEXA001MSTR                                     00218100
276700          SET                                                     00218200
276800       EVS_S_DIST               = :MEXA001MSTR.EVS-S-DIST       , 00218300
276900       EVS_S_DLR                = :MEXA001MSTR.EVS-S-DLR        , 00218400
277000       EVS_S_BODY               = :MEXA001MSTR.EVS-S-BODY       , 00218500
277100       EVS_S_ITEM               = :MEXA001MSTR.EVS-S-ITEM       , 00218600
277200       EVS_S_WMI                = :MEXA001MSTR.EVS-S-WMI        , 00218700
277300       EVS_S_PLANT              = :MEXA001MSTR.EVS-S-PLANT      , 00218800
277400       EVS_S_SERIAL             = :MEXA001MSTR.EVS-S-SERIAL     , 00218900
277500       EVS_S_STATUS_CODE        = :MEXA001MSTR.EVS-S-STATUS-CODE, 00219000
277600       EVS_S_STATUS_DATE        = :MEXA001MSTR.EVS-S-STATUS-DATE, 00219100
277700       EVS_U_DIV_CODE           = :MEXA001MSTR.EVS-U-DIV-CODE   , 00219200
277800       EVS_U_ORIG_ORD_DIS       = :MEXA001MSTR.EVS-U-ORIG-ORD-DIS,00219300
277900       EVS_U_ORIG_ORD_DLR       = :MEXA001MSTR.EVS-U-ORIG-ORD-DLR,00219400
278000       EVS_U_VO_IMAGE           = :MEXA001MSTR.EVS-U-VO-IMAGE    ,00219500
278100       EVS_U_ORIG_ORD_TYP       = :MEXA001MSTR.EVS-U-ORIG-ORD-TYP,00219600
278200       EVS_U_BAO_VEH_LINE       = :MEXA001MSTR.EVS-U-BAO-VEH-LINE,00219700
278300       EVS_U_MSA_PRC_DT         = :MEXA001MSTR.EVS-U-MSA-PRC-DT  ,00219800
278400       EVS_U_MSA_REC_DT         = :MEXA001MSTR.EVS-U-MSA-REC-DT  ,00219900
278500       EVS_U_SCHED_DT           = :MEXA001MSTR.EVS-U-SCHED-DT    ,00220000
278600       EVS_U_SEG_DATE           = :MEXA001MSTR.EVS-U-SEG-DATE    ,00220100
278700       EVS_U_SPEC_CHG_DT        = :MEXA001MSTR.EVS-U-SPEC-CHG-DT ,00220200
278800       EVS_U_DSO_PLT_DT         = :MEXA001MSTR.EVS-U-DSO-PLT-DT  ,00220300
278900       EVS_U_COMB_ERR_IND       = :MEXA001MSTR.EVS-U-COMB-ERR-IND,00220400
279000       EVS_U_DSO_PTO_IND        = :MEXA001MSTR.EVS-U-DSO-PTO-IND ,00220500
279100       EVS_U_ERR_LVL_IND        = :MEXA001MSTR.EVS-U-ERR-LVL-IND ,00220600
279200       EVS_U_PROD_H_IND         = :MEXA001MSTR.EVS-U-PROD-H-IND  ,00220700
279300       EVS_U_PLT_SUB_IND        = :MEXA001MSTR.EVS-U-PLT-SUB-IND ,00220800
279400       EVS_U_REV_DORA_IND       = :MEXA001MSTR.EVS-U-REV-DORA-IND,00220900
279500       EVS_U_DORA_GEN_IND       = :MEXA001MSTR.EVS-U-DORA-GEN-IND,00221000
279600       EVS_U_COMP_ERR_IND       = :MEXA001MSTR.EVS-U-COMP-ERR-IND,00221100
279700       EVS_U_DSO_ORD_QTY        = :MEXA001MSTR.EVS-U-DSO-ORD-QTY ,00221200
279800       EVS_U_DORA_VALUE         = :MEXA001MSTR.EVS-U-DORA-VALUE  ,00221300
279900       EVS_F_REQ_PROD_YM        = :MEXA001MSTR.EVS-F-REQ-PROD-YM ,00221400
280000       EVS_F_FLEET_IND          = :MEXA001MSTR.EVS-F-FLEET-IND   ,00221500
280100       EVS_F_FLT_RTK_IND        = :MEXA001MSTR.EVS-F-FLT-RTK-IND ,00221600
280200       EVS_F_DEALER_NAME        = :MEXA001MSTR.EVS-F-DEALER-NAME ,00221700
280300       EVS_F_MVMA_CNTY_CD       = :MEXA001MSTR.EVS-F-MVMA-CNTY-CD,00221800
280400       EVS_F_FIES_PROD_PF       = :MEXA001MSTR.EVS-F-FIES-PROD-PF,00221900
280500       EVS_F_FIES_PROD_SF       = :MEXA001MSTR.EVS-F-FIES-PROD-SF,00222000
280600       EVS_F_EST_VALUE          = :MEXA001MSTR.EVS-F-EST-VALUE   ,00222100
280700       EVS_F_CREATE_RC_DT       = :MEXA001MSTR.EVS-F-CREATE-RC-DT,00222200
280800       EVS_F_EUROPEAN_IND       = :MEXA001MSTR.EVS-F-EUROPEAN-IND,00222300
280900       EVS_TIMESTAMP_DATE       = :MEXA001MSTR.EVS-TIMESTAMP-DATE,00222400
281000       EVS_TIMESTAMP_TIME       = :MEXA001MSTR.EVS-TIMESTAMP-TIME 00222500
281100          WHERE                                                   00222600
281200            EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR       00222700
281300       AND  EVS_P_CONTROL_NO  = :MEXA001MSTR.EVS-P-CONTROL-NO     00222800
281400     END-EXEC.                                                    00222900
281500                                                                  00223000
281600     EVALUATE SQLCODE                                             00223100
281700        WHEN ZEROS                                                00223200
281800           ADD +1                     TO EVS-REC-UPDATED          00223300
281900           ADD +1                     TO CNT-CHECKPOINT           00223400
282000        WHEN OTHER                                                00223500
282100           MOVE EVS-S-MODEL-YR        TO ERR-S-MODEL-YR           00223600
282200           MOVE EVS-S-DIST            TO ERR-S-DIST               00223700
282300           MOVE EVS-S-DLR             TO ERR-S-DLR                00223800
282400           MOVE EVS-S-BODY            TO ERR-S-BODY               00223900
282500           MOVE EVS-S-ITEM            TO ERR-S-ITEM               00224000
282600           MOVE SQLCODE               TO EDIT-SQLCODE             00224100
282700           MOVE '7300-UPDATE-EVSMSTR' TO ERR-ABEND-PARA           00224200
282800           MOVE SPACES                TO ERR-ABEND-CODE           00224300
282900           MOVE 'UPDATE'              TO ERR-FUNCTION-CALL        00224400
283000           MOVE SPACES                TO ERR-SEG-NAME             00224500
283100           MOVE 'EXVS100'             TO ERR-PROG-NAME            00224600
283200           MOVE 'MEXA001MSTR'         TO ERR-TABLE-NAME           00224700
283300           MOVE EDIT-SQLCODE-R        TO ERR-SQLCODE              00224800
283400           PERFORM 9999-ABEND                                     00224900
283500     END-EVALUATE.                                                00225000
283600/                                                                 00225100
283700 7500-READ-BODY-FILE.                                             00225200
283800***************************************************************** 00225300
283900*                                                               * 00225400
284000*  DESCRIPTION:  SELECT ROW FROM MEXA003BODY                    * 00225500
284100*                                                               * 00225600
284200***************************************************************** 00225700
284300                                                                  00225800
284400     EXEC SQL                                                     00225900
284500          SELECT   EVS_BODY_F_PROD_CD          ,                  00226000
284600                   EVS_BODY_EST_VAL                               00226100
284700          INTO  :MEXA003BODY.EVS-BODY-F-PROD-CD ,                 00226200
284800                :MEXA003BODY.EVS-BODY-EST-VAL                     00226300
284900          FROM                                                    00226400
285000                MEXA003BODY                                       00226500
285100          WHERE                                                   00226600
285200             EVS_BODY_MODEL_YR = :MEXA003BODY.EVS-BODY-MODEL-YR   00226700
285300      AND    EVS_BODY_TYPE = :MEXA003BODY.EVS-BODY-TYPE           00226800
285400     END-EXEC.                                                    00226900
285500                                                                  00227000
285600     EVALUATE SQLCODE                                             00227100
285700        WHEN ZEROS                                                00227200
285800            MOVE EVS-BODY-F-PROD-CD   TO EXV-F-FIES-PROD-CODE     00227300
285900            MOVE EVS-BODY-EST-VAL     TO EXV-F-ESTIMATED-VALUE    00227400
286000        WHEN +100                                                 00227500
286100            MOVE SPACES               TO EXV-F-FIES-PROD-CODE     00227600
286200            MOVE ZEROES               TO EXV-F-ESTIMATED-VALUE    00227700
286300            MOVE SPACES               TO AUDIT-COUNT              00227800
286400            MOVE 'BODY TYPE NOT FOUND' TO AUDIT-MESSAGE           00227900
286500            MOVE UW-VO-1-4            TO AUDIT-COUNT1             00228000
286600            MOVE 'VEHICLE ID'         TO AUDIT-COUNT2             00228100
286700            MOVE UW-VO-4              TO TKA-MODEL-YR             00228200
286800            MOVE UW-DIST              TO TKA-DIST                 00228300
286900            MOVE UW-DLR               TO TKA-DLR                  00228400
287000            MOVE UW-VO-1-3            TO TKA-BODY                 00228500
287100            MOVE UW-ITEM              TO TKA-ORDER                00228600
287200            MOVE TEMP-KEY-FOR-AUDIT-RPT TO AUDIT-COUNT3           00228700
287300            MOVE AUDIT-DETAIL         TO AUDIT-RECORD             00228800
287400            MOVE ADVANCE-LINE2        TO AUDIT-CC                 00228900
287500            PERFORM 8100-WRITE-AUDIT-RECORD                       00229000
287600            PERFORM 8200-CHECK-LINE-CNT                           00229100
287700            MOVE TEMP-KEY-FOR-AUDIT-RPT TO RPT-MY-DLR-BDY-ORD     00229200
287800            MOVE SPACES               TO RPT-WMI-MY-PLT-SER       00229300
287900            MOVE UW-VO-1-4            TO RPT-ERROR-CONDITION      00229400
288000            MOVE 'BODY TYPE NOT FOUND IN EVS BODY FILE'           00229500
288100                                      TO RPT-MESSAGE              00229600
288200            MOVE REPORT-DETAIL        TO REPORT-RECORD            00229700
288300            MOVE ADVANCE-LINE1        TO REPORT-CC                00229800
288400            PERFORM 8400-WRITE-REPORT-RECORD                      00229900
288500            ADD +1                    TO LINE-CNT                 00230000
288600            MOVE 'Y'                  TO REPORT-SWITCH            00230100
288700        WHEN OTHER                                                00230200
288800            MOVE  SQLCODE             TO  EDIT-SQLCODE            00230300
288900            MOVE  '7500-READ-BODY-FILE' TO ERR-ABEND-PARA         00230400
289000            MOVE  SPACES              TO  ERR-ABEND-CODE          00230500
289100            MOVE  'SELECT'            TO  ERR-FUNCTION-CALL       00230600
289200            MOVE  SPACES              TO  ERR-SEG-NAME            00230700
289300            MOVE  'EXVS100'           TO  ERR-PROG-NAME           00230800
289400            MOVE  'MEXA003BODY'       TO  ERR-TABLE-NAME          00230900
289500            MOVE  EDIT-SQLCODE-R      TO  ERR-SQLCODE             00231000
289600            PERFORM 9999-ABEND                                    00231100
289700      END-EVALUATE.                                               00231200
289800/                                                                 00231300
289900 7600-READ-CDDB-FILE.                                             00231400
290000***************************************************************** 00231500
290100*                                                               * 00231600
290200*  DESCRIPTION:  SELECT ROW FROM MEXA012CDDB                    * 00231700
290300*                                                               * 00231800
290400***************************************************************** 00231900
290500                                                                  00232000
290600     EXEC SQL                                                     00232100
290700             SELECT                                               00232200
290800                 CDDB_DLR_NAME         ,                          00232300
290900                 CDDB_S_COUNTRY                                   00232400
291000             INTO                                                 00232500
291100                :MEXA012CDDB.CDDB-DLR-NAME       ,                00232600
291200                :MEXA012CDDB.CDDB-S-COUNTRY                       00232700
291300             FROM                                                 00232800
291400                       MEXA012CDDB                                00232900
291500             WHERE                                                00233000
291600                CDDB_P_DIV  = :MEXA012CDDB.CDDB-P-DIV             00233100
291700         AND    CDDB_P_DIST = :MEXA012CDDB.CDDB-P-DIST            00233200
291800         AND    CDDB_P_DLR  = :MEXA012CDDB.CDDB-P-DLR             00233300
291900     END-EXEC.                                                    00233400
292000/                                                                 00233500
292100 7700-READ-DESC-FILE.                                             00233600
292200***************************************************************** 00233700
292300*                                                               * 00233800
292400*  DESCRIPTION:  SELECT ROW FROM MEXA002DESC                    * 00233900
292500*                                                               * 00234000
292600***************************************************************** 00234100
292700                                                                  00234200
292800     EXEC SQL                                                     00234300
292900          SELECT COUNT(*)                                         00234400
293000          INTO                                                    00234500
293100                :WS-RECORD-CNT                                    00234600
293200          FROM                                                    00234700
293300                 MEXA002DESC                                      00234800
293400          WHERE                                                   00234900
293500             EVS_DESC_KEY_GRP  = :MEXA002DESC.EVS-DESC-KEY-GRP    00235000
293600      AND    EVS_DESC_KEY_CODE = :MEXA002DESC.EVS-DESC-KEY-CODE   00235100
293700     END-EXEC.                                                    00235200
293800                                                                  00235300
293900     EVALUATE SQLCODE                                             00235400
294000       WHEN ZEROS                                                 00235500
294100            CONTINUE                                              00235600
294200       WHEN OTHER                                                 00235700
294300            MOVE  SQLCODE             TO EDIT-SQLCODE             00235800
294400            MOVE  '7700-READ-DESC-FILE' TO ERR-ABEND-PARA         00235900
294500            MOVE  SPACES              TO ERR-ABEND-CODE           00236000
294600            MOVE  'SELECT'            TO ERR-FUNCTION-CALL        00236100
294700            MOVE  SPACES              TO ERR-SEG-NAME             00236200
294800            MOVE  'EXVS100'           TO ERR-PROG-NAME            00236300
294900            MOVE 'MEXA002DESC'        TO ERR-TABLE-NAME           00236400
295000            MOVE  EDIT-SQLCODE-R      TO ERR-SQLCODE              00236500
295100            PERFORM 9999-ABEND                                    00236600
295200      END-EVALUATE.                                               00236700
295300/                                                                 00236800
295400 8000-WRITE-AUDIT-REPORT.                                         00236900
295500***************************************************************** 00237000
295600*                                                               * 00237100
295700*  DESCRIPTION:  WRITE MAIN BODY OF AUDIT REPORT                * 00237200
295800*                                                               * 00237300
295900***************************************************************** 00237400
296000                                                                  00237500
296100      MOVE 'USOB RECORDS READ'        TO AUDIT-MESSAGE.           00237600
296200      MOVE ' = '                      TO AUDIT-SEP.               00237700
296300      MOVE USOB-REC-IN-CNT            TO AUDIT-COUNT.             00237800
296400      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00237900
296500      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00238000
296600      PERFORM 8100-WRITE-AUDIT-RECORD.                            00238100
296700                                                                  00238200
296800      MOVE 'USOB ERRORS      '        TO AUDIT-MESSAGE.           00238300
296900      MOVE ' = '                      TO AUDIT-SEP.               00238400
297000      MOVE USOB-ERROR-CNT             TO AUDIT-COUNT.             00238500
297100      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00238600
297200      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00238700
297300      PERFORM 8100-WRITE-AUDIT-RECORD.                            00238800
297400                                                                  00238900
297500      MOVE 'EVS RECORDS UPDATED'      TO AUDIT-MESSAGE.           00239000
297600      MOVE EVS-REC-UPDATED            TO AUDIT-COUNT.             00239100
297700      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00239200
297800      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00239300
297900      PERFORM 8100-WRITE-AUDIT-RECORD.                            00239400
298000                                                                  00239500
298100      MOVE 'EVS RECORDS CREATED'      TO AUDIT-MESSAGE.           00239600
298200      MOVE EVS-REC-CREATED            TO AUDIT-COUNT.             00239700
298300      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00239800
298400      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00239900
298500      PERFORM 8100-WRITE-AUDIT-RECORD.                            00240000
298600                                                                  00240100
298700      MOVE 'USOB BYPASS/NAVIS UPDATES' TO AUDIT-MESSAGE.          00240200
298800      MOVE NAV-UPDATE-CNT             TO AUDIT-COUNT.             00240300
298900      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00240400
299000      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00240500
299100      PERFORM 8100-WRITE-AUDIT-RECORD.                            00240600
299200                                                                  00240700
299300      MOVE 'CANCEL RECS NOT WRITTEN  ' TO AUDIT-MESSAGE.          00240800
299400      MOVE CANCEL-REC-NO-WRITE        TO AUDIT-COUNT.             00240900
299500      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00241000
299600      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00241100
299700      PERFORM 8100-WRITE-AUDIT-RECORD.                            00241200
299800                                                                  00241210
299900      MOVE 'CANCEL RECS RE-ACTIVATED ' TO AUDIT-MESSAGE.          00241220
300000      MOVE CANCEL-REC-REACTIVE-CNT    TO AUDIT-COUNT.             00241230
300100      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00241240
300200      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00241250
300300      PERFORM 8100-WRITE-AUDIT-RECORD.                            00241260
300400                                                                  00241300
300500      MOVE 'EUROPEAN IND UPDATED    ' TO AUDIT-MESSAGE.           00241400
300600      MOVE EUROPEAN-IND-CNT           TO AUDIT-COUNT.             00241500
300700      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00241600
300800      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00241700
300900      PERFORM 8100-WRITE-AUDIT-RECORD.                            00241800
301000                                                                  00241900
301100      MOVE 'DUPLICATE S2 KEYS FOUND ' TO AUDIT-MESSAGE.           00242000
301200      MOVE DUPLICATE-CNT              TO AUDIT-COUNT.             00242100
301300      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00242200
301400      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00242300
301500      PERFORM 8100-WRITE-AUDIT-RECORD.                            00242400
301600/                                                                 00242500
301700 8100-WRITE-AUDIT-RECORD.                                         00242600
301800***************************************************************** 00242700
301900*                                                               * 00242800
302000*  DESCRIPTION:  WRITE AUDIT REPORT RECORD                      * 00242900
302100*                                                               * 00243000
302200***************************************************************** 00243100
302300                                                                  00243200
302400     CALL 'CBLTDLI'   USING  ISRT                                 00243300
302500                             GSAM2-I-O-PCB                        00243400
302600                             AUDIT-DATA.                          00243500
302700                                                                  00243600
302800     EVALUATE GSAM2-I-O-STATUS                                    00243700
302900         WHEN SPACES                                              00243800
303000             CONTINUE                                             00243900
303100         WHEN OTHER                                               00244000
303200             PERFORM 10000-COREDUMP                               00244100
303300     END-EVALUATE.                                                00244200
303400/                                                                 00244300
303500 8200-CHECK-LINE-CNT.                                             00244400
303600***************************************************************** 00244500
303700*                                                               * 00244600
303800*  DESCRIPTION:  CHECKS FOR NEW PAGE                            * 00244700
303900*                                                               * 00244800
304000***************************************************************** 00244900
304100                                                                  00245000
304200     IF LINE-CNT > 60                                             00245100
304300         PERFORM 8300-WRITE-RPT-HEAD.                             00245200
304400/                                                                 00245300
304500 8300-WRITE-RPT-HEAD.                                             00245400
304600***************************************************************** 00245500
304700*                                                               * 00245600
304800*  DESCRIPTION:  WRITE THE REPORT HEADINGS                      * 00245700
304900*                                                               * 00245800
305000***************************************************************** 00245900
305100                                                                  00246000
305200      ADD 1                           TO PAGE-CNT.                00246100
305300      MOVE PAGE-CNT                   TO PAGE-NUMBER.             00246200
305400      MOVE REPORT-HEADING1            TO REPORT-RECORD.           00246300
305500      MOVE ADVANCE-TOP-OF-PAGE        TO REPORT-CC                00246400
305600      PERFORM 8400-WRITE-REPORT-RECORD.                           00246500
305700                                                                  00246600
305800      MOVE REPORT-HEADING2            TO REPORT-RECORD.           00246700
305900      MOVE ADVANCE-LINE1              TO REPORT-CC                00246800
306000      PERFORM 8400-WRITE-REPORT-RECORD.                           00246900
306100                                                                  00247000
306200      MOVE REPORT-HEADING2-5          TO REPORT-RECORD.           00247100
306300      MOVE ADVANCE-LINE1              TO REPORT-CC                00247200
306400      PERFORM 8400-WRITE-REPORT-RECORD.                           00247300
306500                                                                  00247400
306600      MOVE REPORT-HEADING3            TO REPORT-RECORD.           00247500
306700      MOVE ADVANCE-LINE2              TO REPORT-CC                00247600
306800      PERFORM 8400-WRITE-REPORT-RECORD.                           00247700
306900                                                                  00247800
307000      MOVE REPORT-HEADING4            TO REPORT-RECORD.           00247900
307100      MOVE ADVANCE-LINE1              TO REPORT-CC                00248000
307200      PERFORM 8400-WRITE-REPORT-RECORD.                           00248100
307300      MOVE 6                          TO LINE-CNT.                00248200
307400/                                                                 00248300
307500 8400-WRITE-REPORT-RECORD.                                        00248400
307600***************************************************************** 00248500
307700*                                                               * 00248600
307800*  DESCRIPTION:  WRITE REPORT RECORD                            * 00248700
307900*                                                               * 00248800
308000***************************************************************** 00248900
308100                                                                  00249000
308200     CALL 'CBLTDLI'   USING   ISRT                                00249100
308300                              GSAM3-I-O-PCB                       00249200
308400                              REPORT-DATA.                        00249300
308500                                                                  00249400
308600     EVALUATE GSAM3-I-O-STATUS                                    00249500
308700         WHEN SPACES                                              00249600
308800             CONTINUE                                             00249700
308900         WHEN OTHER                                               00249800
309000             MOVE '8400-WRITE-REPORT-RECORD'                      00249900
309100                                      TO ERR-ABEND-PARA           00250000
309200             MOVE  GSAM3-I-O-STATUS   TO ERR-ABEND-CODE           00250100
309300             MOVE  ISRT               TO ERR-FUNCTION-CALL        00250200
309400             MOVE  'I-O-PCB GSAM3'    TO ERR-SEG-NAME             00250300
309500             MOVE  'EXVS100'          TO ERR-PROG-NAME            00250400
309600             MOVE  SPACES             TO ERR-SQLCODE              00250500
309700             MOVE  SPACES             TO ERR-TABLE-NAME           00250600
309800             PERFORM 9999-ABEND                                   00250700
309900     END-EVALUATE.                                                00250800
310000/                                                                 00250900
310100 9900-EOJ.                                                        00251000
310200******************************************************************00251100
310300*                                                                *00251200
310400*  DESCRIPTION: WRITE END OF AUDIT REPORT AND CLOSE FILES        *00251300
310500*                                                                *00251400
310600******************************************************************00251500
310700                                                                  00251600
310800     PERFORM 8200-CHECK-LINE-CNT.                                 00251700
310900                                                                  00251800
311000     MOVE SPACES                  TO RPT-MY-DLR-BDY-ORD           00251900
311100                                     RPT-WMI-MY-PLT-SER           00252000
311200                                     RPT-ERROR-CONDITION.         00252100
311300                                                                  00252200
311400     IF REPORT-SWITCH = 'N'                                       00252300
311500         MOVE 'NO ERROR MESSAGES FOR TODAY'                       00252400
311600                                      TO RPT-MESSAGE              00252500
311700         MOVE REPORT-DETAIL           TO REPORT-RECORD            00252600
311800         MOVE ADVANCE-LINE2           TO REPORT-CC                00252700
311900         PERFORM 8400-WRITE-REPORT-RECORD                         00252800
312000     ELSE                                                         00252900
312100         MOVE '*** ALL ERRORS MUST BE CORRECTED IMMEDIATELY ***'  00253000
312200                                      TO RPT-MESSAGE              00253100
312300         MOVE REPORT-DETAIL           TO REPORT-RECORD            00253200
312400         MOVE ADVANCE-LINE2           TO REPORT-CC                00253300
312500         PERFORM 8400-WRITE-REPORT-RECORD.                        00253400
312600                                                                  00253500
312700     ACCEPT TODAYS-TIME FROM TIME.                                00253600
312800     MOVE TT-HH                       TO TT-PRINT-HH.             00253700
312900     MOVE TT-MM                       TO TT-PRINT-MM.             00253800
313000     MOVE TT-SS                       TO TT-PRINT-SS.             00253900
313100     MOVE 'PROGRAM COMPLETION TIME'   TO AUDIT-MESSAGE.           00254000
313200     MOVE ' = '                       TO AUDIT-SEP.               00254100
313300     MOVE TODAYS-TIME-PRINT           TO AUDIT-COUNT.             00254200
313400     MOVE AUDIT-DETAIL                TO AUDIT-RECORD.            00254300
313500     MOVE ADVANCE-LINE2               TO AUDIT-CC.                00254400
313600     PERFORM 8100-WRITE-AUDIT-RECORD.                             00254500
313700                                                                  00254600
313800     MOVE 'EXVS100 ENDED SUCCESSFULLY' TO AUDIT-MESSAGE.          00254700
313900     MOVE '   '                       TO AUDIT-SEP.               00254800
314000     MOVE SPACES                      TO AUDIT-COUNT.             00254900
314100     MOVE AUDIT-DETAIL                TO AUDIT-RECORD.            00255000
314200     MOVE ADVANCE-LINE2               TO AUDIT-CC.                00255100
314300     PERFORM 8100-WRITE-AUDIT-RECORD.                             00255200
314400     CLOSE PARMFILE.                                              00255300
314500/                                                                 00255400
314600 9920-ABORT-RUN.                                                  00255500
314700****************************************************************  00255600
314800*                                                              *  00255700
314900*  DESCRIPTION:  ABORT RUNS                                    *  00255800
315000*                                                              *  00255900
315100****************************************************************  00256000
315200                                                                  00256100
315300     PERFORM 8200-CHECK-LINE-CNT.                                 00256200
315400                                                                  00256300
315500     IF REPORT-SWITCH = 'N'                                       00256400
315600         MOVE SPACES                  TO RPT-MY-DLR-BDY-ORD       00256500
315700                                         RPT-WMI-MY-PLT-SER       00256600
315800                                         RPT-ERROR-CONDITION      00256700
315900         MOVE 'NO ERROR MESSAGES FOR TODAY'                       00256800
316000                                      TO RPT-MESSAGE              00256900
316100         MOVE REPORT-DETAIL           TO REPORT-RECORD            00257000
316200         MOVE ADVANCE-LINE2           TO REPORT-CC                00257100
316300         PERFORM 8400-WRITE-REPORT-RECORD                         00257200
316400     ELSE                                                         00257300
316500         MOVE '*** ALL ERRORS MUST BE CORRECTED IMMEDIATELY ***'  00257400
316600                                      TO RPT-MESSAGE              00257500
316700         MOVE REPORT-DETAIL           TO REPORT-RECORD            00257600
316800         MOVE ADVANCE-LINE2           TO REPORT-CC                00257700
316900         PERFORM 8400-WRITE-REPORT-RECORD.                        00257800
317000                                                                  00257900
317100*  THE FOLLOWING STATEMENT WAS ADDED TO MAKE SURE THE CONTROL     00258000
317200*  FILE IS UPDATED WHEN NEW RECORDS ARE ADDED TO THE EVSMSTR      00258100
317300*  AND THE PROGRAM ABORTS.                                        00258200
317400                                                                  00258300
317500     IF WS-CONTROL-NUMBER = ZEROS                                 00258400
317600        CONTINUE                                                  00258500
317700     ELSE                                                         00258600
317800        IF CR-CONTROL-NUMBER NOT = WS-CONTROL-NUMBER              00258700
317900           PERFORM 6000-WRITE-CNTL-FILE.                          00258800
318000                                                                  00258900
318100     MOVE SPACES                      TO AUDIT-MESSAGE.           00259000
318200     MOVE 'ABORTING RUN'              TO AUDIT-COUNT.             00259100
318300     MOVE AUDIT-DETAIL                TO AUDIT-RECORD.            00259200
318400     MOVE ADVANCE-LINE2               TO AUDIT-CC.                00259300
318500     PERFORM 8100-WRITE-AUDIT-RECORD.                             00259400
318600     PERFORM 10000-COREDUMP.                                      00259500
318700/                                                                 00259600
318800 9999-ABEND.                                                      00259700
318900***************************************************************** 00259800
319000*                                                               * 00259900
319100*  DESCRIPTION:  PERFORM WHEN ABNORMAL STATUS CODE RECEIVED     * 00260000
319200*                                                               * 00260100
319300***************************************************************** 00260200
319400                                                                  00260300
319500      MOVE SPACES                      TO AUDIT-DETAIL.           00260400
319600      MOVE 'ERROR ABEND PARAGRAPH    ' TO AUDIT-MESSAGE.          00260500
319700      MOVE ' = '                       TO AUDIT-SEP.              00260600
319800      MOVE ERR-ABEND-PARA              TO AUDIT-COUNT.            00260700
319900      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00260800
320000      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00260900
320100      PERFORM 8100-WRITE-AUDIT-RECORD.                            00261000
320200                                                                  00261100
320300      MOVE SPACES                      TO AUDIT-DETAIL.           00261200
320400      MOVE 'ERROR ABEND CODE         ' TO AUDIT-MESSAGE.          00261300
320500      MOVE ' = '                       TO AUDIT-SEP.              00261400
320600      MOVE ERR-ABEND-CODE              TO AUDIT-COUNT.            00261500
320700      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00261600
320800      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00261700
320900      PERFORM 8100-WRITE-AUDIT-RECORD.                            00261800
321000                                                                  00261900
321100      MOVE SPACES                      TO AUDIT-DETAIL.           00262000
321200      MOVE 'ERROR FUNCTION           ' TO AUDIT-MESSAGE.          00262100
321300      MOVE ' = '                       TO AUDIT-SEP.              00262200
321400      MOVE ERR-FUNCTION-CALL           TO AUDIT-COUNT.            00262300
321500      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00262400
321600      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00262500
321700      PERFORM 8100-WRITE-AUDIT-RECORD.                            00262600
321800                                                                  00262700
321900      MOVE SPACES                      TO AUDIT-DETAIL.           00262800
322000      MOVE 'ERROR SEG NAME           ' TO AUDIT-MESSAGE.          00262900
322100      MOVE ' = '                       TO AUDIT-SEP.              00263000
322200      MOVE ERR-SEG-NAME                TO AUDIT-COUNT.            00263100
322300      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00263200
322400      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00263300
322500      PERFORM 8100-WRITE-AUDIT-RECORD.                            00263400
322600                                                                  00263500
322700      MOVE SPACES                      TO AUDIT-DETAIL.           00263600
322800      MOVE 'ERROR PROG NAME          ' TO AUDIT-MESSAGE.          00263700
322900      MOVE ' = '                       TO AUDIT-SEP.              00263800
323000      MOVE ERR-PROG-NAME               TO AUDIT-COUNT.            00263900
323100      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00264000
323200      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00264100
323300      PERFORM 8100-WRITE-AUDIT-RECORD.                            00264200
323400                                                                  00264300
323500      MOVE SPACES                      TO AUDIT-DETAIL.           00264400
323600      MOVE 'ERROR SQL CODE           ' TO AUDIT-MESSAGE.          00264500
323700      MOVE ' = '                       TO AUDIT-SEP.              00264600
323800      MOVE ERR-SQLCODE                 TO AUDIT-COUNT.            00264700
323900      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00264800
324000      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00264900
324100      PERFORM 8100-WRITE-AUDIT-RECORD.                            00265000
324200                                                                  00265100
324300      MOVE SPACES                      TO AUDIT-DETAIL.           00265200
324400      MOVE 'ERROR TABLE NAME         ' TO AUDIT-MESSAGE.          00265300
324500      MOVE ' = '                       TO AUDIT-SEP.              00265400
324600      MOVE ERR-TABLE-NAME              TO AUDIT-COUNT.            00265500
324700      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00265600
324800      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00265700
324900      PERFORM 8100-WRITE-AUDIT-RECORD.                            00265800
325000                                                                  00265900
325100      MOVE SPACES                      TO AUDIT-DETAIL.           00266000
325200      MOVE 'ERROR MYDISTDLRBODYITEM  ' TO AUDIT-MESSAGE.          00266100
325300      MOVE ' = '                       TO AUDIT-SEP.              00266200
325400      MOVE ERR-S-1-KEY                 TO AUDIT-COUNT.            00266300
325500      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00266400
325600      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00266500
325700      PERFORM 8100-WRITE-AUDIT-RECORD.                            00266600
325800      PERFORM 10000-COREDUMP.                                     00266700
325900/                                                                 00266800
326000 10000-COREDUMP.                                                  00533700
326100***************************************************************** 00533800
326200*                                                               * 00533900
326300*  DESCRIPTION:  CALLS COREDUMP                                 * 00534000
326400*                                                               * 00534100
326500***************************************************************** 00534200
326600                                                                  00534300
326700      CALL     'COREDUMP'.                                        00534400
326800*++INCLUDE PCPTSIMS3                                              00534500
326900 COPY CPTSIMS3.                                                         00
327000/                                                                 00534600
327100**************************************************************    00534700
327200 RESTART-LOGIC.                                                   00534800
327300     IF CHKP-NUMERIC > 1                                          00534900
327400        MOVE SAVE2-AREA               TO WS-SAVE-AREA-2           00535000
327500        MOVE ZEROS                    TO CNT-CHECKPOINT           00535100
327600     ELSE                                                         00535200
327700         MOVE SPACES                  TO XRST-ID                  00535300
327800     END-IF.                                                      00535400
