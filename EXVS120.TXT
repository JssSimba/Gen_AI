000100 IDENTIFICATION DIVISION.                                         00000100
000200 PROGRAM-ID.     EXVS120.                                         00000200
000300 AUTHOR.         CYNTHIA FORSYTH.                                 00000300
000400 DATE-WRITTEN.   JUNE 06, 1991.                                   00000400
000500 DATE-COMPILED.                                                   00000500
000600******************************************************************00000600
000700*                                                                *00000700
000800*  PROGRAM DESCRIPTION:   1.  READ THE TRAILER FILE TRANSMITTED  *00000800
000900*                             FROM CENTRAL ORDER BANK (COB).     *00000900
001000*                         2.  VERIFY THE TRAILER FILE WITH THE   *00001000
001100*                             EVS MASTER                         *00001100
001200*                         3.  CHECK THE TRAILER FILE FOR '06',   *00001200
001300*                             '11', '16', '19' RECORDS AND UPDATE*00001300
001400*                             THE EVS MASTER                     *00001400
001500*        PARMFILE IS PROVIDED TO ALLOW THE USER TO               *00001500
001600*        A. CHANGE THE FREQUENCY OF CHECKPOINTS (DEFAULT IS  10) *00001600
001700*        B. CAUSE THE PROGRAM TO RUN IN TEST MODE (DEF IS PROD)  *00001700
001800*                                                                 00001800
001900* MODIFIED: 9/12/91       SYNTEL                                  00001900
002000* REASON:  EDIT FOR NUMERIC PRODUCTION YY/MM.                     00002000
002100*          CHECK FOR DISTRICT 9E INSTEAD OF 90.                   00002100
002200*                                                                 00002200
002300* MODIFIED: 11/05/92      S. ORAM                                 00002300
002400* REASON:  STANDARDIZED FOR MARKETING SYSTEMS.  MODIFIED SQL      00002400
002500*          STATEMENTS AND MODIFIED CURSORS (ONLY 1 OPEN AND CLOSE)00002500
002600* MODIFIED:  03/10/94    C. VANLEW                                00002600
002700* REASON:    CHANGED LENGTH OF SOME REPORT HEADERS SO THEY DO NOT 00002700
002800*            EXCEED 132 CHARACTERS                                00002800
002900* MODIFIED:  09/16/94    M. CYROL                                 00002900
003000* REASON:    PROCESS TYPE '11' RECORDS FOR EAO ORBIT NUMBERS.     00003000
003100* MODIFIED:  12/14/94    M. CYROL                                 00003100
003200* REASON:    DON'T PROCESS ORBIT NUMBERS IF THEY'RE BLANKS.       00003200
003300* MODIFIED:  04/27/95    M. CYROL                                 00003300
003400* REASON:    ALLOW DUPLICATE ITEM NUMBERS TO COME INTO SYSTEM     00003400
003500*            IF ORIGINAL ITEM NUMBER IS 30 DAYS PAST PLANT RELEASE00003500
003600******************************************************************00003600
003700                                                                  00003700
003800 ENVIRONMENT DIVISION.                                            00003800
003900                                                                  00003900
004000 INPUT-OUTPUT SECTION.                                            00004000
004100 FILE-CONTROL.                                                    00004100
004200                                                                  00004200
004300     SELECT XRST-FILE             ASSIGN TO XRSTFILE.             00004300
004400                                                                  00004400
004500     SELECT PARMFILE              ASSIGN TO PARMFILE.             00004500
004600                                                                  00004600
004700 DATA DIVISION.                                                   00004700
004800 FILE SECTION.                                                    00004800
004900*********    CHECKPOINT / RESTART FILE                            00004900
005000 ++INCLUDE PCPIMS001                                              00005000
005100*********    END OF CHECKPOINT / RESTART FILE                     00005100
005200                                                                  00005200
005300 FD  PARMFILE                                                     00005300
005400         RECORD CONTAINS  80 CHARACTERS,                          00005400
005500         BLOCK CONTAINS 0 RECORDS.                                00005500
005600                                                                  00005600
005700 01  PARMREC.                                                     00005700
005800     05 CHECKPOINT-FREQUENCY          PIC 9(05).                  00005800
005900     05 FILLER                        PIC X.                      00005900
006000     05 RUN-MODE                      PIC X(4).                   00006000
006100     05 FILLER                        PIC X.                      00006100
006200     05 ABEND-LIT                     PIC X(10).                  00006200
006300     05 ABEND-LIM                     PIC 9(05).                  00006300
006400     05 FILLER                        PIC X(54).                  00006400
006500                                                                  00006500
006600 WORKING-STORAGE SECTION.                                         00006600
006700 77  PAN-VALET PICTURE X(24) VALUE '104PEXVS120  10/03/97'.       00006700
006710*                                                                 00006710
006720  COPY CB370W1.                                                   00006720
006730  COPY CB370W2.                                                   00006730
006740  COPY CB370W3.                                                   00006740
006750  COPY CB370W4.                                                   00006750
006760  COPY CB361W10.                                                  00006760
006770  COPY CB361C.                                                    00006770
006780*==> C-MILL FIX00M NO. 1 - INSERT 8 LINES                         00006780
006790  01  Y2K-WORK-DAY-TIME             PIC 9(15).                    00006790
006791  01  FILLER                    REDEFINES Y2K-WORK-DAY-TIME.      00006791
006792      10  Y2K-WORK-DAY              PIC 9(7).                     00006792
006793      10  Y2K-WORK-TIME             PIC 9(8).                     00006793
006794  01  Y2K-CHKP-DAY-TIME             PIC 9(15).                    00006794
006795  01  FILLER                    REDEFINES Y2K-CHKP-DAY-TIME.      00006795
006796      10  Y2K-CHKP-DAY              PIC 9(7).                     00006796
006797      10  Y2K-CHKP-TIME             PIC 9(8).                     00006797
006800***********   BEGINNING OF SAVE AREA 2 ******************         00006800
006900 01 WS-SAVE-AREA-2.                                               00006900
007000    05  TLR-REC-IN-CNT                PIC 9(06)  VALUE ZEROS.     00007000
007100    05  START-DATE                    PIC X(06)  VALUE SPACES.    00007100
007200    05  START-TIME                    PIC X(08)  VALUE SPACES.    00007200
007300    05  HOLD-TIMESTAMP                PIC X(26)  VALUE SPACES.    00007300
007400                                                                  00007400
007500    05  SWITCHES.                                                 00007500
007600        10  TLR-EOF                   PIC X(03)  VALUE 'NO '.     00007600
007700        10  REPORT-SWITCH             PIC X(01)  VALUE 'N'.       00007700
007800        10  INVALID-PROD-DATE         PIC X(01)  VALUE 'N'.       00007800
007900                                                                  00007900
008000    05  COUNTERS.                                                 00008000
008100        10  EVS-REC-NOT-FOUND         PIC 9(06)  VALUE ZEROS.     00008100
008200        10  EVS-REC-UPDATED           PIC 9(06)  VALUE ZEROS.     00008200
008300        10  LINE-CNT                  PIC 9(02)  VALUE 61.        00008300
008400        10  PAGE-CNT                  PIC 9(04)  VALUE ZEROS.     00008400
008500        10  RECORD-BYPASSED           PIC 9(06)  VALUE ZEROS.     00008500
008600        10  WS-EXTEND-UPDATE-CNT      PIC 9(06)  VALUE ZEROS.     00008600
008700        10  WS-EXTEND-INSERT-CNT      PIC 9(06)  VALUE ZEROS.     00008700
008800                                                                  00008800
008900    05  WS-PROD-CYYMM.                                            00008900
009000        10  WS-PROD-C                 PIC X(01)  VALUE SPACES.    00009000
009100        10  WS-PROD-YY                PIC X(02)  VALUE SPACES.    00009100
009200        10  WS-PROD-MM                PIC X(02)  VALUE SPACES.    00009200
009300                                                                  00009300
009400    05  TODAYS-DATE.                                              00009400
009500        10  TD-YY                     PIC X(02)  VALUE SPACES.    00009500
009600        10  TD-MM                     PIC X(02)  VALUE SPACES.    00009600
009700        10  TD-DD                     PIC X(02)  VALUE SPACES.    00009700
009800                                                                  00009800
009900    05  TODAYS-DATE-PRINT.                                        00009900
010000        10  TD-PRINT-MM               PIC X(02)  VALUE SPACES.    00010000
010100        10  FILLER                    PIC X(01)  VALUE '/'.       00010100
010200        10  TD-PRINT-DD               PIC X(02)  VALUE SPACES.    00010200
010300        10  FILLER                    PIC X(01)  VALUE '/'.       00010300
010400        10  TD-PRINT-YY               PIC X(02)  VALUE SPACES.    00010400
010500                                                                  00010500
010600    05  TODAYS-TIME.                                              00010600
010700        10  TT-HH                     PIC X(02)  VALUE SPACES.    00010700
010800        10  TT-MM                     PIC X(02)  VALUE SPACES.    00010800
010900        10  TT-SS                     PIC X(02)  VALUE SPACES.    00010900
011000        10  TT-HS                     PIC X(02)  VALUE SPACES.    00011000
011100                                                                  00011100
011200    05  TODAYS-TIME-PRINT.                                        00011200
011300        10  TT-PRINT-HH               PIC X(02)  VALUE SPACES.    00011300
011400        10  FILLER                    PIC X(01)  VALUE ':'.       00011400
011500        10  TT-PRINT-MM               PIC X(02)  VALUE SPACES.    00011500
011600        10  FILLER                    PIC X(01)  VALUE ':'.       00011600
011700        10  TT-PRINT-SS               PIC X(02)  VALUE SPACES.    00011700
011800                                                                  00011800
011900***********   END       OF SAVE AREA 2 ******************         00011900
012000                                                                  00012000
012100 01  WS-TW-TYPE                       PIC 9(04) VALUE ZEROS.      00012100
012200 01  TLR-RECORD                       PIC X(307).                 00012200
012300                                                                  00012300
012400 01  TLR-WORK.                                                    00012400
012500     05  TW-1.                                                    00012500
012600         10  TW-CONTROL.                                          00012600
012700             15  TW-MODEL-YR          PIC X(02)  VALUE SPACES.    00012700
012800             15  TW-DIV               PIC X(01)  VALUE SPACES.    00012800
012900             15  TW-DIST              PIC X(02)  VALUE SPACES.    00012900
013000             15  TW-DLR               PIC X(03)  VALUE SPACES.    00013000
013100             15  TW-BODY              PIC X(03)  VALUE SPACES.    00013100
013200             15  TW-ITEM-1-6.                                     00013200
013300                 20  TW-ITEM          PIC X(04)  VALUE SPACES.    00013300
013400                 20  TW-ITEM-5-6      PIC X(02)  VALUE SPACES.    00013400
013500             15  TW-TYPE              PIC S9(4) COMP VALUE ZEROS. 00013500
013600         10  FILLER                   PIC X(29)  VALUE SPACES.    00013600
013700         10  TW-MDL-YR                PIC X(01)  VALUE SPACES.    00013700
013800         10  TW-9270-VL               PIC X(01)  VALUE SPACES.    00013800
013900         10  FILLER                   PIC X(03)  VALUE SPACES.    00013900
014000         10  TW-DATA-1                PIC X(60)  VALUE SPACES.    00014000
014100         10  TW-06-DATA REDEFINES TW-DATA-1.                      00014100
014200             15  TW-06-SHIP-TO-DLR-DIV     PIC X(01).             00014200
014300             15  TW-06-SHIP-TO-DLR-DIST    PIC X(02).             00014300
014400             15  TW-06-SHIP-TO-DLR-DEALER  PIC X(03).             00014400
014500             15  TW-06-SHIP-TO-DLR-ZONE    PIC X(01).             00014500
014600             15  TW-06-SHIP-TO-DLR-NAME    PIC X(30).             00014600
014700             15  FILLER                    PIC X(23).             00014700
014800         10  TW-16-DATA REDEFINES TW-DATA-1.                      00014800
014900             15  TW-16-NOTE-PROD-YYMM.                            00014900
015000                 20  TW-16-NOTE-PROD-YY PIC X(02).                00015000
015100                 20  TW-16-NOTE-PROD-MM PIC X(02).                00015100
015200             15  FILLER               PIC X(56).                  00015200
015300         10  TW-19-DATA REDEFINES TW-DATA-1.                      00015300
015400             15  TW-19-DSO-UNITS      PIC 9(03).                  00015400
015500             15  FILLER               PIC X(57).                  00015500
015600     05  TW-2                         PIC X(120).                 00015600
015700     05  TW-11-DATA REDEFINES TW-2.                               00015700
015800         10  FILLER                   PIC X(22).                  00015800
015900         10  TW-11-ORBIT-NUM          PIC X(09).                  00015900
016000         10  FILLER                   PIC X(89).                  00016000
016100     05  TW-3                         PIC X(120).                 00016100
016200                                                                  00016200
016300 01  AUDIT-HEADER.                                                00016300
016400     05  FILLER                       PIC X(05)  VALUE SPACES.    00016400
016500     05  AUDIT-HEADING                PIC X(127) VALUE SPACES.    00016500
016600                                                                  00016600
016700 01  AUDIT-DETAIL.                                                00016700
016800     05  FILLER                       PIC X(05)  VALUE SPACES.    00016800
016900     05  AUDIT-MESSAGE                PIC X(26)  VALUE SPACES.    00016900
017000     05  AUDIT-SEP                    PIC X(03)  VALUE SPACES.    00017000
017100     05  AUDIT-COUNT.                                             00017100
017200         10  AUDIT-COUNT1             PIC X(20)  VALUE SPACES.    00017200
017300         10  AUDIT-COUNT2             PIC X(20)  VALUE SPACES.    00017300
017400         10  AUDIT-COUNT3             PIC X(20)  VALUE SPACES.    00017400
017500         10  AUDIT-COUNT4             PIC X(20)  VALUE SPACES.    00017500
017600         10  AUDIT-COUNT5             PIC X(18)  VALUE SPACES.    00017600
017700                                                                  00017700
017800 01  AUDIT-DATA.                                                  00017800
017900     05  AUDIT-CC                     PIC X(01).                  00017900
018000     05  AUDIT-RECORD                 PIC X(132).                 00018000
018100                                                                  00018100
018200 01  REPORT-DATA.                                                 00018200
018300     05  REPORT-CC                    PIC X(01).                  00018300
018400     05  REPORT-RECORD                PIC X(132).                 00018400
018500                                                                  00018500
018600 01  EVS-MSTR-KEYS.                                               00018600
018700      05  EVS-S-1-KEY.                                            00018700
018800          10  EVS-S-1-MODEL-YR        PIC X(01).                  00018800
018900          10  EVS-S-1-DIST            PIC X(02).                  00018900
019000          10  EVS-S-1-DLR.                                        00019000
019100              15  EVS-S-1-DLR-1       PIC X(01).                  00019100
019200              15  EVS-S-1-DLR-2-3     PIC X(02).                  00019200
019300          10  EVS-S-1-BODY            PIC X(03).                  00019300
019400          10  EVS-S-1-ITEM            PIC X(04).                  00019400
019500                                                                  00019500
019600      05  EVS-S-2KEY.                                             00019600
019700          10  EVS-S-2-MODEL-YR        PIC X(01).                  00019700
019800          10  EVS-S-2-WMI.                                        00019800
019900              15  EVS-S-2-WMI-1-2.                                00019900
020000                  20  EVS-S-2-WMI-1   PIC X(01).                  00020000
020100                  20  EVS-S-2-WMI-2   PIC X(01).                  00020100
020200              15  EVS-S-2-WMI-3       PIC X(01).                  00020200
020300          10  EVS-S-2-PLANT           PIC X(01).                  00020300
020400          10  EVS-S-2-BASE            PIC X(06).                  00020400
020500                                                                  00020500
020600 01  REPORT-HEADING1.                                             00020600
020700     05  FILLER                       PIC X(02)  VALUE SPACES.    00020700
020800     05  FILLER                       PIC X(07)  VALUE 'EXVS120'. 00020800
020900     05  FILLER                       PIC X(40)  VALUE SPACES.    00020900
021000     05  FILLER                       PIC X(21)                   00021000
021100         VALUE 'EXPORT VEHICLE SYSTEM'.                           00021100
021200     05  FILLER                       PIC X(43)  VALUE SPACES.    00021200
021300     05  FILLER                       PIC X(11)  VALUE 'PAGE:'.   00021300
021400     05  PAGE-NUMBER                  PIC Z(03)9 VALUE ZEROS.     00021400
021500     05  FILLER                       PIC X(04)  VALUE SPACES.    00021500
021600                                                                  00021600
021700 01  REPORT-HEADING2.                                             00021700
021800     05  FILLER                       PIC X(02)  VALUE SPACES.    00021800
021900     05  FILLER                       PIC X(16)                   00021900
022000         VALUE 'REPORT NO. FDBK'.                                 00022000
022100     05  FILLER                       PIC X(23)  VALUE SPACES.    00022100
022200     05  FILLER                       PIC X(35)                   00022200
022300         VALUE '   USOB ORDER TRAILERS ERROR REPORT'.             00022300
022400     05  FILLER                       PIC X(37)  VALUE SPACES.    00022400
022500     05  FILLER                       PIC X(07)  VALUE 'DATE:'.   00022500
022600     05  REPORT-DATE                  PIC X(08)  VALUE SPACES.    00022600
022700     05  FILLER                       PIC X(04)  VALUE SPACES.    00022700
022800                                                                  00022800
022900 01  REPORT-HEADING2-5.                                           00022900
023000     05  FILLER                       PIC X(02)  VALUE SPACES.    00023000
023100     05  PGM-HEADING                  PIC X(50)  VALUE SPACES.    00023100
023200     05  FILLER                       PIC X(61)  VALUE SPACES.    00023200
023300     05  FILLER                       PIC X(07)  VALUE 'TIME:'.   00023300
023400     05  REPORT-TIME                  PIC X(08)  VALUE SPACES.    00023400
023500     05  FILLER                       PIC X(04)  VALUE SPACES.    00023500
023600                                                                  00023600
023700 01  REPORT-HEADING3.                                             00023700
023800     05  FILLER                       PIC X(02)  VALUE SPACES.    00023800
023900     05  FILLER                       PIC X(35)                   00023900
024000         VALUE 'MY DLR BODY ORD    WMI MY PLT SER  '.             00024000
024100     05  FILLER                       PIC X(32)                   00024100
024200         VALUE ' ERROR                  MESSAGE'.                 00024200
024300     05  FILLER                       PIC X(63)  VALUE SPACES.    00024300
024400                                                                  00024400
024500 01  REPORT-HEADING4.                                             00024500
024600     05  FILLER                       PIC X(02)  VALUE SPACES.    00024600
024700     05  FILLER                       PIC X(35)                   00024700
024800         VALUE '---------------    --------------  '.             00024800
024900     05  FILLER                       PIC X(32)                   00024900
025000         VALUE ' -----                  -------'.                 00025000
025100     05  FILLER                       PIC X(63)  VALUE SPACES.    00025100
025200                                                                  00025200
025300 01  REPORT-DETAIL.                                               00025300
025400     05  FILLER                       PIC X(03)  VALUE SPACES.    00025400
025500     05  RPT-MY-DLR-BDY-ORD.                                      00025500
025600         10  RPT-MY                   PIC X(01)  VALUE SPACES.    00025600
025700         10  RPT-DLR-BDY-ORD.                                     00025700
025800             15  RPT-DIST             PIC X(02)  VALUE SPACES.    00025800
025900             15  RPT-DLR              PIC X(03)  VALUE SPACES.    00025900
026000             15  RPT-BDY              PIC X(03)  VALUE SPACES.    00026000
026100             15  RPT-ORD              PIC X(04)  VALUE SPACES.    00026100
026200     05  FILLER                       PIC X(07)  VALUE SPACES.    00026200
026300     05  RPT-WMI-MY-PLT-SER.                                      00026300
026400         10  RPT-WMI.                                             00026400
026500             15  RPT-WMI-1-2          PIC X(02)  VALUE SPACES.    00026500
026600         10  RPT-MY2                  PIC X(01)  VALUE SPACES.    00026600
026700         10  RPT-PLT                  PIC X(01)  VALUE SPACES.    00026700
026800         10  RPT-SER                  PIC X(06)  VALUE SPACES.    00026800
026900     05  FILLER                       PIC X(05)  VALUE SPACES.    00026900
027000     05  RPT-ERROR-CONDITION          PIC X(20)  VALUE SPACES.    00027000
027100     05  FILLER                       PIC X(03)  VALUE SPACES.    00027100
027200     05  RPT-MESSAGE                  PIC X(70)  VALUE SPACES.    00027200
027300     05  FILLER                       PIC X(01)  VALUE SPACES.    00027300
027400/                                                                 00027400
027500 COPY CPEX201.                                                    00027500
027600/                                                                 00027600
027700 01  ERR-INFO.                                                    00027700
027800     05  ERR-ABEND-PARA               PIC X(30) VALUE SPACES.     00027800
027900     05  ERR-ABEND-CODE               PIC X(02) VALUE SPACES.     00027900
028000     05  ERR-FUNCTION-CALL            PIC X(10) VALUE SPACES.     00028000
028100     05  ERR-SEG-NAME                 PIC X(20) VALUE SPACES.     00028100
028200     05  ERR-PROG-NAME                PIC X(20) VALUE SPACES.     00028200
028300     05  ERR-SQLCODE                  PIC X(04) VALUE SPACES.     00028300
028400     05  ERR-S-1-KEY                  PIC X(13) VALUE SPACES.     00028400
028500     05  ERR-TABLE-NAME               PIC X(20) VALUE SPACES.     00028500
028600                                                                  00028600
028700 01  ADVANCE-TOP-OF-PAGE              PIC X(01) VALUE '1'.        00028700
028800 01  ADVANCE-LINE1                    PIC X(01) VALUE SPACES.     00028800
028900 01  ADVANCE-LINE2                    PIC X(01) VALUE '0'.        00028900
029000 01  ADVANCE-LINE3                    PIC X(01) VALUE '+'.        00029000
029100                                                                  00029100
029200*********    SAVE AREAS FOR RESTART                               00029200
029300 01  CNT-CHECKPOINT                   PIC S9(07) VALUE ZEROS.     00029300
029400 01  XRST-SAVE-AREAS.                                             00029400
029500     05  SAVE1-AREA.                                              00029500
029600         10 SAVE-CHKP-LIMIT           PIC S9(07) VALUE +100.      00029600
029700     05  SAVE2-AREA.                                              00029700
029800         10  FILLER                   PIC X(0398) VALUE SPACES.   00029800
029900     05  SAVE3-AREA.                                              00029900
030000         10  FILLER                   PIC X(01) VALUE SPACES.     00030000
030100     05  SAVE4-AREA.                                              00030100
030200         10  FILLER                   PIC X(01) VALUE SPACES.     00030200
030300     05  SAVE5-AREA.                                              00030300
030400         10  FILLER                   PIC X(01) VALUE SPACES.     00030400
030500     05  SAVE6-AREA.                                              00030500
030600         10  FILLER                   PIC X(01) VALUE SPACES.     00030600
030700     05  SAVE7-AREA.                                              00030700
030800         10  FILLER                   PIC X(01) VALUE SPACES.     00030800
030900 01  SAVE-AREA-LENGTHS.                                           00030900
031000     05  I-O-AREA-LENGTH              PIC S9(05) COMP VALUE +10.  00031000
031100     05  SAVE1-LENGTH                 PIC S9(05) COMP VALUE +7.   00031100
031200     05  SAVE2-LENGTH                 PIC S9(05) COMP VALUE +398. 00031200
031300     05  SAVE3-LENGTH                 PIC S9(05) COMP VALUE +1.   00031300
031400     05  SAVE4-LENGTH                 PIC S9(05) COMP VALUE +1.   00031400
031500     05  SAVE5-LENGTH                 PIC S9(05) COMP VALUE +1.   00031500
031600     05  SAVE6-LENGTH                 PIC S9(05) COMP VALUE +1.   00031600
031700     05  SAVE7-LENGTH                 PIC S9(05) COMP VALUE +1.   00031700
031800                                                                  00031800
031900*********    END OF SAVE AREAS FOR RESTART                        00031900
032000/                                                                 00032000
032100 COPY CPEX001.                       TABLE MEXA001MSTR            00032100
032200/                                                                 00032200
032300 COPY CPEX016.                       TABLE MEXA016JOBPRM          00032300
032400/                                                                 00032400
032500 COPY CPEX033.                       TABLE MEXA033EXTEND          00032500
032600/                                                                 00032600
032700 COPY CPEXSQL.                                                    00032700
032800/                                                                 00032800
032900 ++INCLUDE PCPTSIMS2                                              00032900
033000/                                                                 00033000
033100***************************************************************** 00033100
033200*                                                               * 00033200
033300*           GSAM1             LOGICAL TERMINAL PCB              * 00033300
033400*   THIS IS THE PCB FOR USOB FILE (INPUT)                       * 00033400
033500***************************************************************** 00033500
033600 01  GSAM1-I-O-PCB.                                               00033600
033700     05  GSAM1-I-O-NAME               PIC X(8) VALUE 'MDEXG100'.  00033700
033800     05  FILLER                       PIC XX.                     00033800
033900     05  GSAM1-I-O-STATUS             PIC XX.                     00033900
034000***************************************************************** 00034000
034100*                                                               * 00034100
034200*           GSAM2             LOGICAL TERMINAL PCB              * 00034200
034300*   THIS IS THE PCB FOR AUDIT REPORT FILE (OUTPUT)              * 00034300
034400***************************************************************** 00034400
034500 01  GSAM2-I-O-PCB.                                               00034500
034600     05  GSAM2-I-O-NAME               PIC X(8) VALUE 'MDEXG101'.  00034600
034700     05  FILLER                       PIC XX.                     00034700
034800     05  GSAM2-I-O-STATUS             PIC XX.                     00034800
034900***************************************************************** 00034900
035000*                                                               * 00035000
035100*           GSAM3             LOGICAL TERMINAL PCB              * 00035100
035200*   THIS IS THE PCB FOR REPORT FILE (OUTPUT)                    * 00035200
035300***************************************************************** 00035300
035400 01  GSAM3-I-O-PCB.                                               00035400
035500     05  GSAM3-I-O-NAME               PIC X(8) VALUE 'MDEXG102'.  00035500
035600     05  FILLER                       PIC XX.                     00035600
035700     05  GSAM3-I-O-STATUS             PIC XX.                     00035700
035800***************************************************************** 00035800
035900/                                                                 00035900
036000 PROCEDURE DIVISION.                                              00036000
036100                                                                  00036100
036200 0000-MAIN-PROCESSING.                                            00036200
036300******************************************************************00036300
036400*                                                                *00036400
036500*  DESCRIPTION: MAIN PROCESSING                                  *00036500
036600*                                                                *00036600
036700******************************************************************00036700
036800                                                                  00036800
036900      ENTRY 'DLITCBL'  USING    I-O-PCB,                          00036900
037000                                GSAM1-I-O-PCB,                    00037000
037100                                GSAM2-I-O-PCB,                    00037100
037200                                GSAM3-I-O-PCB.                    00037200
037300                                                                  00037300
037400      PERFORM XRST-LOGIC.                                         00037400
037500                                                                  00037500
037600      OPEN INPUT PARMFILE.                                        00037600
037700                                                                  00037700
037800      READ PARMFILE                                               00037800
037900         AT END                                                   00037900
038000            MOVE +1000                TO CHECKPOINT-FREQUENCY     00038000
038100            MOVE 'PROD'               TO RUN-MODE.                00038100
038200                                                                  00038200
038300      MOVE CHECKPOINT-FREQUENCY       TO SAVE-CHKP-LIMIT.         00038300
038400                                                                  00038400
038500      IF XRST-ID EQUAL SPACES                                     00038500
038600         PERFORM 1000-HOUSEKEEPING                                00038600
038700      ELSE                                                        00038700
038800         ACCEPT TODAYS-DATE  FROM DATE                            00038800
038900         ACCEPT START-TIME   FROM TIME                            00038900
039000         MOVE TD-YY                   TO TD-PRINT-YY              00039000
039100         MOVE TD-MM                   TO TD-PRINT-MM              00039100
039200         MOVE TD-DD                   TO TD-PRINT-DD              00039200
039300         MOVE START-TIME              TO TODAYS-TIME              00039300
039400         MOVE TT-HH                   TO TT-PRINT-HH              00039400
039500         MOVE TT-MM                   TO TT-PRINT-MM              00039500
039600         MOVE TT-SS                   TO TT-PRINT-SS              00039600
039700         MOVE TODAYS-DATE-PRINT       TO REPORT-DATE              00039700
039800         MOVE TODAYS-TIME-PRINT       TO REPORT-TIME              00039800
039900         STRING 'EXVS120 BEING RESTARTED AT CHECKPOINT ---  ',    00039900
040000         XRST-ID, ' ON ', TODAYS-DATE-PRINT,                      00040000
040100         ' AT ', TODAYS-TIME-PRINT                                00040100
040200         DELIMITED                                                00040200
040300                BY SIZE INTO AUDIT-RECORD                         00040300
040400         MOVE ADVANCE-LINE3           TO AUDIT-CC                 00040400
040500         PERFORM 10000-WRITE-AUDIT-RECORD                         00040500
040600      END-IF.                                                     00040600
040700                                                                  00040700
040800      PERFORM 2000-PROCESS                                        00040800
040900              UNTIL TLR-EOF = 'YES'.                              00040900
041000                                                                  00041000
041100      PERFORM 8000-WRITE-AUDIT-REPORT.                            00041100
041200                                                                  00041200
041300      PERFORM 8200-CHECK-LINE-CNT.                                00041300
041400                                                                  00041400
041500      PERFORM 9000-EOJ.                                           00041500
041600                                                                  00041600
041700      PERFORM  NORMAL-PROGRAM-TERMINATION.                        00041700
041800/                                                                 00041800
041900 1000-HOUSEKEEPING.                                               00041900
042000******************************************************************00042000
042100*                                                                *00042100
042200*  DESCRIPTION:  ACCEPTS DATE AND TIME, OPENS FILES, WRITES      *00042200
042300*                HEADER ON AUDIT REPORT                          *00042300
042400*                                                                *00042400
042500******************************************************************00042500
042600                                                                  00042600
042700      ACCEPT START-DATE  FROM DATE.                               00042700
042800      ACCEPT START-TIME  FROM TIME.                               00042800
042900                                                                  00042900
043000      MOVE START-DATE                 TO TODAYS-DATE.             00043000
043100      MOVE TD-YY                      TO TD-PRINT-YY.             00043100
043200      MOVE TD-MM                      TO TD-PRINT-MM.             00043200
043300      MOVE TD-DD                      TO TD-PRINT-DD.             00043300
043400                                                                  00043400
043500      MOVE START-TIME                 TO TODAYS-TIME.             00043500
043600      MOVE TT-HH                      TO TT-PRINT-HH.             00043600
043700      MOVE TT-MM                      TO TT-PRINT-MM.             00043700
043800      MOVE TT-SS                      TO TT-PRINT-SS.             00043800
043900                                                                  00043900
044000      STRING 'PGM VERSION - ', PAN-VALET DELIMITED                00044000
044100             BY SIZE INTO AUDIT-HEADING.                          00044100
044200      MOVE AUDIT-HEADER               TO AUDIT-RECORD.            00044200
044300      MOVE ADVANCE-TOP-OF-PAGE        TO AUDIT-CC.                00044300
044400      PERFORM 10000-WRITE-AUDIT-RECORD.                           00044400
044500                                                                  00044500
044600      MOVE SPACES                     TO AUDIT-HEADER.            00044600
044700      MOVE 'EXVS120 AUDIT REPORT (RMDS # = FDBQ)'                 00044700
044800                                      TO AUDIT-HEADING.           00044800
044900      MOVE AUDIT-HEADER               TO AUDIT-RECORD.            00044900
045000      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00045000
045100      PERFORM 10000-WRITE-AUDIT-RECORD.                           00045100
045200                                                                  00045200
045300      MOVE 'PROGRAM RUN DATE'         TO AUDIT-MESSAGE.           00045300
045400      MOVE ' = '                      TO AUDIT-SEP.               00045400
045500      MOVE TODAYS-DATE-PRINT          TO AUDIT-COUNT.             00045500
045600      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00045600
045700      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00045700
045800      PERFORM 10000-WRITE-AUDIT-RECORD.                           00045800
045900                                                                  00045900
046000      MOVE 'PROGRAM START TIME'       TO AUDIT-MESSAGE.           00046000
046100      MOVE ' = '                      TO AUDIT-SEP.               00046100
046200      MOVE TODAYS-TIME-PRINT          TO AUDIT-COUNT.             00046200
046300      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00046300
046400      MOVE ADVANCE-LINE1              TO AUDIT-CC.                00046400
046500      PERFORM 10000-WRITE-AUDIT-RECORD.                           00046500
046600                                                                  00046600
046700      MOVE TODAYS-DATE-PRINT          TO REPORT-DATE.             00046700
046800      MOVE TODAYS-TIME-PRINT          TO REPORT-TIME.             00046800
046900      STRING 'PGM VERSION - ', PAN-VALET DELIMITED                00046900
047000             BY SIZE INTO PGM-HEADING.                            00047000
047100                                                                  00047100
047200      PERFORM 8300-WRITE-RPT-HEAD.                                00047200
047300/                                                                 00047300
047400 2000-PROCESS.                                                    00047400
047500******************************************************************00047500
047600*                                                                *00047600
047700*  DESCRIPTION:   THE PERFORMS TO READ THE TRAILER AND EVS       *00047700
047800*                 MASTERS                                        *00047800
047900*                                                                *00047900
048000******************************************************************00048000
048100                                                                  00048100
048200     CALL 'CBLTDLI'    USING  GN                                  00048200
048300                              GSAM1-I-O-PCB                       00048300
048400                              TLR-RECORD.                         00048400
048500                                                                  00048500
048600     EVALUATE GSAM1-I-O-STATUS                                    00048600
048700         WHEN SPACES                                              00048700
048800             MOVE TLR-RECORD          TO TLR-WORK                 00048800
048900             ADD 1                    TO TLR-REC-IN-CNT           00048900
049000             IF TW-TYPE = 11                                      00049000
049100                 PERFORM 2200-READ-MSTR-TYPE11                    00049100
049200             ELSE                                                 00049200
049300                 PERFORM 2100-READ-EVS-MSTR                       00049300
049400             END-IF                                               00049400
049500         WHEN 'GB'                                                00049500
049600              MOVE 'YES'              TO TLR-EOF                  00049600
049700         WHEN 'GE'                                                00049700
049800              MOVE 'YES'              TO TLR-EOF                  00049800
049900         WHEN OTHER                                               00049900
050000              MOVE '2000-PROCESS    ' TO  ERR-ABEND-PARA          00050000
050100              MOVE GSAM1-I-O-STATUS   TO  ERR-ABEND-CODE          00050100
050200              MOVE GN                 TO  ERR-FUNCTION-CALL       00050200
050300              MOVE 'I-O-PCB GSAM1'    TO  ERR-SEG-NAME            00050300
050400              MOVE 'EXVS120'          TO  ERR-PROG-NAME           00050400
050500              MOVE SPACES             TO  ERR-SQLCODE             00050500
050600              MOVE SPACES             TO  ERR-TABLE-NAME          00050600
050700              PERFORM 9999-ABEND                                  00050700
050800     END-EVALUATE.                                                00050800
050900                                                                  00050900
051000     IF CNT-CHECKPOINT > SAVE-CHKP-LIMIT                          00051000
051100          MOVE WS-SAVE-AREA-2         TO SAVE2-AREA               00051100
051200          PERFORM CHECK-POINT                                     00051200
051300          IF CHECK-POINT-TAKEN = 'Y'                              00051300
051400              MOVE ZEROES             TO CNT-CHECKPOINT           00051400
051500          END-IF                                                  00051500
051600     END-IF.                                                      00051600
051700/                                                                 00051700
051800 2100-READ-EVS-MSTR.                                              00051800
051900***************************************************************** 00051900
052000*                                                               * 00052000
052100*  DESCRIPTION: READ THE EVS MASTER FILE                        * 00052100
052200*                                                               * 00052200
052300***************************************************************** 00052300
052400                                                                  00052400
052500      INITIALIZE  MEXA001MSTR.                                    00052500
052600                                                                  00052600
052700      MOVE TW-MDL-YR                  TO EVS-S-1-MODEL-YR         00052700
052800                                         EVS-S-MODEL-YR.          00052800
052900      MOVE TW-DIST                    TO EVS-S-1-DIST             00052900
053000                                         EVS-S-DIST.              00053000
053100      MOVE TW-DLR                     TO EVS-S-1-DLR              00053100
053200                                         EVS-S-DLR.               00053200
053300      MOVE TW-BODY                    TO EVS-S-1-BODY             00053300
053400                                         EVS-S-BODY.              00053400
053500      MOVE TW-ITEM                    TO EVS-S-1-ITEM             00053500
053600                                         EVS-S-ITEM.              00053600
053700                                                                  00053700
053800      EXEC SQL                                                    00053800
053900         SELECT                                                   00053900
054000             EVS_P_CONTROL_NO               ,                     00054000
054100             EVS_S_WMI                      ,                     00054100
054200             EVS_S_PLANT                    ,                     00054200
054300             EVS_S_SERIAL                   ,                     00054300
054400             EVS_S_LC_NO                    ,                     00054400
054500             EVS_U_VO_IMAGE                 ,                     00054500
054600             EVS_U_DSO_ORD_QTY              ,                     00054600
054700             EVS_F_REQ_PROD_YM              ,                     00054700
054800             EVS_F_SHIP_TO_NAME                                   00054800
054900         INTO                                                     00054900
055000            :MEXA001MSTR.EVS-P-CONTROL-NO   ,                     00055000
055100            :MEXA001MSTR.EVS-S-WMI          ,                     00055100
055200            :MEXA001MSTR.EVS-S-PLANT        ,                     00055200
055300            :MEXA001MSTR.EVS-S-SERIAL       ,                     00055300
055400            :MEXA001MSTR.EVS-S-LC-NO        ,                     00055400
055500            :MEXA001MSTR.EVS-U-VO-IMAGE     ,                     00055500
055600            :MEXA001MSTR.EVS-U-DSO-ORD-QTY  ,                     00055600
055700            :MEXA001MSTR.EVS-F-REQ-PROD-YM  ,                     00055700
055800            :MEXA001MSTR.EVS-F-SHIP-TO-NAME                       00055800
055900         FROM                                                     00055900
056000               MEXA001MSTR                                        00056000
056100         WHERE                                                    00056100
056200                  EVS_S_MODEL_YR    = :MEXA001MSTR.EVS-S-MODEL-YR 00056200
056300             AND  EVS_S_DIST        = :MEXA001MSTR.EVS-S-DIST     00056300
056400             AND  EVS_S_DLR         = :MEXA001MSTR.EVS-S-DLR      00056400
056500             AND  EVS_S_BODY        = :MEXA001MSTR.EVS-S-BODY     00056500
056600             AND  EVS_S_ITEM        = :MEXA001MSTR.EVS-S-ITEM     00056600
056700             AND  EVS_S_STATUS_CODE NOT IN ('100','990')          00056700
056800             AND  EVS_N_PLT_REL_DT  = '       '                   00056800
056900     END-EXEC.                                                    00056900
057000                                                                  00057000
057100     EVALUATE SQLCODE                                             00057100
057200         WHEN ZEROS                                               00057200
057300             MOVE EVS-S-MODEL-YR      TO EVS-S-2-MODEL-YR         00057300
057400             MOVE EVS-S-WMI           TO EVS-S-2-WMI              00057400
057500             MOVE EVS-S-PLANT         TO EVS-S-2-PLANT            00057500
057600             MOVE EVS-S-SERIAL        TO EVS-S-2-BASE             00057600
057700             PERFORM 2300-VERIFY-REC-TYPE                         00057700
057800         WHEN -811                                                00057800
057900            MOVE 'DUPLICATE S1 KEY '  TO AUDIT-MESSAGE            00057900
058000            MOVE SPACES               TO AUDIT-COUNT1             00058000
058100            MOVE EVS-S-1-KEY          TO AUDIT-COUNT2             00058100
058200            MOVE SPACES               TO AUDIT-COUNT3             00058200
058300            MOVE AUDIT-DETAIL         TO AUDIT-RECORD             00058300
058400            MOVE ADVANCE-LINE1        TO AUDIT-CC                 00058400
058500            PERFORM 10000-WRITE-AUDIT-RECORD                      00058500
058600            PERFORM 8200-CHECK-LINE-CNT                           00058600
058700            MOVE TW-MDL-YR            TO RPT-MY                   00058700
058800            MOVE TW-DIST              TO RPT-DIST                 00058800
058900            MOVE TW-DLR               TO RPT-DLR                  00058900
059000            MOVE TW-BODY              TO RPT-BDY                  00059000
059100            MOVE TW-ITEM              TO RPT-ORD                  00059100
059200            MOVE SPACES               TO RPT-MY2                  00059200
059300            MOVE SPACES               TO RPT-WMI-1-2              00059300
059400            MOVE SPACES               TO RPT-PLT                  00059400
059500            MOVE SPACES               TO RPT-SER                  00059500
059600            MOVE SPACES               TO RPT-ERROR-CONDITION      00059600
059700            MOVE 'DUPLICATE S1 KEY EXISTS IN EVS MASTER'          00059700
059800                                      TO RPT-MESSAGE              00059800
059900            MOVE REPORT-DETAIL        TO REPORT-RECORD            00059900
060000            MOVE ADVANCE-LINE1        TO REPORT-CC                00060000
060100            PERFORM 9500-WRITE-REPORT-RECORD                      00060100
060200            ADD +1                    TO LINE-CNT                 00060200
060300            MOVE 'Y'                  TO REPORT-SWITCH            00060300
060400         WHEN +100                                                00060400
060500             MOVE 'TLR NOT ON EVS MSTR'                           00060500
060600                                      TO AUDIT-MESSAGE            00060600
060700             MOVE EVS-S-1-KEY         TO AUDIT-COUNT1             00060700
060800             MOVE SPACES              TO AUDIT-COUNT2             00060800
060900             MOVE TW-TYPE             TO WS-TW-TYPE               00060900
061000             MOVE WS-TW-TYPE          TO AUDIT-COUNT3             00061000
061100             MOVE AUDIT-DETAIL        TO AUDIT-RECORD             00061100
061200             MOVE ADVANCE-LINE1       TO AUDIT-CC                 00061200
061300             PERFORM 10000-WRITE-AUDIT-RECORD                     00061300
061400             ADD +1                   TO EVS-REC-NOT-FOUND        00061400
061500         WHEN OTHER                                               00061500
061600             MOVE  SQLCODE            TO  EDIT-SQLCODE            00061600
061700             MOVE  '2100-READ-EVS-MSTR'                           00061700
061800                                      TO  ERR-ABEND-PARA          00061800
061900             MOVE  SPACES             TO  ERR-ABEND-CODE          00061900
062000             MOVE  'SELECT'           TO  ERR-FUNCTION-CALL       00062000
062100             MOVE  SPACES             TO  ERR-SEG-NAME            00062100
062200             MOVE  'EXVS120'          TO  ERR-PROG-NAME           00062200
062300             MOVE  'MEXA001MSTR'      TO  ERR-TABLE-NAME          00062300
062400             MOVE  EDIT-SQLCODE-R     TO  ERR-SQLCODE             00062400
062500             MOVE EVS-S-1-KEY         TO  ERR-S-1-KEY             00062500
062600             PERFORM 9999-ABEND                                   00062600
062700     END-EVALUATE.                                                00062700
062800/                                                                 00062800
062900 2200-READ-MSTR-TYPE11.                                           00062900
063000***************************************************************** 00063000
063100*                                                               * 00063100
063200*  DESCRIPTION: READ TYPE 11 RECORDS FROM EVS MASTER WITH       * 00063200
063300*               STATUS LESS THAN 401.                           * 00063300
063400*                                                               * 00063400
063500***************************************************************** 00063500
063600                                                                  00063600
063700      INITIALIZE  MEXA001MSTR.                                    00063700
063800                                                                  00063800
063900      MOVE TW-MDL-YR                  TO EVS-S-MODEL-YR.          00063900
064000      MOVE TW-DIST                    TO EVS-S-DIST.              00064000
064100      MOVE TW-DLR                     TO EVS-S-DLR.               00064100
064200      MOVE TW-BODY                    TO EVS-S-BODY.              00064200
064300      MOVE TW-ITEM                    TO EVS-S-ITEM.              00064300
064400                                                                  00064400
064500      EXEC SQL                                                    00064500
064600         SELECT                                                   00064600
064700             EVS_P_CONTROL_NO,                                    00064700
064800             EVS_F_EUROPEAN_IND                                   00064800
064900         INTO                                                     00064900
065000            :EVS-P-CONTROL-NO,                                    00065000
065100            :EVS-F-EUROPEAN-IND                                   00065100
065200         FROM                                                     00065200
065300               MEXA001MSTR                                        00065300
065400         WHERE                                                    00065400
065500                  EVS_S_MODEL_YR    = :EVS-S-MODEL-YR             00065500
065600             AND  EVS_S_DIST        = :EVS-S-DIST                 00065600
065700             AND  EVS_S_DLR         = :EVS-S-DLR                  00065700
065800             AND  EVS_S_BODY        = :EVS-S-BODY                 00065800
065900             AND  EVS_S_ITEM        = :EVS-S-ITEM                 00065900
066000             AND  EVS_S_STATUS_CODE < '401'                       00066000
066100             AND  NOT EVS_S_STATUS_CODE = '100'                   00066100
066200     END-EXEC.                                                    00066200
066300                                                                  00066300
066400     EVALUATE SQLCODE                                             00066400
066500         WHEN ZEROS                                               00066500
066600             PERFORM 2500-REC-TYPE-11                             00066600
066700         WHEN +100                                                00066700
066800             MOVE 'TYPE 11 TLR NOT ON EVSMSTR'                    00066800
066900                                      TO AUDIT-MESSAGE            00066900
067000             STRING EVS-S-MODEL-YR,                               00067000
067100                    EVS-S-DIST,                                   00067100
067200                    EVS-S-DLR,                                    00067200
067300                    EVS-S-BODY,                                   00067300
067400                    EVS-S-ITEM  DELIMITED BY SIZE                 00067400
067500                    INTO AUDIT-COUNT1                             00067500
067600             MOVE SPACES              TO AUDIT-COUNT2             00067600
067700             MOVE AUDIT-DETAIL        TO AUDIT-RECORD             00067700
067800             MOVE ADVANCE-LINE1       TO AUDIT-CC                 00067800
067900             PERFORM 10000-WRITE-AUDIT-RECORD                     00067900
068000             ADD +1                   TO EVS-REC-NOT-FOUND        00068000
068100         WHEN OTHER                                               00068100
068200             MOVE  SQLCODE            TO  EDIT-SQLCODE            00068200
068300             MOVE  '2200-READ-MSTR-TYPE11'                        00068300
068400                                      TO  ERR-ABEND-PARA          00068400
068500             MOVE  SPACES             TO  ERR-ABEND-CODE          00068500
068600             MOVE  'SELECT'           TO  ERR-FUNCTION-CALL       00068600
068700             MOVE  SPACES             TO  ERR-SEG-NAME            00068700
068800             MOVE  'EXVS120'          TO  ERR-PROG-NAME           00068800
068900             MOVE  'MEXA001MSTR'      TO  ERR-TABLE-NAME          00068900
069000             MOVE  EDIT-SQLCODE-R     TO  ERR-SQLCODE             00069000
069100             MOVE EVS-S-1-KEY         TO  ERR-S-1-KEY             00069100
069200             PERFORM 9999-ABEND                                   00069200
069300     END-EVALUATE.                                                00069300
069400/                                                                 00069400
069500 2300-VERIFY-REC-TYPE.                                            00069500
069600**************************************************************    00069600
069700*                                                            *    00069700
069800*  DESCRIPTION:  WRITE RECORDS                               *    00069800
069900*                                                            *    00069900
070000**************************************************************    00070000
070100                                                                  00070100
070200      EVALUATE TW-TYPE                                            00070200
070300          WHEN 06                                                 00070300
070400              PERFORM 2400-REC-TYPE-06                            00070400
070500          WHEN 16                                                 00070500
070600              PERFORM 2600-REC-TYPE-16                            00070600
070700          WHEN 19                                                 00070700
070800              PERFORM 2800-REC-TYPE-19                            00070800
070900          WHEN OTHER                                              00070900
071000              ADD 1                   TO RECORD-BYPASSED          00071000
071100      END-EVALUATE.                                               00071100
071200/                                                                 00071200
071300 2400-REC-TYPE-06.                                                00071300
071400**************************************************************    00071400
071500*                                                            *    00071500
071600*  DESCRIPTION:  TYPE 06 RECORD                              *    00071600
071700*                                                            *    00071700
071800**************************************************************    00071800
071900                                                                  00071900
072000      IF EVS-F-SHIP-TO-NAME = SPACES                              00072000
072100         MOVE TW-06-SHIP-TO-DLR-NAME  TO EVS-F-SHIP-TO-NAME       00072100
072200         PERFORM 2900-START-UPDATE-MSTR                           00072200
072300      ELSE                                                        00072300
072400         ADD 1                        TO RECORD-BYPASSED          00072400
072500      END-IF.                                                     00072500
072600/                                                                 00072600
072700 2500-REC-TYPE-11.                                                00072700
072800**************************************************************    00072800
072900*                                                            *    00072900
073000*  DESCRIPTION:  TYPE 11 RECORD                              *    00073000
073100*                                                            *    00073100
073200**************************************************************    00073200
073300                                                                  00073300
073400     IF EVS-F-EUROPEAN-IND = 'Y' AND                              00073400
073500        TW-11-ORBIT-NUM NOT = SPACES                              00073500
073600         PERFORM 3000-SELECT-EXTEND                               00073600
073700     ELSE                                                         00073700
073800         ADD 1                        TO RECORD-BYPASSED          00073800
073900     END-IF.                                                      00073900
074000/                                                                 00074000
074100 2600-REC-TYPE-16.                                                00074100
074200**************************************************************    00074200
074300*                                                            *    00074300
074400*  DESCRIPTION:  TYPE 16 RECORD                              *    00074400
074500*                                                            *    00074500
074600**************************************************************    00074600
074700                                                                  00074700
074800      IF (EVS-U-VO-IMAGE(70:2) = '9E' AND                         00074800
074900         (EVS-U-VO-IMAGE(73:3) = '900'  OR                        00074900
075000          EVS-U-VO-IMAGE(73:3) = '905')) AND                      00075000
075100         (TW-16-NOTE-PROD-YYMM NOT = SPACES)                      00075100
075200          PERFORM 2700-TYPE-16-MOVE                               00075200
075300          IF INVALID-PROD-DATE = 'Y'                              00075300
075400             ADD 1                    TO RECORD-BYPASSED          00075400
075500          ELSE                                                    00075500
075600             PERFORM 2900-START-UPDATE-MSTR                       00075600
075700          END-IF                                                  00075700
075800      ELSE                                                        00075800
075900         ADD 1                        TO RECORD-BYPASSED          00075900
076000      END-IF.                                                     00076000
076100/                                                                 00076100
076200 2700-TYPE-16-MOVE.                                               00076200
076300**************************************************************    00076300
076400*                                                            *    00076400
076500*  DESCRIPTION:  TO ADD THE REQ PROD YYMM TO THE EVS MASTER  *    00076500
076600*                                                            *    00076600
076700**************************************************************    00076700
076800                                                                  00076800
076900      MOVE 'N'                        TO INVALID-PROD-DATE.       00076900
077000                                                                  00077000
077100      IF TW-16-NOTE-PROD-YYMM = '0000'                            00077100
077200         MOVE '0'                     TO WS-PROD-C                00077200
077300         MOVE TW-16-NOTE-PROD-YY      TO WS-PROD-YY               00077300
077400         MOVE TW-16-NOTE-PROD-MM      TO WS-PROD-MM               00077400
077500         MOVE WS-PROD-CYYMM           TO EVS-F-REQ-PROD-YM        00077500
077600      ELSE                                                        00077600
077700         IF (TW-16-NOTE-PROD-MM > '00' AND                        00077700
077800             TW-16-NOTE-PROD-MM < '13')                           00077800
077900             IF TW-16-NOTE-PROD-YY > '86'                         00077900
078000                  MOVE '0'            TO WS-PROD-C                00078000
078100             ELSE                                                 00078100
078200                  MOVE '1'            TO WS-PROD-C                00078200
078300             END-IF                                               00078300
078400             MOVE TW-16-NOTE-PROD-YY  TO WS-PROD-YY               00078400
078500             MOVE TW-16-NOTE-PROD-MM  TO WS-PROD-MM               00078500
078600             MOVE WS-PROD-CYYMM       TO EVS-F-REQ-PROD-YM        00078600
078700         ELSE                                                     00078700
078800            MOVE 'INVALID REQ PROD YYMM' TO AUDIT-MESSAGE         00078800
078900            MOVE TW-16-NOTE-PROD-YYMM TO AUDIT-COUNT1             00078900
079000            MOVE EVS-S-1-KEY          TO AUDIT-COUNT2             00079000
079100            MOVE EVS-S-2KEY           TO AUDIT-COUNT3             00079100
079200            MOVE AUDIT-DETAIL         TO AUDIT-RECORD             00079200
079300            MOVE ADVANCE-LINE1        TO AUDIT-CC                 00079300
079400            PERFORM 10000-WRITE-AUDIT-RECORD                      00079400
079500            PERFORM 8200-CHECK-LINE-CNT                           00079500
079600            MOVE TW-MDL-YR            TO RPT-MY                   00079600
079700            MOVE TW-DIST              TO RPT-DIST                 00079700
079800            MOVE TW-DLR               TO RPT-DLR                  00079800
079900            MOVE TW-BODY              TO RPT-BDY                  00079900
080000            MOVE TW-ITEM              TO RPT-ORD                  00080000
080100            MOVE EVS-S-MODEL-YR       TO RPT-MY2                  00080100
080200            MOVE EVS-S-WMI            TO RPT-WMI-1-2              00080200
080300            MOVE EVS-S-PLANT          TO RPT-PLT                  00080300
080400            MOVE EVS-S-SERIAL         TO RPT-SER                  00080400
080500            MOVE TW-16-NOTE-PROD-YYMM TO RPT-ERROR-CONDITION      00080500
080600            MOVE 'INVALID FIES REQUESTED PRODUCTION DATE (YYMM)'  00080600
080700                                      TO RPT-MESSAGE              00080700
080800            MOVE REPORT-DETAIL        TO REPORT-RECORD            00080800
080900            MOVE ADVANCE-LINE1        TO REPORT-CC                00080900
081000            PERFORM 9500-WRITE-REPORT-RECORD                      00081000
081100            ADD +1                    TO LINE-CNT                 00081100
081200            MOVE 'Y'                  TO INVALID-PROD-DATE        00081200
081300            MOVE 'Y'                  TO REPORT-SWITCH            00081300
081400         END-IF                                                   00081400
081500      END-IF.                                                     00081500
081600/                                                                 00081600
081700 2800-REC-TYPE-19.                                                00081700
081800**************************************************************    00081800
081900*                                                            *    00081900
082000*  DESCRIPTION:  TYPE 19 RECORD                              *    00082000
082100*                                                            *    00082100
082200**************************************************************    00082200
082300                                                                  00082300
082400     MOVE TW-19-DSO-UNITS             TO EVS-U-DSO-ORD-QTY.       00082400
082500     PERFORM 2900-START-UPDATE-MSTR.                              00082500
082600/                                                                 00082600
082700 2900-START-UPDATE-MSTR.                                          00082700
082800**************************************************************    00082800
082900*                                                            *    00082900
083000*  DESCRIPTION:  WRITE RECORDS                               *    00083000
083100*                                                            *    00083100
083200**************************************************************    00083200
083300                                                                  00083300
083400      MOVE TODAYS-DATE                TO EVS-TIMESTAMP-DATE(2:6). 00083400
083500      IF TD-YY > '70'                                             00083500
083600          MOVE '0'                    TO EVS-TIMESTAMP-DATE(1:1)  00083600
083700      ELSE                                                        00083700
083800          MOVE '1'                    TO EVS-TIMESTAMP-DATE(1:1)  00083800
083900      END-IF.                                                     00083900
084000                                                                  00084000
084100      ACCEPT START-TIME FROM TIME.                                00084100
084200      MOVE START-TIME                 TO EVS-TIMESTAMP-TIME.      00084200
084300                                                                  00084300
084400      PERFORM 7200-UPDATE-EVSMSTR.                                00084400
084500/                                                                 00084500
084600 3000-SELECT-EXTEND.                                              00084600
084700***************************************************************** 00084700
084800*                                                               * 00084800
084900*  DESCRIPTION:  SELECT RECORD FROM MEXA033EXTEND.              * 00084900
085000*                                                               * 00085000
085100***************************************************************** 00085100
085200                                                                  00085200
085300     EXEC SQL SELECT                                              00085300
085400              EVS_EXT_ORBIT_NO                                    00085400
085500          INTO                                                    00085500
085600             :EVS-EXT-ORBIT-NO                                    00085600
085700          FROM  MEXA033EXTEND                                     00085700
085800          WHERE EVS_EXT_P_CNTL_NO = :EVS-P-CONTROL-NO             00085800
085900     END-EXEC.                                                    00085900
086000                                                                  00086000
086100     EVALUATE SQLCODE                                             00086100
086200         WHEN ZEROS                                               00086200
086300            PERFORM 3300-GET-TIMESTAMP                            00086300
086400            PERFORM 3100-UPDATE-EXTEND                            00086400
086500         WHEN +100                                                00086500
086600            MOVE 'OB'                 TO EVS-EXT-KEY-GRP          00086600
086700            MOVE TW-MDL-YR            TO EVS-EXT-MODEL-YR         00086700
086800            MOVE TW-DIST              TO EVS-EXT-DIST             00086800
086900            MOVE TW-DLR               TO EVS-EXT-DLR              00086900
087000            MOVE TW-BODY              TO EVS-EXT-BODY             00087000
087100            MOVE TW-ITEM              TO EVS-EXT-ITEM             00087100
087200            MOVE TW-11-ORBIT-NUM      TO EVS-EXT-ORBIT-NO         00087200
087300            MOVE EVS-S-PLANT          TO EVS-EXT-PLANT            00087300
087400            MOVE EVS-P-CONTROL-NO     TO EVS-EXT-P-CNTL-NO        00087400
087500            MOVE SPACES               TO EVS-EXT-PORT-ENTRY       00087500
087600            MOVE SPACES               TO EVS-EXT-VOYAGE-NO        00087600
087700            MOVE SPACES               TO EVS-EXT-PORT-LDNG        00087700
087800            MOVE SPACES               TO EVS-EXT-PORT-DCHRG       00087800
087900            PERFORM 3300-GET-TIMESTAMP                            00087900
088000            PERFORM 3200-INSERT-EXTEND                            00088000
088100        WHEN OTHER                                                00088100
088200            MOVE SQLCODE              TO EDIT-SQLCODE             00088200
088300            MOVE '3000-SELECT-EXTEND' TO ERR-ABEND-PARA           00088300
088400            MOVE SPACES               TO ERR-ABEND-CODE           00088400
088500            MOVE 'SELECT'             TO ERR-FUNCTION-CALL        00088500
088600            MOVE SPACES               TO ERR-SEG-NAME             00088600
088700            MOVE 'EXVS120'            TO ERR-PROG-NAME            00088700
088800            MOVE 'MEXA033EXTEND'      TO ERR-TABLE-NAME           00088800
088900            MOVE EDIT-SQLCODE-R       TO ERR-SQLCODE              00088900
089000            PERFORM 9999-ABEND                                    00089000
089100     END-EVALUATE.                                                00089100
089200/                                                                 00089200
089300 3100-UPDATE-EXTEND.                                              00089300
089400***************************************************************** 00089400
089500*                                                               * 00089500
089600*  DESCRIPTION:  UPDATES RECORD IN MEXA033EXTEND WITH ORBIT     * 00089600
089700*                NUMBER.                                        * 00089700
089800*                                                               * 00089800
089900***************************************************************** 00089900
090000                                                                  00090000
090100     EXEC SQL UPDATE MEXA033EXTEND                                00090100
090200          SET   EVS_EXT_ORBIT_NO   = :TW-11-ORBIT-NUM,            00090200
090300                EVS_EXT_TIMESTAMP  = :EVS-EXT-TIMESTAMP           00090300
090400          WHERE EVS_EXT_P_CNTL_NO  = :EVS-P-CONTROL-NO            00090400
090500     END-EXEC.                                                    00090500
090600                                                                  00090600
090700     EVALUATE SQLCODE                                             00090700
090800         WHEN ZEROS                                               00090800
090900            ADD 1                     TO WS-EXTEND-UPDATE-CNT     00090900
091000        WHEN OTHER                                                00091000
091100            MOVE 'EVS-EXT-P-CNTL-NO = ' TO AUDIT-MESSAGE          00091100
091200            MOVE EVS-P-CONTROL-NO     TO AUDIT-COUNT              00091200
091300            MOVE AUDIT-DETAIL         TO AUDIT-RECORD             00091300
091400            MOVE ADVANCE-LINE2        TO AUDIT-CC                 00091400
091500            PERFORM 10000-WRITE-AUDIT-RECORD                      00091500
091600            MOVE SQLCODE              TO EDIT-SQLCODE             00091600
091700            MOVE '3100-UPDATE-EXTEND' TO ERR-ABEND-PARA           00091700
091800            MOVE SPACES               TO ERR-ABEND-CODE           00091800
091900            MOVE 'UPDATE'             TO ERR-FUNCTION-CALL        00091900
092000            MOVE SPACES               TO ERR-SEG-NAME             00092000
092100            MOVE 'EXVS120'            TO ERR-PROG-NAME            00092100
092200            MOVE 'MEXA033EXTEND'      TO ERR-TABLE-NAME           00092200
092300            MOVE EDIT-SQLCODE-R       TO ERR-SQLCODE              00092300
092400            PERFORM 9999-ABEND                                    00092400
092500     END-EVALUATE.                                                00092500
092600/                                                                 00092600
092700 3200-INSERT-EXTEND.                                              00092700
092800***************************************************************** 00092800
092900*                                                               * 00092900
093000*  DESCRIPTION:  INSERTS RECORD IN MEXA033EXTEND TO ADD ORBIT   * 00093000
093100*                NUMBER.                                        * 00093100
093200*                                                               * 00093200
093300***************************************************************** 00093300
093400                                                                  00093400
093500     EXEC SQL                                                     00093500
093600         INSERT INTO MEXA033EXTEND                                00093600
093700             (EVS_EXT_KEY_GRP,                                    00093700
093800              EVS_EXT_MODEL_YR,                                   00093800
093900              EVS_EXT_DIST,                                       00093900
094000              EVS_EXT_DLR,                                        00094000
094100              EVS_EXT_BODY,                                       00094100
094200              EVS_EXT_ITEM,                                       00094200
094300              EVS_EXT_PLANT,                                      00094300
094400              EVS_EXT_SERIAL,                                     00094400
094500              EVS_EXT_P_CNTL_NO,                                  00094500
094600              EVS_EXT_ORBIT_NO,                                   00094600
094700              EVS_EXT_PORT_ENTRY,                                 00094700
094800              EVS_EXT_TIMESTAMP,                                  00094800
094900              EVS_EXT_VOYAGE_NO,                                  00094900
095000              EVS_EXT_PORT_LDNG,                                  00095000
095100              EVS_EXT_PORT_DCHRG)                                 00095100
095200         VALUES                                                   00095200
095300             (:EVS-EXT-KEY-GRP,                                   00095300
095400              :EVS-EXT-MODEL-YR,                                  00095400
095500              :EVS-EXT-DIST,                                      00095500
095600              :EVS-EXT-DLR,                                       00095600
095700              :EVS-EXT-BODY,                                      00095700
095800              :EVS-EXT-ITEM,                                      00095800
095900              :EVS-EXT-PLANT,                                     00095900
096000              :EVS-EXT-SERIAL,                                    00096000
096100              :EVS-EXT-P-CNTL-NO,                                 00096100
096200              :EVS-EXT-ORBIT-NO,                                  00096200
096300              :EVS-EXT-PORT-ENTRY,                                00096300
096400              :EVS-EXT-TIMESTAMP,                                 00096400
096500              :EVS-EXT-VOYAGE-NO,                                 00096500
096600              :EVS-EXT-PORT-LDNG,                                 00096600
096700              :EVS-EXT-PORT-DCHRG)                                00096700
096800     END-EXEC.                                                    00096800
096900                                                                  00096900
097000     EVALUATE SQLCODE                                             00097000
097100         WHEN ZEROS                                               00097100
097200            ADD 1                     TO WS-EXTEND-INSERT-CNT     00097200
097300         WHEN OTHER                                               00097300
097400            MOVE SQLCODE              TO EDIT-SQLCODE             00097400
097500            MOVE '3200-INSERT-EXTEND' TO ERR-ABEND-PARA           00097500
097600            MOVE SPACES               TO ERR-ABEND-CODE           00097600
097700            MOVE 'UPDATE'             TO ERR-FUNCTION-CALL        00097700
097800            MOVE SPACES               TO ERR-SEG-NAME             00097800
097900            MOVE 'EXVS120'            TO ERR-PROG-NAME            00097900
098000            MOVE 'MEXA033EXTEND'      TO ERR-TABLE-NAME           00098000
098100            MOVE EDIT-SQLCODE-R       TO ERR-SQLCODE              00098100
098200            PERFORM 9999-ABEND                                    00098200
098300     END-EVALUATE.                                                00098300
098400/                                                                 00098400
098500 3300-GET-TIMESTAMP.                                              00098500
098600***************************************************************** 00098600
098700*                                                               * 00098700
098800*  DESCRIPTION:  SELECTS TIMESTAMP FROM MEXA016JOBPRM           * 00098800
098900*                                                               * 00098900
099000***************************************************************** 00099000
099100                                                                  00099100
099200     EXEC SQL                                                     00099200
099300          SELECT DISTINCT CURRENT TIMESTAMP                       00099300
099400          INTO  :HOLD-TIMESTAMP                                   00099400
099500          FROM  MEXA016JOBPRM                                     00099500
099600     END-EXEC.                                                    00099600
099700                                                                  00099700
099800     EVALUATE SQLCODE                                             00099800
099900         WHEN ZEROS                                               00099900
100000            MOVE HOLD-TIMESTAMP       TO EVS-EXT-TIMESTAMP        00100000
100100         WHEN OTHER                                               00100100
100200            MOVE SQLCODE              TO EDIT-SQLCODE             00100200
100300            MOVE '3300-GET-TIMESTAMP' TO ERR-ABEND-PARA           00100300
100400            MOVE SPACES               TO ERR-ABEND-CODE           00100400
100500            MOVE 'SELECT'             TO ERR-FUNCTION-CALL        00100500
100600            MOVE SPACES               TO ERR-SEG-NAME             00100600
100700            MOVE 'EXVS120'            TO ERR-PROG-NAME            00100700
100800            MOVE 'MEXA016JOBPRM'      TO ERR-TABLE-NAME           00100800
100900            MOVE EDIT-SQLCODE-R       TO ERR-SQLCODE              00100900
101000            PERFORM 9999-ABEND                                    00101000
101100     END-EVALUATE.                                                00101100
101200/                                                                 00101200
101300 7200-UPDATE-EVSMSTR.                                             00101300
101400***************************************************************** 00101400
101500*                                                               * 00101500
101600*  DESCRIPTION:  UPDATE MEXA001MSTR                             * 00101600
101700*                                                               * 00101700
101800***************************************************************** 00101800
101900                                                                  00101900
102000     EXEC SQL                                                     00102000
102100          UPDATE  MEXA001MSTR                                     00102100
102200          SET                                                     00102200
102300       EVS_S_DIST               = :MEXA001MSTR.EVS-S-DIST       , 00102300
102400       EVS_S_DLR                = :MEXA001MSTR.EVS-S-DLR        , 00102400
102500       EVS_S_BODY               = :MEXA001MSTR.EVS-S-BODY       , 00102500
102600       EVS_S_ITEM               = :MEXA001MSTR.EVS-S-ITEM       , 00102600
102700       EVS_S_WMI                = :MEXA001MSTR.EVS-S-WMI        , 00102700
102800       EVS_S_PLANT              = :MEXA001MSTR.EVS-S-PLANT      , 00102800
102900       EVS_S_SERIAL             = :MEXA001MSTR.EVS-S-SERIAL     , 00102900
103000       EVS_S_LC_NO              = :MEXA001MSTR.EVS-S-LC-NO      , 00103000
103100       EVS_U_VO_IMAGE           = :MEXA001MSTR.EVS-U-VO-IMAGE   , 00103100
103200       EVS_U_DSO_ORD_QTY        = :MEXA001MSTR.EVS-U-DSO-ORD-QTY ,00103200
103300       EVS_F_REQ_PROD_YM        = :MEXA001MSTR.EVS-F-REQ-PROD-YM ,00103300
103400       EVS_F_SHIP_TO_NAME       = :MEXA001MSTR.EVS-F-SHIP-TO-NAME,00103400
103500       EVS_TIMESTAMP_DATE       = :MEXA001MSTR.EVS-TIMESTAMP-DATE,00103500
103600       EVS_TIMESTAMP_TIME       = :MEXA001MSTR.EVS-TIMESTAMP-TIME 00103600
103700     WHERE                                                        00103700
103800            EVS_S_MODEL_YR      = :MEXA001MSTR.EVS-S-MODEL-YR     00103800
103900       AND  EVS_P_CONTROL_NO    = :MEXA001MSTR.EVS-P-CONTROL-NO   00103900
104000     END-EXEC.                                                    00104000
104100                                                                  00104100
104200     EVALUATE SQLCODE                                             00104200
104300         WHEN ZEROS                                               00104300
104400            ADD +1                    TO EVS-REC-UPDATED          00104400
104500            ADD +1                    TO CNT-CHECKPOINT           00104500
104600         WHEN OTHER                                               00104600
104700            MOVE SQLCODE              TO  EDIT-SQLCODE            00104700
104800            MOVE '7200-UPDATE-EVSMSTR' TO ERR-ABEND-PARA          00104800
104900            MOVE SPACES               TO  ERR-ABEND-CODE          00104900
105000            MOVE 'UPDATE'             TO  ERR-FUNCTION-CALL       00105000
105100            MOVE SPACES               TO  ERR-SEG-NAME            00105100
105200            MOVE 'EXVS120'            TO  ERR-PROG-NAME           00105200
105300            MOVE 'MEXA001MSTR'        TO  ERR-TABLE-NAME          00105300
105400            MOVE EDIT-SQLCODE-R       TO  ERR-SQLCODE             00105400
105500            PERFORM 9999-ABEND                                    00105500
105600     END-EVALUATE.                                                00105600
105700/                                                                 00105700
105800 8000-WRITE-AUDIT-REPORT.                                         00105800
105900***************************************************************** 00105900
106000*                                                               * 00106000
106100*  DESCRIPTION:  WRITE MAIN BODY OF AUDIT REPORT                * 00106100
106200*                                                               * 00106200
106300***************************************************************** 00106300
106400                                                                  00106400
106500      MOVE 'TLR RECORDS READ'         TO AUDIT-MESSAGE.           00106500
106600      MOVE ' = '                      TO AUDIT-SEP.               00106600
106700      MOVE TLR-REC-IN-CNT             TO AUDIT-COUNT.             00106700
106800      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00106800
106900      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00106900
107000      PERFORM 10000-WRITE-AUDIT-RECORD.                           00107000
107100                                                                  00107100
107200      MOVE 'TLR REC NOT ON EVSMSTR  ' TO AUDIT-MESSAGE.           00107200
107300      MOVE EVS-REC-NOT-FOUND          TO AUDIT-COUNT.             00107300
107400      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00107400
107500      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00107500
107600      PERFORM 10000-WRITE-AUDIT-RECORD.                           00107600
107700                                                                  00107700
107800      MOVE 'EVS RECORDS UPDATED'      TO AUDIT-MESSAGE.           00107800
107900      MOVE EVS-REC-UPDATED            TO AUDIT-COUNT.             00107900
108000      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00108000
108100      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00108100
108200      PERFORM 10000-WRITE-AUDIT-RECORD                            00108200
108300                                                                  00108300
108400      MOVE 'TLR RECS NOT PROCESSED '  TO AUDIT-MESSAGE.           00108400
108500      MOVE RECORD-BYPASSED            TO AUDIT-COUNT.             00108500
108600      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00108600
108700      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00108700
108800      PERFORM 10000-WRITE-AUDIT-RECORD.                           00108800
108900                                                                  00108900
109000      MOVE 'MEXA033 RECS UPDATED   '  TO AUDIT-MESSAGE.           00109000
109100      MOVE WS-EXTEND-UPDATE-CNT       TO AUDIT-COUNT.             00109100
109200      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00109200
109300      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00109300
109400      PERFORM 10000-WRITE-AUDIT-RECORD.                           00109400
109500                                                                  00109500
109600      MOVE 'MEXA033 RECS INSERTED  '  TO AUDIT-MESSAGE.           00109600
109700      MOVE WS-EXTEND-INSERT-CNT       TO AUDIT-COUNT.             00109700
109800      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00109800
109900      MOVE ADVANCE-LINE2              TO AUDIT-CC.                00109900
110000      PERFORM 10000-WRITE-AUDIT-RECORD.                           00110000
110100/                                                                 00110100
110200 8200-CHECK-LINE-CNT.                                             00110200
110300***************************************************************** 00110300
110400*                                                               * 00110400
110500*  DESCRIPTION: CHECKS LINE COUNT AND PRINTS HEADINGS           * 00110500
110600*                                                               * 00110600
110700***************************************************************** 00110700
110800                                                                  00110800
110900      IF LINE-CNT > 60                                            00110900
111000         PERFORM 8300-WRITE-RPT-HEAD                              00111000
111100      END-IF.                                                     00111100
111200/                                                                 00111200
111300 8300-WRITE-RPT-HEAD.                                             00111300
111400******************************************************************00111400
111500*                                                                *00111500
111600*  DESCRIPTION:   WRITES REPORT HEADINGS                         *00111600
111700*                                                                *00111700
111800******************************************************************00111800
111900                                                                  00111900
112000      ADD 1                           TO PAGE-CNT.                00112000
112100      MOVE PAGE-CNT                   TO PAGE-NUMBER.             00112100
112200      MOVE REPORT-HEADING1            TO REPORT-RECORD.           00112200
112300      MOVE ADVANCE-TOP-OF-PAGE        TO REPORT-CC.               00112300
112400      PERFORM 9500-WRITE-REPORT-RECORD.                           00112400
112500                                                                  00112500
112600      MOVE REPORT-HEADING2            TO REPORT-RECORD.           00112600
112700      MOVE ADVANCE-LINE1              TO REPORT-CC.               00112700
112800      PERFORM 9500-WRITE-REPORT-RECORD.                           00112800
112900                                                                  00112900
113000      MOVE REPORT-HEADING2-5          TO REPORT-RECORD.           00113000
113100      MOVE ADVANCE-LINE1              TO REPORT-CC.               00113100
113200      PERFORM 9500-WRITE-REPORT-RECORD.                           00113200
113300                                                                  00113300
113400      MOVE REPORT-HEADING3            TO REPORT-RECORD.           00113400
113500      MOVE ADVANCE-LINE2              TO REPORT-CC.               00113500
113600      PERFORM 9500-WRITE-REPORT-RECORD.                           00113600
113700                                                                  00113700
113800      MOVE REPORT-HEADING4            TO REPORT-RECORD.           00113800
113900      MOVE ADVANCE-LINE1              TO REPORT-CC.               00113900
114000      PERFORM 9500-WRITE-REPORT-RECORD.                           00114000
114100                                                                  00114100
114200      MOVE 6                          TO LINE-CNT.                00114200
114300/                                                                 00114300
114400 9000-EOJ.                                                        00114400
114500******************************************************************00114500
114600*                                                                *00114600
114700*  DESCRIPTION:  WRITE THE AUDIT REPORT AND CLOSE THE FILES      *00114700
114800*                                                                *00114800
114900******************************************************************00114900
115000                                                                  00115000
115100     IF REPORT-SWITCH = 'N'                                       00115100
115200        MOVE SPACES                   TO RPT-MY-DLR-BDY-ORD       00115200
115300                                         RPT-WMI-MY-PLT-SER       00115300
115400                                         RPT-ERROR-CONDITION      00115400
115500        MOVE 'NO ERROR MESSAGES FOR TODAY'                        00115500
115600                                      TO RPT-MESSAGE              00115600
115700        MOVE REPORT-DETAIL            TO REPORT-RECORD            00115700
115800        MOVE ADVANCE-LINE2            TO REPORT-CC                00115800
115900        PERFORM 9500-WRITE-REPORT-RECORD                          00115900
116000     ELSE                                                         00116000
116100        MOVE SPACES                   TO RPT-MY-DLR-BDY-ORD       00116100
116200                                         RPT-WMI-MY-PLT-SER       00116200
116300                                         RPT-ERROR-CONDITION      00116300
116400        MOVE '*** ALL ERRORS MUST BE CORRECTED IMMEDIATELY ***'   00116400
116500                                      TO RPT-MESSAGE              00116500
116600        MOVE REPORT-DETAIL            TO REPORT-RECORD            00116600
116700        MOVE ADVANCE-LINE2            TO REPORT-CC                00116700
116800        PERFORM 9500-WRITE-REPORT-RECORD                          00116800
116900     END-IF.                                                      00116900
117000                                                                  00117000
117100      ACCEPT START-TIME FROM TIME.                                00117100
117200      MOVE START-TIME                 TO TODAYS-TIME.             00117200
117300      MOVE TT-HH                      TO TT-PRINT-HH.             00117300
117400      MOVE TT-MM                      TO TT-PRINT-MM.             00117400
117500      MOVE TT-SS                      TO TT-PRINT-SS.             00117500
117600      MOVE 'PROGRAM COMPLETION TIME'  TO AUDIT-MESSAGE.           00117600
117700      MOVE ' = '                      TO AUDIT-SEP.               00117700
117800      MOVE TODAYS-TIME-PRINT          TO AUDIT-COUNT.             00117800
117900      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00117900
118000      MOVE ADVANCE-LINE2              TO AUDIT-CC                 00118000
118100      PERFORM 10000-WRITE-AUDIT-RECORD.                           00118100
118200                                                                  00118200
118300      MOVE 'EXVS120 ENDED SUCCESSFULLY' TO AUDIT-MESSAGE.         00118300
118400      MOVE SPACES                     TO AUDIT-SEP.               00118400
118500      MOVE SPACES                     TO AUDIT-COUNT.             00118500
118600      MOVE AUDIT-DETAIL               TO AUDIT-RECORD.            00118600
118700      MOVE ADVANCE-LINE2              TO AUDIT-CC                 00118700
118800      PERFORM 10000-WRITE-AUDIT-RECORD.                           00118800
118900                                                                  00118900
119000      CLOSE PARMFILE.                                             00119000
119100/                                                                 00119100
119200 9500-WRITE-REPORT-RECORD.                                        00119200
119300***************************************************************** 00119300
119400*                                                               * 00119400
119500*  DESCRIPTION:  WRITE REPORT RECORD                            * 00119500
119600*                                                               * 00119600
119700***************************************************************** 00119700
119800                                                                  00119800
119900     CALL 'CBLTDLI'   USING  ISRT                                 00119900
120000                             GSAM3-I-O-PCB                        00120000
120100                             REPORT-DATA.                         00120100
120200                                                                  00120200
120300     EVALUATE GSAM3-I-O-STATUS                                    00120300
120400         WHEN SPACES                                              00120400
120500            CONTINUE                                              00120500
120600         WHEN OTHER                                               00120600
120700            MOVE  '9500-WRITE-REPORT-RECORD' TO ERR-ABEND-PARA    00120700
120800            MOVE  GSAM3-I-O-STATUS    TO ERR-ABEND-CODE           00120800
120900            MOVE  ISRT                TO ERR-FUNCTION-CALL        00120900
121000            MOVE  'I-O-PCB GSAM3'     TO ERR-SEG-NAME             00121000
121100            MOVE  'EXVS120'           TO ERR-PROG-NAME            00121100
121200            MOVE  SPACES              TO ERR-SQLCODE              00121200
121300            MOVE  SPACES              TO ERR-TABLE-NAME           00121300
121400            PERFORM 9999-ABEND                                    00121400
121500     END-EVALUATE.                                                00121500
121600/                                                                 00121600
121700 9999-ABEND.                                                      00121700
121800***************************************************************** 00121800
121900*                                                               * 00121900
122000*  DESCRIPTION:  PERFORM IF ABNORMAL STATUS CODE                * 00122000
122100*                                                               * 00122100
122200***************************************************************** 00122200
122300                                                                  00122300
122400      MOVE SPACES                      TO AUDIT-DETAIL.           00122400
122500      MOVE 'ERROR ABEND PARAGRAPH    ' TO AUDIT-MESSAGE.          00122500
122600      MOVE ' = '                       TO AUDIT-SEP.              00122600
122700      MOVE ERR-ABEND-PARA              TO AUDIT-COUNT.            00122700
122800      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00122800
122900      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00122900
123000      PERFORM 10000-WRITE-AUDIT-RECORD.                           00123000
123100                                                                  00123100
123200      MOVE SPACES                      TO AUDIT-DETAIL.           00123200
123300      MOVE 'ERROR ABEND CODE         ' TO AUDIT-MESSAGE.          00123300
123400      MOVE ' = '                       TO AUDIT-SEP.              00123400
123500      MOVE ERR-ABEND-CODE              TO AUDIT-COUNT.            00123500
123600      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00123600
123700      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00123700
123800      PERFORM 10000-WRITE-AUDIT-RECORD.                           00123800
123900                                                                  00123900
124000      MOVE SPACES                      TO AUDIT-DETAIL.           00124000
124100      MOVE 'ERROR FUNCTION           ' TO AUDIT-MESSAGE.          00124100
124200      MOVE ' = '                       TO AUDIT-SEP.              00124200
124300      MOVE ERR-FUNCTION-CALL           TO AUDIT-COUNT.            00124300
124400      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00124400
124500      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00124500
124600      PERFORM 10000-WRITE-AUDIT-RECORD.                           00124600
124700                                                                  00124700
124800      MOVE SPACES                      TO AUDIT-DETAIL.           00124800
124900      MOVE 'ERROR SEG NAME           ' TO AUDIT-MESSAGE.          00124900
125000      MOVE ' = '                       TO AUDIT-SEP.              00125000
125100      MOVE ERR-SEG-NAME                TO AUDIT-COUNT.            00125100
125200      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00125200
125300      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00125300
125400      PERFORM 10000-WRITE-AUDIT-RECORD.                           00125400
125500                                                                  00125500
125600      MOVE SPACES                      TO AUDIT-DETAIL.           00125600
125700      MOVE 'ERROR PROG NAME          ' TO AUDIT-MESSAGE.          00125700
125800      MOVE ' = '                       TO AUDIT-SEP.              00125800
125900      MOVE ERR-PROG-NAME               TO AUDIT-COUNT.            00125900
126000      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00126000
126100      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00126100
126200      PERFORM 10000-WRITE-AUDIT-RECORD.                           00126200
126300                                                                  00126300
126400      MOVE SPACES                      TO AUDIT-DETAIL.           00126400
126500      MOVE 'ERROR SQL CODE           ' TO AUDIT-MESSAGE.          00126500
126600      MOVE ' = '                       TO AUDIT-SEP.              00126600
126700      MOVE ERR-SQLCODE                 TO AUDIT-COUNT.            00126700
126800      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00126800
126900      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00126900
127000      PERFORM 10000-WRITE-AUDIT-RECORD.                           00127000
127100                                                                  00127100
127200      MOVE SPACES                      TO AUDIT-DETAIL.           00127200
127300      MOVE 'MYDISTDLRBODYITEM        ' TO AUDIT-MESSAGE.          00127300
127400      MOVE ' = '                       TO AUDIT-SEP.              00127400
127500      MOVE ERR-S-1-KEY                 TO AUDIT-COUNT.            00127500
127600      MOVE AUDIT-DETAIL                TO AUDIT-RECORD.           00127600
127700      MOVE ADVANCE-LINE2               TO AUDIT-CC.               00127700
127800      PERFORM 10000-WRITE-AUDIT-RECORD.                           00127800
127900                                                                  00127900
128000      PERFORM 11000-CALL-COREDUMP.                                00128000
128100/                                                                 00128100
128200 10000-WRITE-AUDIT-RECORD.                                        00128200
128300***************************************************************** 00128300
128400*                                                               * 00128400
128500*  DESCRIPTION:  WRITE AUDIT REPORT RECORD                      * 00128500
128600*                                                               * 00128600
128700***************************************************************** 00128700
128800                                                                  00128800
128900      CALL 'CBLTDLI'   USING  ISRT                                00128900
129000                              GSAM2-I-O-PCB                       00129000
129100                              AUDIT-DATA.                         00129100
129200                                                                  00129200
129300     EVALUATE GSAM2-I-O-STATUS                                    00129300
129400         WHEN SPACES                                              00129400
129500            CONTINUE                                              00129500
129600         WHEN OTHER                                               00129600
129700            PERFORM 11000-CALL-COREDUMP                           00129700
129800     END-EVALUATE.                                                00129800
129900/                                                                 00129900
130000 11000-CALL-COREDUMP.                                             00130000
130100***************************************************************** 00130100
130200*                                                               * 00130200
130300*  DESCRIPTION:  CALLS COREDUMP                                 * 00130300
130400*                                                               * 00130400
130500***************************************************************** 00130500
130600                                                                  00130600
130700     CALL 'COREDUMP'.                                             00130700
130800/                                                                 00130800
130900*********    CHECKPOINT / RESTART FILE                            00130900
131000 ++INCLUDE PCPTSIMS3                                              00131000
131100*********    END OF CHECKPOINT / RESTART FILE                     00131100
131200/                                                                 00131200
131300 RESTART-LOGIC.                                                   00131300
131400     IF CHKP-NUMERIC > 1                                          00131400
131500        MOVE SAVE2-AREA               TO WS-SAVE-AREA-2           00131500
131600        MOVE ZEROS                    TO CNT-CHECKPOINT           00131600
131700     ELSE                                                         00131700
131800         MOVE SPACES                  TO XRST-ID                  00131800
131900     END-IF.                                                      00131900
132000 COPY CB372P1.                                                    00132000
132100 COPY CB372P2.                                                    00132100
132200 COPY CB372P3.                                                    00132200
132300 COPY CB372P4.                                                    00132300
